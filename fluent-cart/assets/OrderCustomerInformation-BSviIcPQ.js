var Re=Object.defineProperty;var Fe=(s,e,l)=>e in s?Re(s,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[e]=l;var ce=(s,e,l)=>Fe(s,typeof e!="symbol"?e+"":e,l);import{i as T,z as K,m as ae,j as pe,a as k,b as P,o as n,w as i,f as a,d as o,A as X,u as M,t as r,c as u,e as g,F as W,h as z,g as C,r as We,O as Ee,x as Se,M as He,C as ze,I as qe}from"./vue.esm-bundler-VLZRLwDo.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as Ke,I as fe}from"./Badge-DsywDH_m.js";import{_ as Ze}from"./Empty-BDIgPk4r.js";import{f as Qe}from"./common-BPfjXdxy.js";import{b as Y,c as ve,a as re,C as Ye}from"./CopyToClipboard-O88DxGEb.js";import{_ as R}from"./DynamicIcon-B1vpMEi_.js";import{t as h}from"./Translator-B6cROAk_.js";import{_ as Ge,C as Te,c as xe,d as Oe}from"./RouteCell-BYUiwRDq.js";import{A as Ue}from"./Arr-MwYQQ3qa.js";import{A as Je}from"./Asset-CBhXzPc7.js";import{n as x}from"./Notify-DKZN7muO.js";import{R as q}from"./Rest-U7WPPDzn.js";import{L as Ne,u as Xe}from"./NotFound-C0jL-sdJ.js";import{e as Pe}from"./index-BSdFqZUc.js";import{f as et}from"./productService-CeLFdK8B.js";const tt={class:"fc-customer-edit-modal"},st={class:"fc-compact-form"},lt={class:"form-heading"},at={class:"fc-compact-form fc-customer-address-section"},ot={key:0,class:"mt-5"},dt={key:1,class:"form-error-wrap"},nt={class:"dialog-footer"},rt={__name:"NewCustomerModal",props:{customer_id:{type:[String,Number],default:null},customer:{type:Object,default:()=>({})},customerModalInfos:{type:Object,default:()=>({})}},emits:["close-modal","select-new-customer","update:customerModal"],setup(s,{emit:e}){const l=e,A=s,c=T({}),d=T(!1),v=T({}),w=()=>{l("close-modal")},N=()=>{d.value=!0,c.value.wp_user=A.customerModalInfos.manageWpUser,q.post("customers/",{...c.value}).then(p=>{l("select-new-customer",p.data),l("update:customerModal",!1),x.success(p.message),v.value={}}).catch(p=>{p.status_code=="422"?(x.validationErrors(p),v.value=p.data):x.error(p.message)}).finally(()=>{d.value=!1})},$=()=>{d.value=!0,c.value.wp_user=A.customerModalInfos.manageWpUser,q.put("customers/"+A.customer_id,{...c.value}).then(p=>{l("select-new-customer",p.data),l("update:customerModal",!1),x.success(p.message),v.value={}}).catch(p=>{p.status_code=="422"?(x.validationErrors(p),v.value=p.data):x.error(p.message)}).finally(()=>{d.value=!1})},U=K(()=>A.customerModalInfos.action==="create"?h("Create as wordpress user"):h("Update wordpress user profile")),V=K(()=>d.value?A.customerModalInfos.action==="edit"?h("Updating"):h("Creating"):A.customerModalInfos.action==="edit"?h("Update Customer"):h("Create Customer")),B=K(()=>{const p={};for(const y in v.value){const O=v.value[y];p[y]=Array.isArray(O)?O:Object.values(O)}return p});return ae(()=>A.customer,p=>{c.value={id:p.id,email:p.email,full_name:p.full_name,state:p.state,city:p.city,country:p.country,postcode:p.postcode,country_name:p.country_name,contact_id:p.contact_id,user_id:p.user_id,wp_user:p.wp_user}},{deep:!0}),pe(()=>{c.value={id:A.customer.id,email:A.customer.email,full_name:A.customer.full_name,state:A.customer.state,city:A.customer.city,country:A.customer.country,postcode:A.customer.postcode,country_name:A.customer.country_name,contact_id:A.customer.contact_id,user_id:A.customer.user_id,wp_user:A.customer.wp_user}}),(p,y)=>{const O=k("el-checkbox"),m=k("el-button"),_=k("el-dialog");return n(),P(_,{modelValue:s.customerModalInfos.showModal,"onUpdate:modelValue":y[6]||(y[6]=L=>s.customerModalInfos.showModal=L),title:s.customerModalInfos.title,onClose:y[7]||(y[7]=()=>{v.value={}})},{default:i(()=>[a("div",tt,[a("div",st,[o(Y,{label:M(h)("Full Name *"),modelValue:c.value.full_name,"onUpdate:modelValue":y[0]||(y[0]=L=>c.value.full_name=L),class:X(v.value.full_name?"is-error":"")},null,8,["label","modelValue","class"]),o(Y,{type:"email",label:M(h)("Email *"),modelValue:c.value.email,"onUpdate:modelValue":y[1]||(y[1]=L=>c.value.email=L),disabled:s.customer.user_id&&s.customer.user_id!=0,class:X(v.value.email?"is-error":"")},null,8,["label","modelValue","disabled","class"])]),a("h4",lt,r(M(h)("Address")),1),a("div",at,[o(ve,{modelValue:c.value,"onUpdate:modelValue":y[2]||(y[2]=L=>c.value=L),validationErrors:v.value},null,8,["modelValue","validationErrors"]),s.customerModalInfos.action==="create"?(n(),u("div",ot,[o(O,{"true-value":"yes","false-value":"no",modelValue:s.customerModalInfos.manageWpUser,"onUpdate:modelValue":y[3]||(y[3]=L=>s.customerModalInfos.manageWpUser=L)},{default:i(()=>[o(Ne,{title:U.value,content:M(h)("We will create a new user for this customer. If a user with the same email already exists, we will associate the customer with that existing user.")},null,8,["title","content"])]),_:1},8,["modelValue"])])):g("",!0),Object.keys(v.value).length?(n(),u("div",dt,[(n(!0),u(W,null,z(B.value,(L,S)=>(n(),u("p",{key:S},[(n(!0),u(W,null,z(L,I=>(n(),u("span",{key:I},r(I),1))),128))]))),128))])):g("",!0)]),a("div",nt,[o(m,{onClick:w},{default:i(()=>[C(r(M(h)("Cancel")),1)]),_:1}),s.customerModalInfos.action==="edit"?(n(),P(m,{key:0,loading:d.value,type:"primary",onClick:y[4]||(y[4]=L=>$())},{default:i(()=>[C(r(V.value),1)]),_:1},8,["loading"])):(n(),P(m,{key:1,type:"primary",loading:d.value,onClick:y[5]||(y[5]=L=>N())},{default:i(()=>[C(r(V.value),1)]),_:1},8,["loading"]))])])]),_:1},8,["modelValue","title"])}}};class it{constructor(){ce(this,"allPermissions",[]);this.allPermissions=Ue.get(window,"fluentCartAdminApp.app_config.permissions",[])}isSuperAdmin(){return this.allPermissions.includes("is_super_admin")}has(e){return this.isSuperAdmin()?!0:this.allPermissions.includes(e)}hasAny(e){return this.isSuperAdmin()?!0:Array.isArray(e)&&e.some(l=>this.allPermissions.includes(l))}hasAll(e){return this.isSuperAdmin()?!0:Array.isArray(e)&&e.every(l=>this.allPermissions.includes(l))}resolve({permission:e,permissionType:l}){const A=l==="all"?"all":"any",c=Array.isArray(e)?e:typeof e=="string"?e.split(",").map(d=>d.trim()):[];return A==="all"?this.hasAll(c):this.hasAny(c)}}const ut=new it,Be={__name:"UserCan",props:{permission:{type:[String,Array],required:!0},permissionType:{type:String,default:"any"}},setup(s){const e=s,l=K(()=>ut.resolve({permission:e.permission,permissionType:e.permissionType}));return(A,c)=>l.value?We(A.$slots,"default",{key:0}):g("",!0)}},ct={name:"OrderUpDownIndicator",props:{order:{type:Object,required:!0}},data(){var s,e;return{upgradeToId:((s=this.order.config)==null?void 0:s.upgraded_to)||null,upgradeFromId:((e=this.order.config)==null?void 0:e.upgraded_from)||null}}},mt={key:0,class:"ml-2"};function pt(s,e,l,A,c,d){const v=k("el-icon"),w=k("el-button"),N=k("router-link"),$=k("el-tooltip");return c.upgradeFromId||c.upgradeToId?(n(),u("span",mt,[c.upgradeFromId?(n(),P($,{key:0,trigger:"click"},{content:i(()=>[C(r(s.$t("This order has been upgraded from"))+" ",1),o(N,{to:{name:"view_order",params:{order_id:c.upgradeFromId}}},{default:i(()=>[a("strong",null,"#"+r(c.upgradeFromId),1)]),_:1},8,["to"])]),default:i(()=>[o(w,{text:""},{default:i(()=>[o(v,null,{default:i(()=>e[0]||(e[0]=[a("svg",{viewBox:"0 0 24 24",width:"24",height:"24",color:"currentColor",fill:"none"},[a("defs"),a("path",{fill:"currentColor",d:"M11.943,1.75 L12.057,1.75 C14.248,1.75 15.969,1.75 17.312,1.931 C18.689,2.116 19.781,2.503 20.639,3.361 C21.497,4.219 21.884,5.311 22.069,6.688 C22.25,8.031 22.25,9.752 22.25,11.943 L22.25,12.057 C22.25,14.248 22.25,15.969 22.069,17.312 C21.884,18.689 21.497,19.781 20.639,20.639 C19.781,21.497 18.689,21.884 17.312,22.069 C15.969,22.25 14.248,22.25 12.057,22.25 L11.943,22.25 C9.752,22.25 8.031,22.25 6.688,22.069 C5.311,21.884 4.219,21.497 3.361,20.639 C2.503,19.781 2.116,18.689 1.931,17.312 C1.75,15.969 1.75,14.248 1.75,12.057 L1.75,11.943 C1.75,9.752 1.75,8.031 1.931,6.688 C2.116,5.311 2.503,4.219 3.361,3.361 C4.219,2.503 5.311,2.116 6.688,1.931 C8.031,1.75 9.752,1.75 11.943,1.75 L11.943,1.75 Z M4.422,4.422 C3.889,4.955 3.58,5.678 3.417,6.888 C3.252,8.12 3.25,9.74 3.25,12 C3.25,14.26 3.252,15.88 3.417,17.112 C3.58,18.322 3.889,19.045 4.422,19.578 C4.955,20.111 5.678,20.42 6.888,20.583 C8.12,20.748 9.74,20.75 12,20.75 C14.26,20.75 15.88,20.748 17.112,20.583 C18.322,20.42 19.045,20.111 19.578,19.578 C20.111,19.045 20.42,18.322 20.583,17.112 C20.748,15.88 20.75,14.26 20.75,12 C20.75,9.74 20.748,8.12 20.583,6.888 C20.42,5.678 20.111,4.955 19.578,4.422 C19.045,3.889 18.322,3.58 17.112,3.417 C15.88,3.252 14.26,3.25 12,3.25 C9.74,3.25 8.12,3.252 6.888,3.417 C5.678,3.58 4.955,3.889 4.422,4.422 Z M10.038,11.023 C9.749,11.32 9.274,11.326 8.977,11.038 C8.68,10.749 8.673,10.274 8.962,9.977 C9.051,9.886 9.197,9.704 9.41,9.433 L9.457,9.373 C9.647,9.131 9.87,8.847 10.099,8.576 C10.346,8.285 10.621,7.983 10.897,7.749 C11.035,7.631 11.19,7.515 11.358,7.425 C11.519,7.339 11.742,7.25 12,7.25 C12.258,7.25 12.481,7.339 12.642,7.425 C12.81,7.515 12.965,7.631 13.103,7.749 C13.379,7.983 13.654,8.285 13.901,8.576 C14.13,8.847 14.353,9.131 14.543,9.373 L14.543,9.373 L14.59,9.433 C14.804,9.704 14.949,9.886 15.038,9.977 C15.326,10.274 15.32,10.749 15.023,11.038 C14.726,11.326 14.251,11.32 13.962,11.023 C13.805,10.861 13.603,10.604 13.411,10.359 L13.366,10.302 C13.173,10.057 12.967,9.794 12.756,9.545 L12.75,9.538 L12.75,16 C12.75,16.414 12.414,16.75 12,16.75 C11.586,16.75 11.25,16.414 11.25,16 L11.25,9.538 L11.244,9.545 C11.033,9.794 10.827,10.057 10.634,10.302 L10.634,10.302 L10.589,10.359 C10.397,10.604 10.195,10.861 10.038,11.023 Z"})],-1)])),_:1,__:[0]})]),_:1})]),_:1})):g("",!0),c.upgradeToId?(n(),P($,{key:1,trigger:"click"},{content:i(()=>[C(r(s.$t("This order has been upgraded to"))+" ",1),o(N,{to:{name:"view_order",params:{order_id:c.upgradeToId}}},{default:i(()=>[a("strong",null,"#"+r(c.upgradeToId),1)]),_:1},8,["to"])]),default:i(()=>[o(w,{text:""},{default:i(()=>[o(v,null,{default:i(()=>e[1]||(e[1]=[a("svg",{viewBox:"0 0 24 24",width:"24",height:"24",color:"currentColor",fill:"none"},[a("defs"),a("path",{fill:"currentColor",d:"M3.367,20.63 C1.756,19.02 1.756,16.672 1.756,11.995 L1.756,11.995 C1.756,7.317 1.756,4.97 3.367,3.359 C4.976,1.75 7.324,1.75 12.002,1.75 C16.68,1.75 19.026,1.75 20.637,3.359 C22.247,4.97 22.247,7.318 22.247,11.996 C22.247,16.674 22.247,19.022 20.637,20.631 C19.026,22.242 16.678,22.242 12,22.242 L12.003,22.241 C7.326,22.241 4.976,22.241 3.367,20.63 Z M4.427,4.418 C3.256,5.59 3.256,7.73 3.256,11.994 L3.256,11.995 C3.256,16.259 3.256,18.399 4.427,19.569 C5.597,20.741 7.738,20.741 12.003,20.741 C16.269,20.741 18.408,20.741 19.58,19.569 C20.75,18.399 20.75,16.259 20.75,11.993 L20.75,11.993 C20.75,7.727 20.75,5.588 19.58,4.417 C18.408,3.247 16.268,3.247 12.005,3.247 L12.003,3.248 C7.739,3.248 5.599,3.248 4.427,4.418 Z M12.024,8.951 C12.121,9.047 12.306,9.198 12.578,9.415 L12.654,9.476 L12.654,9.476 C12.894,9.667 13.172,9.888 13.437,10.117 C13.727,10.367 14.029,10.648 14.262,10.932 C14.432,11.139 14.661,11.456 14.726,11.834 C14.729,11.85 14.732,11.866 14.734,11.883 C14.741,11.94 14.745,11.999 14.745,12.059 C14.744,12.083 14.743,12.106 14.74,12.13 C14.693,12.568 14.41,12.933 14.199,13.168 C13.96,13.435 13.661,13.696 13.375,13.93 C13.152,14.112 12.918,14.292 12.71,14.452 C12.651,14.497 12.594,14.541 12.541,14.582 C12.277,14.786 12.109,14.923 12.027,15.007 C11.739,15.305 11.264,15.312 10.967,15.024 C10.669,14.735 10.662,14.26 10.95,13.963 C11.121,13.787 11.382,13.582 11.623,13.396 C11.684,13.349 11.745,13.302 11.807,13.254 C12.012,13.097 12.222,12.935 12.427,12.768 L12.483,12.722 L6.995,12.715 C6.581,12.715 6.246,12.379 6.246,11.964 C6.247,11.55 6.583,11.215 6.997,11.215 L12.422,11.222 C12.191,11.024 11.949,10.832 11.718,10.648 L11.718,10.648 L11.643,10.588 C11.396,10.391 11.134,10.181 10.965,10.012 C10.672,9.72 10.671,9.245 10.964,8.952 C11.257,8.659 11.731,8.658 12.024,8.951 Z M17.754,8.001 L17.745,15.993 C17.744,16.407 17.408,16.743 16.994,16.742 C16.58,16.742 16.244,16.405 16.245,15.991 L16.254,7.999 C16.255,7.585 16.591,7.25 17.005,7.25 C17.419,7.25 17.755,7.587 17.754,8.001 Z"})],-1)])),_:1,__:[1]})]),_:1})]),_:1})):g("",!0)])):g("",!0)}const ta=_e(ct,[["render",pt]]),ie=class ie{static emptyImage(e=!1){return ie.assetUrl()+(e?"images/empty-image-dark.svg":"images/empty-image.svg")}};ce(ie,"assetUrl",()=>Je.url());let me=ie;const _t={components:{DynamicIcon:R},props:{product:{type:Object},hideProductId:{type:Boolean,default:!1},hideViewIcon:{type:Boolean,default:!1},hideImage:{type:Boolean,default:!1}},data(){return{}},methods:{translate:h,getImage(s,e=!1){return Ue.get(s,"featured_media.url")??me.emptyImage(e)}}},ft={class:"fc-product-info-card w-full"},vt={key:0,class:"fc-product-info-media"},ht=["src","alt"],gt=["src","alt"],yt={class:"fc-product-info-details"},bt={class:"fc-product-info-name"},Ct={class:"product-name"},At={class:"product-name-inner"},wt=["href"],kt={key:0,class:"product-id"},$t={key:1,class:"product-sub-name"};function Mt(s,e,l,A,c,d){var w,N,$,U,V,B,p,y,O;const v=k("DynamicIcon");return n(),u("div",ft,[l.hideImage?g("",!0):(n(),u("div",vt,[a("span",null,[a("img",{class:"block dark:hidden",src:d.getImage((w=l.product)==null?void 0:w.detail),alt:(N=l.product)==null?void 0:N.post_title},null,8,ht),a("img",{class:"hidden dark:block",src:d.getImage(($=l.product)==null?void 0:$.detail,!0),alt:(U=l.product)==null?void 0:U.post_title},null,8,gt)])])),a("div",yt,[a("div",bt,[a("span",Ct,[a("span",At,r(((V=l.product)==null?void 0:V.post_title)||d.translate("No Name")),1),l.hideViewIcon?g("",!0):(n(),u("a",{key:0,class:"view-link right-1",target:"_blank",href:(B=l.product)==null?void 0:B.view_url,onClick:e[0]||(e[0]=Ee(()=>{},["stop"]))},[o(v,{class:"w-5 h-5",name:"Eye"})],8,wt))]),l.hideProductId?g("",!0):(n(),u("span",kt," #"+r((p=l.product)==null?void 0:p.ID),1)),(y=l.product)!=null&&y.variation_title?(n(),u("span",$t," – "+r((O=l.product)==null?void 0:O.variation_title),1)):g("",!0)])])])}const Lt=_e(_t,[["render",Mt]]),It={name:"LicenseTable",components:{ProductInfo:Lt,UserCan:Be,RouteCell:Ge,DynamicIcon:R,IconButton:fe,CopyToClipboard:re,Empty:Ze,Badge:Ke},props:{licenses:{type:Array,required:!0},columns:{type:Array,default(){return["product","order_id","customer","date"]}}},computed:{Clipboard(){return Ye},formattedLicense(){return this.licenses.map(s=>{var e;return{...s,product:{...s.product,variation_title:((e=s.product_variant)==null?void 0:e.variation_title)||"n/a"}}})}},methods:{translate:h,formatDate:Qe,getProductName(s){var e,l;return(e=s==null?void 0:s.product)!=null&&e.post_title?(l=s==null?void 0:s.product)==null?void 0:l.post_title:"n/a"},getProductVariationName(s){var e,l;return(e=s==null?void 0:s.product_variant)!=null&&e.variation_title?(l=s==null?void 0:s.product_variant)==null?void 0:l.variation_title:"n/a"}}},Vt={class:"fct_licenses_table hide-on-mobile"},Et={class:"fc-license-key-wrap flex flex-col"},St={class:"fc-license-key max-w-full pr-1"},Tt={class:"fc-license-key-inner pr-2"},xt={key:0},Ot={key:1},Ut={class:"fct_licenses_table_mobile"},Nt={class:"fc-table-mobile-wrap"},Pt=["onClick"],Bt={class:"fc-table-mobile-header-left"},Dt={class:"fc-table-status-col"},jt={class:"fc-table-activations-col"},Rt={class:"fc-table-mobile-body"},Ft=["onClick"],Wt={class:"fc-license-key-wrap has-bg"},Ht={class:"fc-license-key"},zt={class:"fc-license-key-inner pr-2"};function qt(s,e,l,A,c,d){const v=k("Badge"),w=k("router-link"),N=k("DynamicIcon"),$=k("el-tooltip"),U=k("el-table-column"),V=k("ProductInfo"),B=k("RouteCell"),p=k("Empty"),y=k("el-table"),O=k("UserCan");return n(),P(O,{permission:"licenses/view"},{default:i(()=>[a("div",Vt,[o(y,{data:d.formattedLicense,class:"w-full compact-table"},{empty:i(()=>[o(p,{icon:"Empty/ListView","has-dark":!0,text:d.translate("No Licenses found based on your filter")},null,8,["text"])]),default:i(()=>[o(U,{label:d.translate("License Key"),width:200},{default:i(m=>{var _;return[a("div",Et,[a("span",null,[(n(),P(v,{status:m.row.status,key:m.row.id},null,8,["status"]))]),a("span",St,[a("span",Tt,[o(w,{class:"link",to:{name:"view_license",params:{license_id:(_=m.row)==null?void 0:_.id}}},{default:i(()=>[C(r(m.row.license_key),1)]),_:2},1032,["to"])]),o($,{content:m.row.license_key,placement:"top","popper-class":"fc-tooltip"},{default:i(()=>[o(N,{class:"cursor-pointer p-1 w-6 h-6 flex-none",name:"Copy",onClick:()=>{d.Clipboard.copy(m.row.license_key,{successMessage:d.translate("License Key copied to clipboard"),errorMessage:d.translate("Failed to copy License Key")})}},null,8,["onClick"])]),_:2},1032,["content"])])])]}),_:1},8,["label"]),l.columns.indexOf("product")!==-1?(n(),P(U,{key:0,width:200,label:d.translate("Product")},{default:i(m=>{var _;return[o(B,{class:"link block hover:no-underline",to:{name:"view_license",params:{license_id:(_=m.row)==null?void 0:_.id}}},{default:i(()=>[o(V,{product:m.row.product,hideProductId:!0,hideViewIcon:!0,hideImage:!0},null,8,["product"])]),_:2},1032,["to"])]}),_:1},8,["label"])):g("",!0),l.columns.indexOf("order_id")!==-1?(n(),P(U,{key:1,width:80,label:d.translate("Order ID")},{default:i(m=>[o(B,{class:"link order_id block hover:no-underline relative w-full",to:{name:"view_order",params:{order_id:m.row.order_id}}},{default:i(()=>[o(w,{class:"link absolute left-1/2 top-1/2 translate-x-[calc(-50%-16px)] translate-y-[-50%]",to:{name:"view_order",params:{order_id:m.row.order_id}}},{default:i(()=>[C(" #"+r(m.row.order_id),1)]),_:2},1032,["to"])]),_:2},1032,["to"])]),_:1},8,["label"])):g("",!0),l.columns.indexOf("customer")!==-1?(n(),P(U,{key:2,width:100,label:d.translate("Customer")},{default:i(m=>[o(w,{class:"link",to:{name:"view_customer",params:{customer_id:m.row.customer_id}}},{default:i(()=>{var _,L;return[C(r(((L=(_=m.row)==null?void 0:_.customer)==null?void 0:L.full_name)||d.translate("No Name")),1)]}),_:2},1032,["to"])]),_:1},8,["label"])):g("",!0),o(U,{width:90,label:d.translate("Activations")},{default:i(m=>{var _;return[o(B,{class:"link block hover:no-underline relative w-full",to:{name:"view_license",params:{license_id:(_=m.row)==null?void 0:_.id}}},{default:i(()=>[C(r(m.row.activation_count)+" / "+r(m.row.limit==0?"Unlimited":m.row.limit),1)]),_:2},1032,["to"])]}),_:1},8,["label"]),l.columns.indexOf("date")!==-1?(n(),P(U,{key:3,width:140,label:d.translate("Date")},{default:i(m=>{var _;return[o(B,{class:"block hover:no-underline w-full",to:{name:"view_license",params:{license_id:(_=m.row)==null?void 0:_.id}}},{default:i(()=>[a("div",null,[a("span",null,r(d.formatDate(m.row.created_at)),1),e[0]||(e[0]=a("span",{class:"text-gray-300 px-2"},"–",-1)),m.row.expiration_date?(n(),u("span",xt,r(d.formatDate(m.row.expiration_date)),1)):(n(),u("span",Ot,r(d.translate("Lifetime")),1))])]),_:2},1032,["to"])]}),_:1},8,["label"])):g("",!0)]),_:1},8,["data"])]),a("div",Ut,[a("div",Nt,[(n(!0),u(W,null,z(d.formattedLicense,(m,_)=>(n(),u("div",{key:_,class:"fc-table-mobile-row"},[a("div",{class:"fc-table-mobile-header",onClick:L=>s.$router.push({name:"view_license",params:{license_id:m==null?void 0:m.id}})},[a("div",Bt,[a("div",Dt,[(n(),P(v,{status:m.status,key:m.id},null,8,["status"]))]),a("div",jt,r(m.activation_count)+" / "+r(m.limit==0?"Unlimited":m.limit),1)])],8,Pt),a("div",Rt,[a("div",{class:"fc-table-product-col",onClick:L=>s.$router.push({name:"view_license",params:{license_id:m==null?void 0:m.id}})},[o(V,{product:m.product,hideProductId:!0,hideViewIcon:!0,hideImage:!0},null,8,["product"])],8,Ft),a("div",Wt,[a("div",Ht,[a("div",zt,[o(w,{class:"link",to:{name:"view_license",params:{license_id:m==null?void 0:m.id}}},{default:i(()=>[C(r(m.license_key),1)]),_:2},1032,["to"])]),o(N,{class:"cursor-pointer p-1 w-6 h-6",name:"Copy",onClick:()=>{d.Clipboard.copy(m.license_key,{successMessage:d.translate("License Key copied to clipboard"),errorMessage:d.translate("Failed to copy License Key")})}},null,8,["onClick"])])])])]))),128))])])]),_:1})}const sa=_e(It,[["render",qt]]),Kt={class:"fct_edit_customer_popup"},Zt={class:"form-error-wrap"},Qt=["innerHTML"],Yt={class:"dialog-footer"},De=Object.assign({name:"AddOrEditAddressModal"},{__name:"AddOrEditAddressModal",props:["customer_id","modalAction","address","showAddressModal","order_id","customerAddressModalInfos","showSetAsAlsoCheckbox","closing_modal"],emits:["close-modal","update:refresh-address"],setup(s,{emit:e}){const l=s,A=e;T([]);const c=T(!1),d=T({}),v=T(!1),w=T(!1),N=T(!1);T(null);const $=T({...l.address??{}}),U=Se().ctx;Xe().onSave(()=>{l.showAddressModal&&["billing","shipping"].includes(l.modalAction.type)&&(l.modalAction.action==="edit"&&U.address.id!==""?y():l.modalAction.action==="create"&&p())});const B=m=>{let _="";for(const L in m){const S=m[L],I=Object.values(S);_+=I+" </br>"}return _},p=()=>{v.value=!0;const m=$.value;let _={type:l.modalAction.type,customer_id:l.customer_id,order_id:l.order_id??null},L={...m,..._};q.post("customers/"+l.customer_id+"/address",{...L}).then(S=>{N.value&&O(),A("update:refresh-address",!1,S.data),x.success(S.message),d.value={}}).catch(S=>{S.status_code=="422"?(x.validationErrors(S),d.value=S.data):x.error(S.message)}).finally(()=>{c.value=!1,v.value=!1})},y=()=>{w.value=!0,l.address;let _={...{type:l.modalAction.type,customer_id:l.customer_id,is_primary:l.address.is_primary,id:l.address.id,order_id:l.order_id&&l.address.is_primary==1?l.order_id:null},...$.value};q.put("customers/"+l.customer_id+"/address",{..._}).then(L=>{N.value&&O(),A("update:refresh-address",!1,L.data),x.success(L.message),d.value={}}).catch(L=>{L.status_code=="422"?(x.validationErrors(L),d.value=L):x.error(L.message)}).finally(()=>{c.value=!1,w.value=!1})},O=()=>{const m=l.modalAction.type==="billing"?"shipping":"billing";q.post("customers/"+l.customer_id+"/address",{type:m,...l.address,...$}).then(_=>{x.success(_.message)}).catch(_=>{_.status_code=="422"?(x.validationErrors(_),d.value=_):x.error(_.message)}).finally(()=>{c.value=!1,v.value=!1})};return ae(()=>l.closing_modal,(m,_)=>{m&&(d.value={})}),(m,_)=>{const L=k("el-form"),S=k("el-checkbox"),I=k("el-button");return n(),u("div",Kt,[o(L,{"label-position":"top",class:"fc-compact-form","require-asterisk-position":"right"},{default:i(()=>[o(Y,{label:M(h)("Address Label"),class:X(d.value.hasOwnProperty("label")?"is-error":""),modelValue:$.value.label,"onUpdate:modelValue":_[0]||(_[0]=j=>$.value.label=j)},null,8,["label","class","modelValue"]),o(Y,{label:M(h)("Name"),required:"",class:X(d.value.hasOwnProperty("name")?"is-error":""),modelValue:$.value.name,"onUpdate:modelValue":_[1]||(_[1]=j=>$.value.name=j)},null,8,["label","class","modelValue"]),o(Y,{label:M(h)("Email"),required:"",class:X(d.value.hasOwnProperty("email")?"is-error":""),modelValue:$.value.email,"onUpdate:modelValue":_[2]||(_[2]=j=>$.value.email=j)},null,8,["label","class","modelValue"]),o(Y,{label:M(h)("Phone"),required:"",class:X(d.value.hasOwnProperty("phone")?"is-error":""),modelValue:$.value.phone,"onUpdate:modelValue":_[3]||(_[3]=j=>$.value.phone=j)},null,8,["label","class","modelValue"]),o(ve,{use_additional_address_fields:"",modelValue:$.value,"onUpdate:modelValue":_[4]||(_[4]=j=>$.value=j),validationErrors:d.value},null,8,["modelValue","validationErrors"])]),_:1}),a("div",Zt,[a("p",{class:"form-error-text",innerHTML:B(d.value)},null,8,Qt)]),a("div",Yt,[s.showSetAsAlsoCheckbox?(n(),P(S,{key:0,modelValue:N.value,"onUpdate:modelValue":_[5]||(_[5]=j=>N.value=j),style:{"margin-right":"16px"}},{default:i(()=>[C(r(M(h)("Set as"))+" "+r(s.modalAction.type==="billing"?M(h)("shipping address also"):M(h)("billing address also")),1)]),_:1},8,["modelValue"])):g("",!0),s.address.id?(n(),P(I,{key:1,type:"primary",onClick:_[6]||(_[6]=j=>y()),loading:w.value,disabled:w.value},{default:i(()=>[C(r(M(h)("Update Address")),1)]),_:1},8,["loading","disabled"])):(n(),P(I,{key:2,type:"primary",onClick:_[7]||(_[7]=j=>p()),loading:v.value,disabled:v.value},{default:i(()=>[C(r(M(h)("Add Address")),1)]),_:1},8,["loading","disabled"]))])])}}}),Gt={class:"fc-manage-address-modal"},Jt={key:1,class:"fc-manage-address-wrap"},Xt=["onClick"],es={class:"fc-address-action absolute top-0 right-0 pt-2"},ts={class:"more-btn"},ss={key:0,class:"empty-text"},ls={key:2,class:"edit_address"},as={key:3,class:"dialog-footer"},os={name:"ManageAddressModal",props:["showAddressModal","customer_id","modalAction","order_id"],expose:["editAddress"],data(){return{manageAddress:[],address:{},loading:!0,isEditAddress:!1,selectedAddressIndex:null}},computed:{showModal:{get(){return this.showAddressModal},set(s){this.$emit("update:showAddressModal",s)}}},methods:{handleAddressCommand(s){s.action==="edit"?this.editAddress(s.data):s.action==="use"?this.$emit("onAddressSelected",s.data):s.action==="set-as-also"?this.setAsAlso(s.data):s.action==="default"?this.setAddressPrimary(s.data):s.action==="remove"&&this.$confirm("Are you sure want to delete this address?","Warning",{confirmButtonText:this.$t("Yes, Delete!"),cancelButtonText:this.$t("Cancel"),cancelButtonClass:"el-button--small",confirmButtonClass:"el-button--small",type:"warning"}).then(()=>{this.removeAddress(s.data)}).catch(()=>{})},emitAddNewAddress(s,e=[]){this.$emit("addNewAddress",s,"create",e)},emitAddressSelected(){this.showModal=!1,this.$emit("onAddressSelected",this.manageAddress[this.selectedAddressIndex])},editAddress(s){this.address=s,this.isEditAddress=!0},removeAddress(s){let e=s.id;this.$del("customers/"+this.customer_id+"/address",{address:s}).then(l=>{this.getAddresses(),this.$emit("refresh-address"),this.handleSuccess(l.message),e===this.selectedAddressIndex&&(this.selectedAddressIndex=null)}).catch(l=>{l.status_code=="422"?x.validationErrors(l):x.error(l.message)}).finally(()=>{this.loading=!1})},setAddressPrimary(s){this.$post("customers/"+this.customer_id+"/address/make-primary",{addressId:s.id,type:s.type}).then(e=>{this.$emit("refresh-address"),this.getAddresses(),this.handleSuccess(e.message)}).catch(e=>{e.status_code=="422"?x.validationErrors(e):x.error(e.message)}).finally(()=>{this.loading=!1})},getTitle(){return this.modalAction.type==="billing"?this.$t("Manage billing address"):this.$t("Manage shipping address")},fetchAddresses(){this.getAddresses(this.modalAction.type)},getAddresses(s="billing"){this.loading=!0,this.selectedOrders=[],this.$get("customers/"+this.customer_id+"/address",{type:this.modalAction.type}).then(e=>{this.manageAddress=e.addresses}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},updateAddress(){this.fetchAddresses(),this.$emit("refresh-address")},setAsAlso(s){const e=this.modalAction.type==="billing"?"shipping":"billing",l={...s,type:e,customer_id:this.customer_id,is_primary:0};delete l.id,delete l.created_at,delete l.updated_at,this.emitAddNewAddress(e,l)}}},ds=Object.assign(os,{setup(s){return(e,l)=>{const A=k("el-skeleton"),c=k("el-tag"),d=k("el-dropdown-item"),v=k("el-dropdown-menu"),w=k("el-dropdown"),N=k("el-icon"),$=k("el-button"),U=k("el-dialog");return n(),u("div",Gt,[o(U,{modelValue:e.showModal,"onUpdate:modelValue":l[5]||(l[5]=V=>e.showModal=V),onClose:l[6]||(l[6]=()=>{e.selectedAddressIndex=null,e.isEditAddress=!1}),onOpen:e.fetchAddresses,title:e.getTitle(),"append-to-body":!0},{default:i(()=>[e.loading?(n(),P(A,{key:0,animated:"",rows:4})):g("",!0),!e.loading&&!e.isEditAddress?(n(),u("div",Jt,[(n(!0),u(W,null,z(e.manageAddress,(V,B)=>(n(),u("div",{class:"fc-manage-address-block-wrap",key:V.id},[a("div",{class:X(`cursor-pointer fc-manage-address-block ${V.is_primary==="1"?"default-address":""}  ${B===e.selectedAddressIndex?"selected":""} `),onClick:()=>{e.selectedAddressIndex=B}},[V.is_primary==="1"?(n(),P(c,{key:0,type:"info",round:""},{default:i(()=>[C(r(e.$t("Default")),1)]),_:1})):g("",!0),a("p",null,[a("strong",null,r(V.name),1),C(" "+r(e.getOrderAddress(V,"",!0)),1)])],10,Xt),a("div",es,[o(w,{trigger:"click",class:"fc-more-option-wrap","popper-class":"fc-dropdown",onCommand:e.handleAddressCommand},{dropdown:i(()=>[o(v,null,{default:i(()=>[o(d,{command:{action:"edit",data:V}},{default:i(()=>[C(r(e.$t("Edit")),1)]),_:2},1032,["command"]),o(d,{command:{action:"use",data:V}},{default:i(()=>[C(r(e.$t("Use this address")),1)]),_:2},1032,["command"]),o(d,{command:{action:"set-as-also",data:V}},{default:i(()=>[C(r(s.modalAction.type==="billing"?e.$t("Copy to Shipping"):e.$t("Copy to Billing")),1)]),_:2},1032,["command"]),V.is_primary!=="1"?(n(),u(W,{key:0},[o(d,{command:{action:"default",data:V}},{default:i(()=>[C(r(e.$t("Set as default")),1)]),_:2},1032,["command"]),o(d,{command:{action:"remove",data:V},class:"item-destructive"},{default:i(()=>[C(r(e.$t("Delete")),1)]),_:2},1032,["command"])],64)):g("",!0)]),_:2},1024)]),default:i(()=>[a("span",ts,[o(R,{name:"More"})])]),_:2},1032,["onCommand"])])]))),128)),e.manageAddress.length==0?(n(),u("div",ss,r(s.modalAction.type==="billing"?e.$t("No billing address found."):e.$t("No shipping address found.")),1)):g("",!0)])):g("",!0),e.isEditAddress?(n(),u("div",ls,[o($,{text:"",onClick:l[0]||(l[0]=()=>e.isEditAddress=!1),style:{"margin-bottom":"16px"}},{default:i(()=>[o(N,null,{default:i(()=>[o(M(Pe))]),_:1}),C(" "+r(e.$t("Manage address")),1)]),_:1}),o(De,{"onUpdate:refreshAddress":l[1]||(l[1]=V=>{e.isEditAddress=V,e.updateAddress()}),customer_id:s.customer_id,modalAction:s.modalAction,address:e.address,showAddressModal:e.isEditAddress,order_id:s.order_id,onCloseModal:l[2]||(l[2]=V=>e.showModal=!1)},null,8,["customer_id","modalAction","address","showAddressModal","order_id"])])):g("",!0),e.isEditAddress?g("",!0):(n(),u("div",as,[e.selectedAddressIndex!=null?(n(),P($,{key:0,onClick:l[3]||(l[3]=V=>e.emitAddressSelected())},{default:i(()=>[o(R,{name:"LocationPin"}),C(" "+r(e.$t("Use this address")),1)]),_:1})):g("",!0),o($,{onClick:l[4]||(l[4]=V=>e.emitAddNewAddress(s.modalAction.type)),type:"primary"},{default:i(()=>[o(R,{name:"Plus"}),C(" "+r(e.$t("Add new address")),1)]),_:1})]))]),_:1},8,["modelValue","onOpen","title"])])}}}),ns={class:"fc-term-container"},rs={class:"fc-term-input-wrap"},is={key:0,class:"fc-term-search-result-button-wrap mb-1.5"},us={class:"search-text"},cs={key:1,class:"fc-term-search-result-list is-scrollable"},ms=["value","checked","onChange"],ps={key:2,class:"empty-text"},_s={key:0,class:"fc-term-selected-list"},fs={class:"fc-term-selected"},vs={class:"text"},hs={class:"fc-term-list-header"},gs={class:"fc-term-input-inline-wrap"},ys={key:0,class:"fc-term-list-header-button-wrap"},bs={class:"search-text"},Cs={class:"fc-term-list-wrap is-scrollable"},As={key:0,class:"fc-term-list newly-added-list"},ws={class:"title"},ks={class:"fc-term-label"},$s=["value","checked","onChange"],Ms={key:1,class:"fc-term-list to-add-list"},Ls={class:"title"},Is={class:"fc-term-label"},Vs=["value","checked","onChange"],Es={key:2,class:"fc-term-list available-list"},Ss={class:"title"},Ts={class:"fc-term-label"},xs=["value","checked","onChange"],Os={key:3,class:"empty-text"},Us={class:"dialog-footer"},je={__name:"Modal",props:{bindToType:{type:String},bindToId:{type:[String,Number]},selected_labels:{type:Array,default:[]},labelModalIsOpen:{type:Boolean,default:!1},shouldEnableEditing:{type:Boolean,default:!0}},emits:["update:update-label","close-label-modal"],setup(s,{emit:e}){const l=Se().ctx,A=s,c=e,d=T([]),v=T([]),w=T([]),N=T(),$=T(""),U=T([]),V=T([]),B=T(!1),p=T(!1),y=T(A.labelModalIsOpen),O=T("");ae(()=>A.labelModalIsOpen,t=>{y.value=t,t&&(w.value=[...d.value])});const m=t=>{t.stopPropagation(),t.preventDefault(),L()},_=()=>{l.$get("labels").then(t=>{U.value=t.labels,d.value=A.selected_labels}).catch(t=>{t.status_code=="422"?x.validationErrors(t):x.error(t.message)}).finally(()=>{})},L=(t="")=>{const b=$.value||O.value;l.$post("labels",{value:b,bind_to_type:A.bindToType,bind_to_id:A.bindToId}).then(D=>{$.value="",O.value="",U.value.push(D.data),t!=="insideModal"?d.value.push(D.data.id):v.value.push(D.data.id),c("update:update-label",d.value)}).catch(D=>{x.error(D)})};ae($,t=>{t?(t=t.trim(),V.value=U.value.filter(b=>b.value.toLowerCase().includes(t.toLowerCase())),B.value=!0):(V.value=[],B.value=!1)});const S=t=>{const b=d.value.indexOf(t);b===-1?d.value.push(t):d.value.splice(b,1),c("update:update-label",d.value)},I=t=>{const b=w.value.indexOf(t);b===-1?w.value.push(t):w.value.splice(b,1)},j=t=>{const b=v.value.indexOf(t);b===-1?v.value.push(t):v.value.splice(b,1)},ue=()=>{d.value=[...w.value,...v.value],v.value=[],c("update:update-label",d.value),te()},oe=t=>{const b=d.value.indexOf(t);b!==-1&&(d.value.splice(b,1),c("update:update-label",d.value))},de=t=>{B.value&&!N.value.$el.contains(t.target)&&!p.value.contains(t.target)&&(B.value=!1,$.value="")},ne=K(()=>U.value.filter(t=>d.value.includes(t.id))),ee=K(()=>U.value.filter(t=>v.value.includes(t.id))),G=K(()=>U.value.filter(t=>w.value.includes(t.id)).filter(t=>t.value.toLowerCase().includes(O.value.trim().toLowerCase()))),J=K(()=>U.value.filter(t=>!w.value.includes(t.id)).filter(t=>!v.value.includes(t.id)).filter(t=>t.value.toLowerCase().includes(O.value.trim().toLowerCase())).sort((t,b)=>t.value.localeCompare(b.value))),te=()=>{c("close-label-modal")},f=K(()=>{const t=O.value.trim().toLowerCase(),b=$.value.trim().toLowerCase();return(t||b)===""||V.value.some(D=>D.value.toLowerCase()===t||D.value.toLowerCase()===b)||G.value.some(D=>D.value.toLowerCase()===t||D.value.toLowerCase()===b)||J.value.some(D=>D.value.toLowerCase()===t||D.value.toLowerCase()===b)});return pe(()=>{_(),document.addEventListener("click",de)}),He(()=>{document.removeEventListener("click",de)}),(t,b)=>{const D=k("el-input"),Z=k("el-button"),Q=k("el-dialog");return n(),u("div",ns,[a("div",rs,[s.shouldEnableEditing?(n(),P(D,{key:0,ref_key:"inputRef",ref:N,modelValue:$.value,"onUpdate:modelValue":b[0]||(b[0]=E=>$.value=E),onKeydown:ze(m,["enter"])},null,8,["modelValue"])):g("",!0),B.value?(n(),u("div",{key:1,class:"fc-term-search-result",ref_key:"suggestionsRef",ref:p,style:qe($.value==""?"display: none":"")},[$.value!==""&&!f.value?(n(),u("div",is,[o(Z,{type:"info",plain:"",onClick:L,size:"small"},{default:i(()=>[o(R,{name:"PlusCircle"}),C(" "+r(t.$t("Add"))+" ",1),a("span",us,'"'+r($.value)+'"',1)]),_:1})])):g("",!0),V.value.length>0?(n(),u("ul",cs,[(n(!0),u(W,null,z(V.value,(E,H)=>(n(),u("li",{key:H},[a("label",null,[a("input",{type:"checkbox",value:E.id,checked:d.value.includes(E.id),onChange:se=>S(E.id)},null,40,ms),C(" "+r(E.value),1)])]))),128))])):g("",!0),V.value.length===0?(n(),u("p",ps,r(t.$t("No labels found.")),1)):g("",!0)],4)):g("",!0)]),ne.value.length>0?(n(),u("ul",_s,[(n(!0),u(W,null,z(ne.value,E=>(n(),u("li",{key:E.id},[a("div",fs,[a("div",vs,r(E.value),1),s.shouldEnableEditing?(n(),P(R,{key:0,name:"Cross",onClick:H=>oe(E.id)},null,8,["onClick"])):g("",!0)])]))),128))])):g("",!0),o(Q,{"before-close":te,"append-to-body":!0,width:"45%",modelValue:y.value,"onUpdate:modelValue":b[3]||(b[3]=E=>y.value=E),title:t.$t("Add labels"),class:"fc-add-labels-modal"},{default:i(()=>[a("div",hs,[a("div",gs,[o(D,{modelValue:O.value,"onUpdate:modelValue":b[1]||(b[1]=E=>O.value=E),placeholder:t.$t("Search to find or create labels")},{prefix:i(()=>[o(R,{name:"Search"})]),_:1},8,["modelValue","placeholder"])]),O.value!==""&&!f.value?(n(),u("div",ys,[o(Z,{type:"info",plain:"",onClick:b[2]||(b[2]=E=>L("insideModal")),size:"small"},{default:i(()=>[o(R,{name:"PlusCircle"}),C(" "+r(t.$t("Add"))+" ",1),a("span",bs,'"'+r(O.value)+'"',1)]),_:1})])):g("",!0)]),a("div",Cs,[ee.value.length>0?(n(),u("ul",As,[a("li",ws,r(t.$t("Newly added")),1),(n(!0),u(W,null,z(ee.value,E=>(n(),u("li",{key:E.id},[a("label",ks,[a("input",{type:"checkbox",value:E.id,checked:v.value.includes(E.id),onChange:H=>j(E.id)},null,40,$s),C(" "+r(E.value),1)])]))),128))])):g("",!0),G.value.length>0?(n(),u("ul",Ms,[a("li",Ls,r(t.$t("To add")),1),(n(!0),u(W,null,z(G.value,E=>(n(),u("li",{key:E.id},[a("label",Is,[a("input",{type:"checkbox",value:E.id,checked:w.value.includes(E.id),onChange:H=>I(E.id)},null,40,Vs),C(" "+r(E.value),1)])]))),128))])):g("",!0),J.value.length>0?(n(),u("ul",Es,[a("li",Ss,r(t.$t("Available")),1),(n(!0),u(W,null,z(J.value,E=>(n(),u("li",{key:E.id},[a("label",Ts,[a("input",{type:"checkbox",value:E.id,checked:w.value.includes(E.id),onChange:H=>I(E.id)},null,40,xs),C(" "+r(E.value),1)])]))),128))])):g("",!0),G.value.length===0&&J.value.length===0&&ee.value.length===0?(n(),u("p",Os,r(t.$t("No labels found.")),1)):g("",!0)]),a("div",Us,[o(Z,{onClick:te},{default:i(()=>[C(r(t.$t("Cancel")),1)]),_:1}),o(Z,{type:"primary",onClick:ue},{default:i(()=>[C(r(t.$t("Done")),1)]),_:1})])]),_:1},8,["modelValue","title"])])}}},Ns={class:"fc-admin-sidebar-item"},Ps={name:"Labels",props:{bindToType:{type:String},bindToId:{type:[String,Number]},selectedLabels:{type:Array,default:()=>[]},shouldEnableEditing:{type:Boolean,default:!0}},components:{IconButton:fe,LabelModal:je,DynamicIcon:R},data(){return{labelModalIsOpen:!1}},methods:{openLabelModal(){this.labelModalIsOpen=!0},updateLabel(s){this.bindToId&&this.bindToType&&this.$post("labels/update-label-selections",{bind_to_type:this.bindToType,bind_to_id:this.bindToId,selectedLabels:s}).then(e=>{x.success(e.message)}).catch(e=>{x.error(e.message)}),this.$emit("update:update-label",s)},closeLabel(){this.labelModalIsOpen=!1}},mounted(){}},la=Object.assign(Ps,{setup(s){return(e,l)=>(n(),P(Be,{permission:"labels/manage"},{default:i(()=>[a("div",null,[o(Oe,null,{default:i(()=>[o(Te,{title:e.$t("Labels"),border_bottom:"",title_size:"small"},{action:i(()=>[s.shouldEnableEditing?(n(),P(fe,{key:0,size:"x-small",bg:"transparent",tag:"button",border:"transparent",onClick:e.openLabelModal},{default:i(()=>[o(R,{name:"Edit"})]),_:1},8,["onClick"])):g("",!0)]),_:1},8,["title"]),o(xe,null,{default:i(()=>[a("div",Ns,[o(je,{bindToType:s.bindToType,bindToId:s.bindToId,labelModalIsOpen:e.labelModalIsOpen,selected_labels:s.selectedLabels,shouldEnableEditing:s.shouldEnableEditing,"onUpdate:updateLabel":e.updateLabel,onCloseLabelModal:l[0]||(l[0]=A=>e.labelModalIsOpen=!1)},null,8,["bindToType","bindToId","labelModalIsOpen","selected_labels","shouldEnableEditing","onUpdate:updateLabel"])])]),_:1})]),_:1})])]),_:1}))}}),Bs={class:"fc-customer-edit-modal"},Ds={key:1,class:"fc-form-group"},js={class:"label"},Rs={style:{display:"flex","align-items":"center",gap:"10px"}},Fs={class:"select-use-option"},Ws={class:"fc-compact-form"},Hs={class:"form-heading"},zs={class:"fc-compact-form fc-customer-address-section"},qs={style:{"margin-top":"20px"}},Ks={class:"form-error-wrap"},Zs={class:"form-error-text"},Qs={class:"dialog-footer"},Ys={key:3,class:"dialog-footer"},Gs={__name:"ChangeOrderCustomer",props:{orderId:{type:[String,Number],default:null,required:!0}},setup(s){const e=s,l=T(null),A=T([]),c=T(!1),d=T(!1),v=T({}),w=T({id:"",email:"",full_name:"",state:"",city:"",country:"",postcode:"",country_name:"",contact_id:"",user_id:"",wp_user:""}),N=p=>{if(!p){A.value=[];return}q.get("customers/",{search:p}).then(y=>{A.value=y.customers.data}).finally(()=>{})},$=()=>{if(!l.value){x.error(h("Please select a customer"));return}q.post("orders/"+e.orderId+"/change-customer",{customer_id:l.value}).then(p=>{x.success(p.message),setTimeout(()=>{window.location.reload()},300)}).catch(p=>{if(p.message)return x.error(p.message);console.log("errors",p)}).finally(()=>{console.log("finally")})},U=()=>{q.post("orders/"+e.orderId+"/create-and-change-customer",w.value).then(p=>{x.success(p.message),setTimeout(()=>{window.location.reload()},300),v.value={},d.value=!1}).catch(p=>{if(p.message)return x.error(p.message);v.value=p}).finally(()=>{})},V=()=>{d.value=!0},B=()=>{d.value=!1};return(p,y)=>{const O=k("el-button"),m=k("el-option"),_=k("el-select"),L=k("el-checkbox");return n(),u("div",Bs,[d.value?(n(),u("div",{key:0,onClick:B,style:{"margin-bottom":"10px"}},[o(O,{text:"",style:{"margin-top":"0"}},{default:i(()=>[o(R,{name:"ArrowLeft"}),C(" "+r(M(h)("Back")),1)]),_:1})])):g("",!0),d.value?g("",!0):(n(),u("div",Ds,[a("label",js,[C(r(M(h)("Select Customer"))+" ",1),o(O,{text:"",class:"fc-create-customer-btn",onClick:Ee(V,["prevent"])},{default:i(()=>[o(R,{name:"Plus"}),C(" "+r(M(h)("Add New Customer")),1)]),_:1})]),a("div",Rs,[o(_,{modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=S=>l.value=S),remote:!0,"remote-method":N,loading:c.value,filterable:"",clearable:"",placeholder:M(h)("Type to search user"),style:{width:"100%"}},{default:i(()=>[(n(!0),u(W,null,z(A.value,S=>(n(),P(m,{key:S.id,label:S.full_name,value:S.id},{default:i(()=>[a("div",Fs,[a("span",null,r(S.full_name),1),a("span",null,r(S.email),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading","placeholder"])])])),d.value?(n(),u(W,{key:2},[a("div",Ws,[o(Y,{label:M(h)("Full Name"),modelValue:w.value.full_name,"onUpdate:modelValue":y[1]||(y[1]=S=>w.value.full_name=S)},null,8,["label","modelValue"]),o(Y,{label:M(h)("Email"),modelValue:w.value.email,"onUpdate:modelValue":y[2]||(y[2]=S=>w.value.email=S)},null,8,["label","modelValue"])]),a("h4",Hs,r(M(h)("Address")),1),a("div",zs,[o(ve,{modelValue:w.value,"onUpdate:modelValue":y[3]||(y[3]=S=>w.value=S)},null,8,["modelValue"]),a("div",qs,[o(L,{"true-value":"yes","false-value":"no",modelValue:w.value.wp_user,"onUpdate:modelValue":y[4]||(y[4]=S=>w.value.wp_user=S)},{default:i(()=>[o(Ne,{title:M(h)("Create as wordpress user"),content:M(h)("We will create a new user for this customer. If a user with the same email already exists, we will associate the customer with that existing user.")},null,8,["title","content"])]),_:1},8,["modelValue"])]),a("div",Ks,[(n(!0),u(W,null,z(v.value,S=>(n(),u("p",Zs,r(S.required),1))),256))])]),a("div",Qs,[o(O,{onClick:y[5]||(y[5]=S=>p.$emit("close"))},{default:i(()=>[C(r(M(h)("Cancel")),1)]),_:1}),o(O,{type:"primary",onClick:U},{default:i(()=>[C(r(M(h)("Create & Attach Customer")),1)]),_:1})])],64)):g("",!0),d.value?g("",!0):(n(),u("div",Ys,[o(O,{type:"primary",onClick:$},{default:i(()=>[C(r(M(h)("Create & Attach Customer")),1)]),_:1})]))])}}},Js={class:"fc-admin-sidebar"},Xs={class:"more-btn"},el={key:0,class:"fc-admin-sidebar-item"},tl={class:"name"},sl={class:"email"},ll={class:"fc-admin-sidebar-item"},al={class:"fc-profile-card"},ol=["src","alt"],dl={key:0,class:"fc-profile-details"},nl={class:"title"},rl={class:"text"},il={key:0},ul={class:"text"},cl={key:0,class:"user-info mt-2"},ml=["href"],pl={class:"fc-admin-sidebar-item mt-5"},_l={class:"fc-contact-info-list"},fl={class:"flex items-center justify-between gap-2"},vl=["href"],hl={class:"fc-admin-sidebar-item mt-5"},gl={class:"sidebar-title"},yl={key:0,class:"fc-address-copy-wrap"},bl={class:"text"},Cl={key:0,class:"pr-1"},Al=["innerHTML"],wl={key:1,class:"mt-4"},kl=["href"],$l={key:1,class:"no-address-text"},Ml={class:"fc-admin-sidebar-item mt-5"},Ll={class:"sidebar-title"},Il={key:0,class:"fc-address-copy-wrap"},Vl={class:"text"},El={key:0,class:"pr-1"},Sl=["innerHTML"],Tl={key:1,class:"mt-4"},xl=["href"],Ol={key:2,class:"mt-4"},Ul={class:"m-0"},Nl={key:1,class:"no-address-text"},Pl={class:"fluent-cart-admin-pages"},aa={__name:"OrderCustomerInformation",props:{order:{type:Object,default:()=>({})},shouldEnableEditing:{type:Boolean,default:!0}},emits:["onAddressSelected","onAddressRemove"],setup(s,{emit:e}){var ee,G,J,te;const l=s,A=T([]),c=T((G=(ee=l.order)==null?void 0:ee.customer)!=null&&G.id?l.order.customer:null),d=T((J=l.order)!=null&&J.billing_address?l.order.billing_address:null),v=T((te=l.order)!=null&&te.shipping_address?l.order.shipping_address:null),w=e,N=T(!1),$=f=>{f==="remove_customer"&&U(),f==="change_customer"?N.value=!0:f==="edit_customer"?L("edit"):f==="manage_billing_address"?j("billing"):f==="manage_shipping_address"&&j("shipping")},U=()=>{l.order.customer_id="",l.order.customer={},c.value=null,d.value=null,v.value=null,w("onAddressRemove"),setTimeout(()=>{oe()},50)},V=(f,t)=>{q.get("customers/",{search:f,with:["shipping_address","billing_address"]}).then(b=>{let D=b.customers.data;A.value=D;let Z=D.map(se=>({id:se.id,value:se.full_name,email:se.email})),Q=jQuery(".fc-customer-autocomplete-dropdown"),E=jQuery(".el-autocomplete-suggestion__list"),H="empty-text";D.length<1?Q.length>0&&(Q.addClass("is-empty-customer"),E.children(`.${H}`).length||E.prepend(`<li class="${H}">No customer found.</li>`)):Q.length>0&&(Q.removeClass("is-empty-customer"),E.children(`.${H}`).remove()),t(Z)}).catch(b=>{x.error(b)})},B=f=>{const t=A.value.find(b=>b.id===f.id)??null;p(t)},p=f=>{c.value=f,l.order.customer=f,l.order.customer_id=f.id,c.value!==null&&(y(),O())},y=()=>{const f=c.value.billing_address;f&&(Array.isArray(f)&&f.length>0?(d.value=f[0],d.value=f.find(t=>t.is_primary.toString()==="1")??d.value):d.value=null,w("onAddressSelected",d.value))},O=()=>{const f=c.value.shipping_address;f&&(Array.isArray(f)&&f.length>0?(v.value=f[0],v.value=f.find(t=>t.is_primary.toString()==="1")??v.value):v.value=null,w("onAddressSelected",v.value))},m=f=>{f&&q.post(`orders/${l.order.id}/update-address-id`,{address_id:f.id,address_type:f.type}).then(t=>{x.success(t.message),f.type==="shipping"?v.value=f:d.value=f,I.value.showModal=!1,w("onAddressSelected",f)}).catch(t=>{x.error(t)})},_=T({showModal:!1,action:"create",title:h("Create New Customer"),customer:{},manageWpUser:"yes"}),L=(f="create")=>{const t=_.value;t.showModal=!0,t.action=f==="create"?"create":"edit",t.title=f==="create"?h("Create New Customer"):h("Edit Customer Information"),t.customer_id=f==="create"?null:c.value.id,t.customer=f==="create"?{}:c.value,t.manageWpUser=f==="create"?"yes":c.value.user_id==="0"?"no":"yes",_.value=t},S=T(!0),I=T({showManageAddressModal:!1,showModal:!1,modalAction:{type:"billing",action:"create"},title:"",customer_id:"",address_id:"",address:{},address_mock:{name:"",phone:"",email:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:"",is_primary:"0"}}),j=(f="billing",t="edit")=>{I.value.showManageAddressModal=!0,I.value.modalAction.type=f,I.value.modalAction.action=t},ue=(f="billing",t="create",b={})=>{Object.keys(b).length>0?(I.value.address={...b},S.value=!1):I.value.address={...I.value.address_mock},I.value.showModal=!0,I.value.modalAction.type=f,I.value.modalAction.action=t,I.value.showManageAddressModal=!1},oe=()=>{let f=jQuery(".el-autocomplete-suggestion__wrap");if(f.length>0){let t=jQuery('<div class="fc-create-customer-button-wrap"><button class="el-button el-button--info el-button--small is-plain"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M1.5 7H12.5M7 1.5V12.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg> Create a new customer</button></div>').on("click",()=>{L()});f.prepend(t)}},de=()=>I.value.modalAction.action==="create"?I.value.modalAction.type==="billing"?h("Add new billing address"):h("Add new shipping Address"):I.value.modalAction.type==="billing"?h("Edit billing address"):h("Edit shipping address"),ne=(f,t)=>{I.value.modalAction.type==="billing"?d.value=t:v.value=t,I.value.showModal=f,I.value.showManageAddressModal=!0,m(t)};return ae(l.order,(f,t)=>{f.customer_id!==t.customer_id&&U()}),pe(()=>{oe()}),(f,t)=>{var ge;const b=k("el-dropdown-item"),D=k("el-dropdown-menu"),Z=k("el-dropdown"),Q=k("el-autocomplete"),E=k("router-link"),H=k("el-icon"),se=k("el-button"),he=k("el-dialog");return n(),u(W,null,[a("div",Js,[o(Oe,null,{default:i(()=>[o(Te,{title:M(h)("Customer Information"),title_size:"small",border_bottom:""},{action:i(()=>[c.value&&s.shouldEnableEditing?(n(),P(Z,{key:0,trigger:"click",class:"fc-more-option-wrap","popper-class":"fc-dropdown",onCommand:$},{dropdown:i(()=>[o(D,null,{default:i(()=>[o(b,{command:"edit_customer"},{default:i(()=>[C(r(M(h)("Edit customer information")),1)]),_:1}),o(b,{command:"manage_shipping_address"},{default:i(()=>[C(r(M(h)("Manage shipping address")),1)]),_:1}),o(b,{command:"manage_billing_address"},{default:i(()=>[C(r(M(h)("Manage billing address")),1)]),_:1}),s.order.id?(n(),P(b,{key:0,command:"change_customer"},{default:i(()=>[C(r(M(h)("Change customer")),1)]),_:1})):g("",!0),s.order.id?g("",!0):(n(),P(b,{key:1,command:"remove_customer"},{default:i(()=>[C(r(M(h)("Remove customer")),1)]),_:1}))]),_:1})]),default:i(()=>[a("span",Xs,[o(R,{name:"More"})])]),_:1})):g("",!0)]),_:1},8,["title"]),o(xe,null,{default:i(()=>{var F,ye,be,Ce,Ae,we,ke,$e,Me,Le,Ie,Ve;return[c.value===null?(n(),u("div",el,[o(Q,{"popper-class":"fc-customer-autocomplete-dropdown",clearable:"",modelValue:s.order.customer.full_name,"onUpdate:modelValue":t[0]||(t[0]=le=>s.order.customer.full_name=le),"fetch-suggestions":V,placeholder:M(h)("Search or create a customer"),disabled:!1,onSelect:B},{prefix:i(()=>[o(R,{name:"Search"})]),default:i(le=>[a("span",tl,r(le.item.value),1),a("span",sl,r(le.item.email),1)]),_:1},8,["modelValue","placeholder"])])):(n(),u(W,{key:1},[a("div",ll,[a("div",al,[a("div",{class:"fc-profile-image cursor-pointer",onClick:t[1]||(t[1]=le=>f.$router.push({name:"view_customer",params:{customer_id:c.value.id}}))},[a("img",{src:c.value.photo,alt:(F=c.value)==null?void 0:F.full_name},null,8,ol)]),c.value.id?(n(),u("div",dl,[a("div",nl,[o(E,{to:{name:"view_customer",params:{customer_id:c.value.id}}},{default:i(()=>[C(r(c.value.full_name),1)]),_:1},8,["to"])]),a("span",rl,[c.value.purchase_count>0?(n(),u("span",il,r(c.value.purchase_count),1)):g("",!0),C(" "+r(f.$n("Order","Orders",c.value.purchase_count??0,"No Order")),1)]),a("span",ul,r(M(et)((ye=c.value)==null?void 0:ye.ltv,!0))+" "+r(M(h)("Lifetime Value")),1)])):g("",!0)]),s.order.customer.user_link?(n(),u("div",cl,[t[10]||(t[10]=C(" WP User: ",-1)),a("a",{href:s.order.customer.user_link,target:"_blank",class:"inline-flex items-center gap-1 dark:text-gray-100 text-primary-500 focus:shadow-none hover:!underline"},[C(" #"+r(s.order.customer.user_id)+" ",1),o(R,{name:"Redirect",class:"w-2.5 h-2.5 text-primary-500 dark:text-gray-200"})],8,ml)])):g("",!0)]),a("div",pl,[a("ul",_l,[a("li",null,[a("div",fl,[a("a",{class:"text",href:"mailto:"+((be=s.order.customer)==null?void 0:be.email)},r(c.value.email),9,vl),o(re,{text:c.value.email,showMode:"basic_copy_btn",tooltipText:"Copy email"},null,8,["text"])])])])]),a("div",hl,[a("h4",gl,r(M(h)("Shipping Address")),1),v.value!=null?(n(),u("div",yl,[a("span",bl,[v.value.name?(n(),u("strong",Cl,r(v.value.name),1)):g("",!0),a("span",{class:"break-all",innerHTML:f.getOrderAddress({...v.value},"shipping",!0)},null,8,Al),(we=(Ae=(Ce=v.value)==null?void 0:Ce.meta)==null?void 0:Ae.other_data)!=null&&we.phone?(n(),u("div",wl,[a("a",{href:"tel:"+v.value.meta.other_data.phone,class:"text-system-dark"},r(v.value.meta.other_data.phone),9,kl)])):g("",!0)]),o(re,{text:f.getOrderAddress({...v.value},"shipping"),showMode:"basic_copy_btn",tooltipText:"Copy address"},null,8,["text"])])):(n(),u("p",$l,r(M(h)("No shipping address provided")),1))]),a("div",Ml,[a("h4",Ll,r(M(h)("Billing Address")),1),d.value!=null?(n(),u("div",Il,[a("span",Vl,[d.value.name?(n(),u("strong",El,r(d.value.name),1)):g("",!0),a("span",{class:"break-all",innerHTML:f.getOrderAddress({...d.value},"billing",!0)},null,8,Sl),(Me=($e=(ke=d.value)==null?void 0:ke.meta)==null?void 0:$e.other_data)!=null&&Me.phone?(n(),u("div",Tl,[a("a",{href:"tel:"+d.value.meta.other_data.phone,class:"text-system-dark"},r(d.value.meta.other_data.phone),9,xl)])):g("",!0),(Ve=(Ie=(Le=d.value)==null?void 0:Le.meta)==null?void 0:Ie.other_data)!=null&&Ve.company_name?(n(),u("div",Ol,[a("b",null,r(M(h)("Company")),1),a("p",Ul,r(d.value.meta.other_data.company_name),1)])):g("",!0)]),o(re,{text:f.getOrderAddress({...d.value},"billing"),showMode:"basic_copy_btn",tooltipText:"Copy address"},null,8,["text"])])):(n(),u("p",Nl,r(M(h)("No shipping address provided")),1))])],64))]}),_:1})]),_:1})]),o(rt,{onSelectNewCustomer:t[2]||(t[2]=F=>{p(F),_.value.showModal=!1}),customerModalInfos:_.value,customer_id:_.value.customer_id,customer:_.value.customer,onCloseModal:t[3]||(t[3]=F=>_.value.showModal=!1)},null,8,["customerModalInfos","customer_id","customer"]),o(ds,{modalAction:I.value.modalAction,onOnAddressSelected:m,"onUpdate:showAddressModal":t[4]||(t[4]=F=>I.value.showManageAddressModal=F),showAddressModal:I.value.showManageAddressModal,customer_id:(ge=c.value)==null?void 0:ge.id,order_id:s.order.id,onAddNewAddress:ue},null,8,["modalAction","showAddressModal","customer_id","order_id"]),o(he,{"show-close":!0,modelValue:I.value.showModal,"onUpdate:modelValue":t[7]||(t[7]=F=>I.value.showModal=F),"append-to-body":!0,title:de()},{default:i(()=>{var F;return[a("div",Pl,[o(se,{text:"",onClick:t[5]||(t[5]=()=>{I.value.showManageAddressModal=!0,I.value.showModal=!1}),class:"mb-4"},{default:i(()=>[o(H,null,{default:i(()=>[o(M(Pe))]),_:1}),C(" "+r(f.$t("Manage address")),1)]),_:1}),o(De,{"onUpdate:refreshAddress":ne,customerAddressModalInfos:I.value,customer_id:c.value.id,modalAction:I.value.modalAction,address:I.value.address,showAddressModal:I.value.showModal,showSetAsAlsoCheckbox:S.value,order_id:(F=s.order)==null?void 0:F.id,onCloseModal:t[6]||(t[6]=()=>{I.value.showModal=!1,I.value.showManageAddressModal=!0})},null,8,["customerAddressModalInfos","customer_id","modalAction","address","showAddressModal","showSetAsAlsoCheckbox","order_id"])])]}),_:1},8,["modelValue","title"]),s.order.id?(n(),P(he,{key:0,modelValue:N.value,"onUpdate:modelValue":t[9]||(t[9]=F=>N.value=F),title:f.$t("Change Customer")},{default:i(()=>[o(Gs,{"order-id":s.order.id,onClose:t[8]||(t[8]=F=>N.value=!1)},null,8,["order-id"])]),_:1},8,["modelValue","title"])):g("",!0)],64)}}};export{sa as L,ta as O,Lt as P,Be as _,rt as a,De as b,ds as c,la as d,aa as e,Gs as f,ut as p};
