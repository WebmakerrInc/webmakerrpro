import{j as e,b as a}from"./BlockEditorTranslator-Do4trUgb.js";import{f as P}from"./Icons-B2jBVdSk.js";import{a as v}from"./index-BYEX9EM_.js";import{I as k,L as S,E as g}from"./ProductListItem-D_5QaYKg.js";import"./index-CGoo2crO.js";import{a as E}from"./add-query-args-COp5A_Oq.js";const{useEffect:w,useState:h}=wp.element,j=window.fluentCartRestVars.rest,C=({prevSelectedProduct:c,onProductSelectionUpdated:l})=>{const f=j.url+"/products",[r,n]=h(!1),[i,p]=h({}),[o,m]=h({}),b=(s,t)=>{m(s),typeof l=="function"&&l(s)},x=(s=null)=>{n(!0),p({}),v({path:E(f,{...{with:["detail","variants"],active_view:"publish",per_page:10,page:1,order_by:"ID",order_type:"DESC",search:s}}),headers:{"X-WP-Nonce":j.nonce}}).then(d=>{let u=d.products.data;p(u)}).finally(()=>{n(!1)})};w(()=>{x()},[]);const N=s=>{x(s)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fc-popup-search-wrap",children:e.jsx(k,{icon:!0,name:"search",placeholder:a("Type to search for products, then hit Enter"),onKeyDown:s=>{const t=s.target.value;s.key==="Enter"&&N(t)}})}),e.jsx("div",{className:"fc-popup-body-inner",children:r?e.jsx("div",{className:"fc-skeleton-container",children:[...Array(9)].map((s,t)=>e.jsx("div",{className:"skeleton skeleton-item"},t))}):Object.keys(i).length>0?e.jsx("div",{className:"fc-popup-product-list-container",children:e.jsx("ul",{className:"fc-collapsible-list",children:i.map((s,t)=>{var d,u;return e.jsx("li",{className:"fc-collapsible-list-item",children:e.jsx("div",{className:"fc-collapsible-list-item-inner",children:e.jsx(S,{variant:s,title:s==null?void 0:s.post_title,checked:(c==null?void 0:c.ID)===s.ID,media:(u=(d=s==null?void 0:s.detail)==null?void 0:d.featured_media)==null?void 0:u.url,updateSelectedVariations:b})})},t)})})}):e.jsx(g,{text:a("We couldn't find any products matching your search")})})]})},{useEffect:O,useState:y}=wp.element,q=({onModalClosed:c,buttonLabel:l=a("Add Product")})=>{const[f,r]=y(!1),[n,i]=y({}),p=()=>{r(!0)},o=()=>{r(!1),typeof c=="function"&&c(n)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"fc-button fc-button-secondary",onClick:p,children:a("Select Product")}),f&&e.jsxs("div",{className:"fc-popup-container",children:[e.jsx("div",{className:"fc-popup-overlay",onClick:o}),e.jsxs("div",{className:"fc-popup-inner-container",children:[e.jsxs("div",{className:"fc-popup-head",children:[e.jsx("h4",{className:"fc-popup-head-title",children:a("Select Product")}),e.jsx("button",{type:"button",className:"fc-popup-close",onClick:o,children:e.jsx(P,{})})]}),e.jsx("div",{className:"fc-popup-body",children:e.jsx(C,{prevSelectedProduct:n,onProductSelectionUpdated:m=>{i(m)}})}),e.jsxs("div",{className:"fc-popup-footer",children:[e.jsx("button",{className:"fc-button fc-button-info-soft",onClick:o,children:a("Cancel")}),e.jsx("button",{className:"fc-button fc-button-primary",onClick:()=>{o()},children:l})]})]})]})]})};export{q as S};
