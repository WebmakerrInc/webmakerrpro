import{U as k}from"./Utils-rKpXNRVE.js";import{X as v,Y as b,o as r,b as h,K as N,w as n,a as f,c as d,e as c,F as _,h as V,g,t as u}from"./vue.esm-bundler-VLZRLwDo.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";const x={name:"ProductVariationSelector",props:{modelValue:{type:[Array,String,Number],default:()=>[]},is_multiple:{type:Boolean,default:!0},popoverClass:{type:String,default:""}},emits:["update:modelValue"],computed:{Utils(){return k},selectedFormattedItems(){let s=this.selectedVariationIds;if(this.is_multiple||(s=[],this.selectedVariationIds&&s.push(this.selectedVariationIds)),!s||!(s!=null&&s.length))return null;let a={},i={};this.products.forEach(t=>{a[t.label]=t.children,t.children.forEach(e=>{i[e.value]={productName:t.label,variationName:e.label}})});let l={};return s.forEach(t=>{if(i[t]){let e=i[t];l[e.productName]||(l[e.productName]=[]),l[e.productName].push(e.variationName)}else l.Unknown||(l.Unknown=[]),l.Unknown.push(t)}),Object.keys(l).forEach(t=>{var e;l[t].length===((e=a[t])==null?void 0:e.length)&&(l[t]=[])}),l}},watch:{selectedVariationIds(s){this.$emit("update:modelValue",s)},modelValue(s){this.selectedVariationIds=s}},data(){return{products:[],selectedVariationIds:this.modelValue,loading:!1}},methods:{searchProducts(s=""){this.loading=!0,this.$get("products/search-product-variant-options",{search:s,include_ids:this.is_multiple?this.selectedVariationIds:[this.selectedVariationIds]}).then(a=>{this.products=a.products}).catch(a=>{console.error("error -> ",a)}).finally(()=>{this.loading=!1})},filterNodeMethod(s,a){return a}},mounted(){this.is_multiple?Array.isArray(this.selectedVariationIds)||(this.selectedVariationIds=[]):this.selectedVariationIds=this.selectedVariationIds?parseInt(this.selectedVariationIds):null,this.searchProducts()}},U={key:0,class:"flex items-center flex-wrap gap-1.5"},F={key:0},P={key:0,class:"flex items-center flex-wrap gap-1.5"},S={key:0};function C(s,a,i,l,t,e){const p=f("el-tag"),I=f("el-tree-select"),y=b("loading");return v((r(),h(I,{modelValue:t.selectedVariationIds,"onUpdate:modelValue":a[0]||(a[0]=o=>t.selectedVariationIds=o),data:t.products,"filter-method":e.Utils.debounce(e.searchProducts),"filter-node-method":e.filterNodeMethod,filterable:"","show-checkbox":"",multiple:i.is_multiple,clearable:"",placeholder:s.$t("Select product"),"popper-class":i.popoverClass},N({_:2},[i.is_multiple?{name:"tag",fn:n(()=>[e.selectedFormattedItems?(r(),d("div",P,[(r(!0),d(_,null,V(e.selectedFormattedItems,(o,m)=>(r(),h(p,{class:"mr-2"},{default:n(()=>[g(u(m)+" ",1),o.length?(r(),d("span",S," | "+u(o.join(", ")),1)):c("",!0)]),_:2},1024))),256))])):c("",!0)]),key:"1"}:{name:"label",fn:n(()=>[e.selectedFormattedItems?(r(),d("div",U,[(r(!0),d(_,null,V(e.selectedFormattedItems,(o,m)=>(r(),h(p,{class:"mr-2"},{default:n(()=>[g(u(m)+" ",1),o.length?(r(),d("span",F," | "+u(o.join(", ")),1)):c("",!0)]),_:2},1024))),256))])):c("",!0)]),key:"0"}]),1032,["modelValue","data","filter-method","filter-node-method","multiple","placeholder","popper-class"])),[[y,t.loading]])}const A=w(x,[["render",C]]);export{A as P};
