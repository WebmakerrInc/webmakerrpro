import{a as u,c as d,o as n,f as s,d as l,F as M,h as L,w as m,t as i,u as A,b as C,e as b,g as v,r as ht,Y as O,X as U,C as pt,T as ft,z as gt,x as yt,i as j,m as st,j as re,aD as bt,A as q,aE as vt,a5 as wt,p as kt}from"./vue.esm-bundler-VLZRLwDo.js";import{f as F}from"./common-BPfjXdxy.js";import{_ as I}from"./DynamicIcon-B1vpMEi_.js";import{B as V,I as W,P as G,S as Ct}from"./Badge-DsywDH_m.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as at,C as $t,b as J,c as te}from"./CopyToClipboard-O88DxGEb.js";import{u as At,S as le,c as Mt,d as St}from"./Str-DQr93RbR.js";import{b as ot,E as se,an as K,A as de,a5 as ce,a4 as ue,ap as _e,aq as me,ao as Pt}from"./index-BSdFqZUc.js";import Dt from"./ArrowDown-BKBt5uqB.js";import Et from"./ArrowUp-CR0uQfH6.js";import{n as T}from"./Notify-DKZN7muO.js";import{R as z}from"./Rest-U7WPPDzn.js";import{q as he,r as pe,t as fe,v as ge,E as ye,w as be,h as ve,x as we,a as ke,y as Ce,z as $e,A as Ae,c as Me,k as Se,n as Pe,B as De,C as Ee,p as xe,D as Te,F as Le,G as Ve,H as Ie,I as Be,J as Ne,K as Ue,L as Fe,M as He,N as qe,O as Oe,P as Re,Q as ze,R as je,S as Ke,T as Ye,l as Ze,U as We,V as Ge,W as Je,X as Xe,Y as Qe,Z as et,_ as tt}from"./index-DXJWUF1E.js";import{v as xt}from"./directive-DmTibLFt.js";import"./dayjs.min-2rai63wT.js";import"./Arr-MwYQQ3qa.js";import"./timezone-C2U15obx.js";import"./Translator-B6cROAk_.js";import"./index-CA48fF9Y.js";function g(e){var t;e=((t=window.fluentcart_customer_profile_vars)==null?void 0:t.trans[e])||e;const a=Array.prototype.slice.call(arguments,1);if(a.length===0)return e;const o=/%(\d*\$?)s|%d/g;let h=0;return e=e.replace(o,(r,_)=>{if(_){const c=parseInt(_,10)-1;return c<a.length?a[c]:r}else return h<a.length?a[h++]:r}),e}function Y(e,a,o,h=null){let t=parseInt(o.toString().replace(/,/g,""),10);return t>1?g(a,o):g(t===0?h??e:e,o)}const Tt={class:"fc-customer-dashboard-table"},Lt={class:"order-content-only-mobile"},Vt={class:"item-header"},It={class:"block truncate max-w-[100px]"},Bt={class:"text-system-light text-sm"},Nt={class:"item-body"},Ut={class:"fc-customer-orders-items fc-customer-orders-items-2"},Ft={key:0},Ht={class:"text-gray-800 text-sm"},qt={key:0,class:"fc-customer-orders-items-sub-title !max-w-full"},Ot={class:"fc-popover-content"},Rt={class:"fc-product-orders-items"},zt={class:"variation-title"},jt={key:0},Kt={class:"fc-action-link-btn"},Yt={class:"item-footer"},Zt={class:"item-footer-content"},Wt=["innerHTML"],Gt={key:1,class:"text-center p-5"},Jt={class:"invoice-id-date"},Xt={class:"block truncate max-w-[100px]"},Qt={class:"text"},es={class:"fc-customer-orders-items"},ts={key:0,class:"fc-customer-orders-items-sub-title"},ss={class:"fc-popover-content"},as={class:"fc-product-orders-items"},os={class:"variation-title"},ns={key:0},is={class:"fc-action-link-btn"},rs=["innerHTML"],nt={__name:"OrderTable",props:{orders:{type:Array,required:!0},showTableHeader:{type:Boolean,default:!1},itemsColumnWidth:{type:Number,default:300},showInvoiceButton:{type:Boolean,default:!0}},setup(e){const a=t=>{const r=t.order_items.find(c=>c.payment_type==="subscription"),_=t.order_items.some(c=>c.payment_type==="adjustment");return t.order_items.filter(c=>!(c.payment_type==="signup_fee"||(c.payment_type==="adjustment"&&r&&(c.product.detail.featured_media=o(r)),_&&c.payment_type==="subscription")))},o=t=>{var r,_;return t.variants&&t.variants.media?(_=(r=t==null?void 0:t.variants)==null?void 0:r.media)==null?void 0:_.meta_value[0].url:t.variants&&!t.variants.media&&t.product.detail&&t.product.detail.featured_media&&t.product.detail.featured_media!==null&&typeof t.product.detail.featured_media=="object"?t.product.detail.featured_media.url:h},h=fluentcart_customer_profile_vars.placeholder_image;return(t,r)=>{const _=u("router-link"),c=u("el-popover"),y=u("el-table-column"),k=u("el-table");return n(),d("div",Tt,[s("div",Lt,[e.orders.length>0?(n(!0),d(M,{key:0},L(e.orders,p=>(n(),d("div",{class:"order-content-only-mobile-item",key:p.id},[s("div",Vt,[l(_,{class:"link text-sm",to:{name:"view_order",params:{order_id:p.uuid}}},{default:m(()=>[s("span",It,"#"+i(p.invoice_no),1)]),_:2},1032,["to"]),s("span",Bt,i(A(F)(p.created_at)),1)]),s("div",Nt,[s("div",Ut,[a(p).length===1?(n(),d("div",Ft,[l(_,{to:{name:"view_order",params:{order_id:p.uuid}},class:"fc-customer-orders-items-title"},{default:m(()=>{var f,w;return[v(i((f=a(p)[0])==null?void 0:f.post_title)+" ",1),s("span",Ht," – "+i((w=a(p)[0])==null?void 0:w.title),1)]}),_:2},1032,["to"]),p.renewals_count>0?(n(),d("span",qt,i(A(Y)("%s Renewal","%s Renewals",p.renewals_count)),1)):b("",!0)])):(n(),C(_,{key:1,to:{name:"view_order",params:{order_id:p.uuid}}},{default:m(()=>[v(i(A(g)("%s items",a(p).length)),1)]),_:2},1032,["to"])),a(p).length>1?(n(),C(c,{key:2,placement:"top",width:360,trigger:"click"},{reference:m(()=>[s("div",Kt,[l(I,{name:"ChevronDown"})])]),default:m(()=>[s("div",Ot,[s("div",Rt,[(n(!0),d(M,null,L(a(p),f=>(n(),d("p",{key:f.id},[l(_,{to:{name:"view_order",params:{order_id:p.uuid}},class:"title"},{default:m(()=>[v(i(f.post_title),1)]),_:2},1032,["to"]),s("span",zt,[s("b",null,i(f.quantity),1),v(" x "+i(f.title),1)])]))),128)),a(p).length===0?(n(),d("p",jt,i(A(g)("No products found!")),1)):b("",!0)])])]),_:2},1024)):b("",!0)])]),s("div",Yt,[s("div",Zt,[l(V,{type:p.status,size:"small"},{default:m(()=>[v(i(p.status),1)]),_:2},1032,["type"]),s("span",{innerHTML:t.formatNumber(p.total_amount,!0,!1,p.currency)},null,8,Wt)])])]))),128)):(n(),d("div",Gt,i(A(g)("Your purchases will be shown here!")),1))]),l(k,{class:"order-content-only-desktop","empty-text":t.$t("Your purchases will be shown here!"),data:e.orders,"show-header":e.showTableHeader},{default:m(()=>[l(y,{label:"#",width:120},{default:m(p=>[s("div",Jt,[l(_,{class:"link text-sm",to:{name:"view_order",params:{order_id:p.row.uuid}}},{default:m(()=>[s("span",Xt,"#"+i(p.row.invoice_no),1)]),_:2},1032,["to"]),s("span",Qt,i(A(F)(p.row.created_at)),1)])]),_:1}),l(y,{width:e.itemsColumnWidth,label:A(g)("Items")},{default:m(p=>[s("div",es,[a(p.row).length===1?(n(),d(M,{key:0},[l(_,{to:{name:"view_order",params:{order_id:p.row.uuid}},class:"fc-customer-orders-items-title"},{default:m(()=>{var f,w;return[v(i((f=a(p.row)[0])==null?void 0:f.post_title)+" ",1),s("span",null," – "+i((w=a(p.row)[0])==null?void 0:w.title),1)]}),_:2},1032,["to"]),p.row.renewals_count>0?(n(),d("span",ts,i(A(Y)("%s Renewal","%s Renewals",p.row.renewals_count)),1)):b("",!0)],64)):(n(),C(_,{key:1,to:{name:"view_order",params:{order_id:p.row.uuid}}},{default:m(()=>[v(i(A(g)("%s items",a(p.row).length)),1)]),_:2},1032,["to"])),a(p.row).length>1?(n(),C(c,{key:2,placement:"top",width:360,trigger:"click"},{reference:m(()=>[s("div",is,[l(I,{name:"ChevronDown"})])]),default:m(()=>[s("div",ss,[s("div",as,[(n(!0),d(M,null,L(a(p.row),f=>(n(),d("p",{key:f.id},[l(_,{to:{name:"view_order",params:{order_id:p.row.uuid}},class:"title"},{default:m(()=>[v(i(f.post_title),1)]),_:2},1032,["to"]),s("span",os,[s("b",null,i(f.quantity),1),v(" x "+i(f.title),1)])]))),128)),a(p.row).length===0?(n(),d("p",ns,i(A(g)("No products found!")),1)):b("",!0)])])]),_:2},1024)):b("",!0)])]),_:1},8,["width","label"]),l(y,{label:A(g)("Status"),width:"120"},{default:m(p=>[l(V,{type:p.row.status,size:"small"},{default:m(()=>[v(i(p.row.status),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(y,{label:A(g)("Amount"),width:"90"},{default:m(p=>[s("span",{class:"text",innerHTML:t.formatNumber(p.row.total_amount,!0,!1,p.row.currency)},null,8,rs)]),_:1},8,["label"])]),_:1},8,["empty-text","data","show-header"])])}}},ls={name:"OrderTableLoader",props:{rowsRange:{type:Array,default:[1,2]}}},ds={class:"fc-customer-dashboard-table"};function cs(e,a,o,h,t,r){const _=u("el-skeleton-item"),c=u("el-skeleton"),y=u("el-table-column"),k=u("el-table");return n(),d("div",ds,[l(k,{data:o.rowsRange,"show-header":!1},{default:m(()=>[l(y,{label:"#",width:150},{default:m(()=>[l(c,{animated:"",class:"py-3"},{template:m(()=>[l(_,{varient:"p",class:"w-3/5"})]),_:1})]),_:1}),l(y,{width:300,label:e.$t("Items")},{default:m(()=>[l(c,{animated:""},{template:m(()=>[l(_,{varient:"p",class:"w-3/5"})]),_:1})]),_:1},8,["label"]),l(y,{label:e.$t("Status"),width:"120"},{default:m(()=>[l(c,{animated:""},{template:m(()=>[l(_,{varient:"p",class:"w-3/5"})]),_:1})]),_:1},8,["label"]),l(y,{label:e.$t("Amount"),width:"90"},{default:m(()=>[l(c,{animated:""},{template:m(()=>[l(_,{varient:"p",class:"w-3/5"})]),_:1})]),_:1},8,["label"])]),_:1},8,["data"])])}const R=P(ls,[["render",cs]]),us={name:"Dashboard",components:{OrderTable:nt,OrderTableLoader:R},data(){return{dashboardData:{orders:[],subscriptions:[],licenses:[]},loading:!1}},methods:{fetchDashboardData(){this.loading=!0,this.$get("customer-profile").then(e=>{this.dashboardData=e.dashboard_data}).finally(()=>{this.loading=!1})}},mounted(){this.fetchDashboardData()}},_s={class:"fc-customer-dashboard fc-customer-dashboard-layout-width"},ms={class:"fc-customer-dashboard-header"},hs={class:"fc-customer-dashboard-title"},ps={class:"actions"},fs={key:0};function gs(e,a,o,h,t,r){const _=u("router-link"),c=u("OrderTableLoader"),y=u("OrderTable");return n(),d("div",_s,[s("div",null,[s("div",ms,[s("h4",hs,i(e.$t("Your Recent Purchases")),1),s("div",ps,[t.dashboardData.orders.length?(n(),C(_,{key:0,class:"is-link",to:{name:"purchase-history"}},{default:m(()=>[v(i(e.$t("View all")),1)]),_:1})):b("",!0)])]),t.loading?(n(),d("div",fs,[l(c,{"rows-range":[1,2]})])):(n(),C(y,{key:1,orders:t.dashboardData.orders},null,8,["orders"]))])])}const ys=P(us,[["render",gs]]),bs={name:"EmptyState",props:["title","text"],data(){var e,a;return{shop_url:(a=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.shop)==null?void 0:a.shop_url}}},vs={class:"fc-customer-dashboard-empty-state"},ws={class:"fc-customer-dashboard-empty-state-inner"},ks={class:"fc-empty-icon-box"};function Cs(e,a,o,h,t,r){const _=u("el-button");return n(),d("div",vs,[s("div",ws,[s("div",ks,[ht(e.$slots,"icon")]),s("h4",null,i(o.title),1),s("p",null,i(o.text),1),l(_,{tag:"a",href:t.shop_url},{default:m(()=>[v(i(e.$t("Back to Shopping Now")),1)]),_:1},8,["href"])])])}const X=P(bs,[["render",Cs]]),$s={name:"PurchaseHistory",components:{OrderTable:nt,Pagination:G,IconButton:W,DynamicIcon:I,OrderTableLoader:R,EmptyState:X},data(){var e,a;return{search:"",showSearch:!1,orders:[],paginate:{current_page:1,per_page:10,total:0},loading:!0,app_loaded:!1,purchaseHistoryTitle:(a=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.section_titles)==null?void 0:a.purchaseHistory}},methods:{fetchOrders(){this.loading=!0,this.$get("customer-profile/orders",{per_page:this.paginate.per_page,page:this.paginate.current_page,search:this.search}).then(e=>{this.orders=e.orders.data,this.paginate.total=e.orders.total}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1,this.app_loaded=!0})}},mounted(){this.fetchOrders()}},As={class:"fc-customer-purchase-history"},Ms={class:"fc-customer-purchase-history-inner"},Ss={class:"fc-customer-dashboard-header"},Ps={class:"fc-customer-dashboard-title"},Ds={class:"actions"},Es={class:"fc-collapsible-search-wrap"},xs={key:1};function Ts(e,a,o,h,t,r){const _=u("el-input"),c=u("DynamicIcon"),y=u("IconButton"),k=u("OrderTableLoader"),p=u("OrderTable"),f=u("EmptyState"),w=u("pagination"),E=O("loading");return n(),d("div",As,[s("div",Ms,[s("div",null,[s("div",Ss,[s("h4",Ps,i(e.$t(t.purchaseHistoryTitle)),1),s("div",Ds,[s("div",Es,[l(ft,{name:"fade-slide"},{default:m(()=>[t.showSearch?(n(),C(_,{key:0,modelValue:t.search,"onUpdate:modelValue":a[0]||(a[0]=x=>t.search=x),onKeyup:pt(r.fetchOrders,["enter"]),onClear:r.fetchOrders,placeholder:e.$t("Search and hit enter..."),clearable:"",size:"small"},null,8,["modelValue","onKeyup","onClear","placeholder"])):b("",!0)]),_:1}),l(y,{tag:"button",size:"small",onClick:a[1]||(a[1]=x=>t.showSearch=!t.showSearch)},{default:m(()=>[t.showSearch?(n(),C(c,{key:0,name:"Cross"})):(n(),C(c,{key:1,name:"Search"}))]),_:1})])])]),t.loading&&!t.app_loaded?(n(),C(k,{key:0,rowsRange:[1,2,3,4,5]})):t.app_loaded?U((n(),d("div",xs,[t.orders.length>0?(n(),C(p,{key:0,orders:t.orders,showTableHeader:!0},null,8,["orders"])):(n(),C(f,{key:1,title:e.$t("No purchases yet"),text:e.$t("Your purchases will be shown here!")},{icon:m(()=>a[2]||(a[2]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},[s("path",{opacity:"0.4",d:"M35 28.6021C35 30.9063 31.7573 32.2761 25.2718 35.0158C22.6663 36.1163 21.3637 36.6666 20 36.6666C18.6363 36.6666 17.3337 36.1163 14.7282 35.0158C8.24273 32.2761 5 30.9063 5 28.6021V11.6666L20 18.9246L35 11.6666V28.6021Z",fill:"#758195"}),s("path",{d:"M20 36.6666C18.6363 36.6666 17.3337 36.1163 14.7282 35.0158C8.24273 32.2761 5 30.9063 5 28.6021C5 27.957 5 16.7741 5 11.6666M20 36.6666C21.3637 36.6666 22.6663 36.1163 25.2718 35.0158C31.7573 32.2761 35 30.9063 35 28.6021V11.6666M20 36.6666V18.9246",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M13.8765 16.1523L9.00787 13.7965C6.33595 12.5035 5 11.8571 5 10.8334C5 9.80966 6.33595 9.16321 9.00787 7.87029L13.8765 5.51441C16.8813 4.06039 18.3838 3.33337 20 3.33337C21.6162 3.33337 23.1187 4.06037 26.1235 5.51441L30.9922 7.87029C33.664 9.16321 35 9.80966 35 10.8334C35 11.8571 33.664 12.5035 30.9922 13.7965L26.1235 16.1523C23.1187 17.6064 21.6162 18.3334 20 18.3334C18.3838 18.3334 16.8813 17.6064 13.8765 16.1523Z",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M10 20L13.3333 21.6667",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M28.3327 6.66663L11.666 15",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1},8,["title","text"]))])),[[E,t.loading]]):b("",!0)]),t.paginate&&t.paginate.total!==0?(n(),C(w,{key:0,hide_on_single:!0,pagination:t.paginate,onFetch:r.fetchOrders},null,8,["pagination","onFetch"])):b("",!0)])])}const Ls=P($s,[["render",Ts]]),Vs={name:"LicenseKey",methods:{translate:g},props:{license_key:String,show_mode:{type:String,default:"icon_with_text"},tooltip_text:{type:String,default:"Copy License Key"}},components:{CopyToClipboard:at,IconButton:W,DynamicIcon:I},computed:{Clipboard(){return $t}},data(){return{}}},Is={class:"fc-license-key-wrap"},Bs={class:"license-key"},Ns={class:"block"};function Us(e,a,o,h,t,r){const _=u("CopyToClipboard");return n(),d("div",Is,[s("div",Bs,[s("span",Ns,i(o.license_key),1)]),l(_,{text:o.license_key,showMode:o.show_mode,tooltipText:o.tooltip_text,"button-text":r.translate("Copy")},null,8,["text","showMode","tooltipText","button-text"])])}const ee=P(Vs,[["render",Us]]),Fs={class:"fc-customer-dashboard-table"},Hs={class:"license-only-mobile"},qs={class:"item-header"},Os={key:0,class:"fc-expiration-info"},Rs={key:0,class:"text-meta"},zs={key:1,class:"text-meta"},js=["onClick"],Ks={class:"fc-customer-orders-items-title"},Ys={class:"item-body"},Zs={class:"fc-customer-payment-meta-info"},Ws={class:"item-footer"},Gs={class:"fc-customer-orders-items-meta-wrap"},Js={key:1,class:"text-meta"},Xs={key:1,class:"text-center p-5"},Qs=["onClick"],ea={class:"fc-customer-orders-items-title"},ta={class:"fc-customer-orders-items-meta-wrap"},sa={key:0,class:"text-meta"},aa={key:1,class:"fc-btn-group pt-1"},oa={class:"fc-customer-payment-meta-info"},na={key:0,class:"text-meta"},ia={key:1,class:"text-meta"},ae={__name:"LicenseTable",props:{licenses:{type:Array,required:!0},showTableHeader:{type:Boolean,default:!1},itemsColumnWidth:{type:Number,default:300},is_simple:{type:Boolean,default:!1}},setup(e){const a=At();return(o,h)=>{const t=u("el-button"),r=u("el-table-column"),_=u("el-table");return n(),d("div",Fs,[s("div",Hs,[e.licenses.length>0?(n(!0),d(M,{key:0},L(e.licenses,c=>(n(),d("div",{class:"license-only-mobile-item",key:c.id},[s("div",qs,[(c==null?void 0:c.status)!=="disabled"&&!e.is_simple?(n(),d("div",Os,[c.expiration_date?(n(),d("div",Rs,[(c==null?void 0:c.status)==="expired"?(n(),d(M,{key:0},[v(i(A(g)("Expired at: %s",A(F)(c.expiration_date))),1)],64)):(n(),d(M,{key:1},[v(i(A(g)("Expires on: %s",A(F)(c.expiration_date))),1)],64))])):(n(),d("div",zs,i(A(g)("Never Expires")),1))])):b("",!0),s("div",{class:"fc-customer-orders-items fc-customer-license-orders-items cursor-pointer",onClick:y=>A(a).push({name:"manage_license",params:{license_key:c.license_key}})},[s("div",Ks,i(c.title),1)],8,js)]),s("div",Ys,[s("div",Zs,[l(ee,{license_key:c==null?void 0:c.license_key,show_mode:"basic_copy_btn",tooltip_text:A(g)("Copy Key")},null,8,["license_key","tooltip_text"])])]),s("div",Ws,[s("div",Gs,[l(V,{status:c.status,"hide-icon":!0},null,8,["status"]),c.renewal_url?(n(),C(t,{key:0,link:"",tag:"a",href:c.renewal_url,target:"_blank",rel:"noopener noreferrer"},{default:m(()=>[v(i(A(g)("Renew License")),1)]),_:2},1032,["href"])):b("",!0),c.status!=="expired"?(n(),d("div",Js,i(c.subtitle),1)):b("",!0)])])]))),128)):(n(),d("div",Xs,i(A(g)("No Licenses found")),1))]),l(_,{class:"license-only-desktop",data:e.licenses,"show-header":e.showTableHeader},{default:m(()=>[l(r,{label:A(g)("Items"),width:e.itemsColumnWidth},{default:m(c=>[s("div",{class:"fc-customer-orders-items fc-customer-license-orders-items cursor-pointer",onClick:y=>A(a).push({name:"manage_license",params:{license_key:c.row.license_key}})},[s("div",ea,i(c.row.title),1),s("div",ta,[c.row.status!=="expired"?(n(),d("div",sa,i(c.row.subtitle),1)):b("",!0),l(V,{status:c.row.status,"hide-icon":!0},null,8,["status"]),c.row.renewal_url?(n(),d("div",aa,[l(t,{link:"",tag:"a",href:c.row.renewal_url,target:"_blank",rel:"noopener noreferrer"},{default:m(()=>[v(i(A(g)("Renew License")),1)]),_:2},1032,["href"])])):b("",!0)])],8,Qs)]),_:1},8,["label","width"]),l(r,{width:400,label:A(g)("License Info"),align:"right","class-name":"license-info-column"},{default:m(c=>{var y;return[s("div",oa,[c.row.status!=="disabled"&&!e.is_simple?(n(),d(M,{key:0},[c.row.expiration_date?(n(),d("div",na,[c.row.status==="expired"?(n(),d(M,{key:0},[v(i(A(g)("Expired at: %s",A(F)(c.row.expiration_date))),1)],64)):(n(),d(M,{key:1},[v(i(A(g)("Expires on: %s",A(F)(c.row.expiration_date))),1)],64))])):(n(),d("div",ia,i(A(g)("Never Expires")),1))],64)):b("",!0),l(ee,{license_key:(y=c.row)==null?void 0:y.license_key,show_mode:"basic_copy_btn",tooltip_text:A(g)("Copy Key")},null,8,["license_key","tooltip_text"])])]}),_:1},8,["label"])]),_:1},8,["data","show-header"])])}}},ra={name:"Licenses",components:{LicenseTable:ae,Pagination:G,OrderTableLoader:R,EmptyState:X},data(){var e,a;return{licenses:[],loading:!1,skeletonRowCount:10,paginate:{current_page:1,total:0,per_page:10},search:"",appLoaded:!1,licensesTitle:(a=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.section_titles)==null?void 0:a.licenses}},methods:{fetchLicenses(){this.loading=!0,this.paginate.per_page,this.paginate.current_page,this.$get("customer-profile/licenses",{per_page:this.paginate.per_page,page:this.paginate.current_page,search:this.search}).then(e=>{this.licenses=e.licenses.data,this.paginate.total=e.licenses.total}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1,this.appLoaded=!0})}},mounted(){this.fetchLicenses()}},la={class:"fc-customer-dashboard-license"},da={class:"fc-customer-dashboard-license-inner"},ca={class:"fc-customer-dashboard-header"},ua={class:"fc-customer-dashboard-title"};function _a(e,a,o,h,t,r){const _=u("OrderTableLoader"),c=u("LicenseTable"),y=u("EmptyState"),k=u("pagination"),p=O("loading");return n(),d("div",la,[s("div",da,[s("div",null,[s("div",ca,[s("h4",ua,i(t.licensesTitle),1)]),t.loading&&!t.appLoaded?(n(),C(_,{key:0,"rows-range":[1,2,3,4]})):t.appLoaded&&t.paginate.total?U((n(),C(c,{key:1,licenses:t.licenses,showTableHeader:!0},null,8,["licenses"])),[[p,t.loading]]):(n(),C(y,{key:2,title:e.$t("No licenses yet"),text:e.$t("Looks like no licenses yet. Purchase something to view data.")},{icon:m(()=>a[0]||(a[0]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},[s("path",{opacity:"0.4",d:"M20.928 2.08337C23.9908 2.08334 26.4168 2.08332 28.3157 2.33861C30.2697 2.60131 31.8512 3.15484 33.0985 4.40211C34.3458 5.64939 34.8993 7.23097 35.162 9.18501C35.4173 11.0837 35.4172 13.5097 35.4172 16.5726V23.4274C35.4172 26.4902 35.4173 28.9164 35.162 30.815C34.8993 32.769 34.3458 34.3507 33.0985 35.598C31.8512 36.8452 30.2697 37.3987 28.3157 37.6615C26.4168 37.9167 23.9908 37.9167 20.928 37.9167H19.0733C16.0105 37.9167 13.5843 37.9167 11.6856 37.6615C9.7315 37.3987 8.14992 36.8452 6.90264 35.5979C5.65537 34.3507 5.10185 32.769 4.83915 30.815C4.58389 28.9164 4.58394 26.4902 4.58399 23.4274L4.58405 16.5726C4.58405 13.5096 4.58405 11.0836 4.83934 9.18494C5.10207 7.23091 5.6556 5.64934 6.90287 4.40209C8.15014 3.15482 9.7317 2.60131 11.6857 2.33859C13.5844 2.08332 16.0104 2.08334 19.0733 2.08337H20.928Z",fill:"#758195"}),s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.666 11.6667C11.666 10.7462 12.4122 10 13.3327 10H26.666C27.5865 10 28.3327 10.7462 28.3327 11.6667C28.3327 12.5871 27.5865 13.3333 26.666 13.3333H13.3327C12.4122 13.3333 11.666 12.5871 11.666 11.6667ZM11.666 20C11.666 19.0795 12.4122 18.3333 13.3327 18.3333H26.666C27.5865 18.3333 28.3327 19.0795 28.3327 20C28.3327 20.9205 27.5865 21.6667 26.666 21.6667H13.3327C12.4122 21.6667 11.666 20.9205 11.666 20ZM11.666 28.3333C11.666 27.4128 12.4122 26.6667 13.3327 26.6667H19.9993C20.9198 26.6667 21.666 27.4128 21.666 28.3333C21.666 29.2538 20.9198 30 19.9993 30H13.3327C12.4122 30 11.666 29.2538 11.666 28.3333Z",fill:"#758195"})],-1)])),_:1},8,["title","text"]))]),t.paginate&&t.paginate.total!==0?(n(),C(k,{key:0,hide_on_single:!0,pagination:t.paginate,onFetch:r.fetchLicenses},null,8,["pagination","onFetch"])):b("",!0)])])}const ma=P(ra,[["render",_a]]),ha={props:{downloads:{type:Array,default:()=>[]},showTableHeader:{type:Boolean,default:!0}},components:{DynamicIcon:I},methods:{readableFileSize(e){return Ct.readableFileSizeFromBytes(e)}}},pa={class:"fc-customer-dashboard-table"},fa={class:"fc-customer-downloads-file-info"},ga={class:"filename"},ya={key:0,class:"text"},ba=["href"];function va(e,a,o,h,t,r){const _=u("el-table-column"),c=u("DynamicIcon"),y=u("el-table");return n(),d("div",pa,[l(y,{data:o.downloads,"show-header":o.showTableHeader},{default:m(()=>[l(_,{label:e.$t("File Name")},{default:m(k=>{var p,f;return[s("div",fa,[s("div",ga,i(((p=k.row)==null?void 0:p.title)||"N/A"),1),k.row.file_size?(n(),d("div",ya,i(r.readableFileSize((f=k.row)==null?void 0:f.file_size)),1)):b("",!0)])]}),_:1},8,["label"]),l(_,{align:"right"},{default:m(k=>[s("a",{target:"_blank",class:"el-button el-button--info is-plain el-button--x-small",href:k.row.download_url},[l(c,{name:"Download"}),v(" "+i(e.$t("Download")),1)],8,ba)]),_:1})]),_:1},8,["data","show-header"])])}const it=P(ha,[["render",va]]),wa={components:{OrderTableLoader:R,Pagination:G,DownloadsTable:it,EmptyState:X},props:{isLimited:{type:Boolean,default:!1},per_page:{type:Number,default:10}},data(){var e,a;return{downloads:[],loading:!1,appLoaded:!1,paginate:{current_page:1,per_page:this.per_page,total:0},downloadsTitle:(a=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.section_titles)==null?void 0:a.downloads}},methods:{fetchFiles(){this.loading=!0,this.$get("customer-profile/downloads",{per_page:this.paginate.per_page,page:this.paginate.current_page}).then(e=>{var a,o;this.downloads=(a=e.downloads)==null?void 0:a.data,this.paginate.total=(o=e.downloads)==null?void 0:o.total}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1,this.appLoaded=!0})}},mounted(){this.fetchFiles()}},ka={class:"fc-customer-dashboard-download"},Ca={class:"fc-customer-dashboard-header"},$a={class:"fc-customer-dashboard-title"},Aa={key:0,class:"actions"},Ma={key:1,class:"fc-customer-dashboard-downloads-table"};function Sa(e,a,o,h,t,r){var w;const _=u("router-link"),c=u("order-table-loader"),y=u("DownloadsTable"),k=u("EmptyState"),p=u("pagination"),f=O("loading");return n(),d("div",ka,[s("div",Ca,[s("h4",$a,i(t.downloadsTitle),1),o.isLimited?(n(),d("div",Aa,[l(_,{class:"is-link",to:{name:"downloads"}},{default:m(()=>[v(i(e.$t("View all")),1)]),_:1})])):b("",!0)]),t.appLoaded?t.appLoaded?U((n(),d("div",Ma,[((w=t.downloads)==null?void 0:w.length)>0?(n(),C(y,{key:0,downloads:t.downloads},null,8,["downloads"])):(n(),C(k,{key:1,title:e.$t("No downloads yet"),text:e.$t("Your valid downloads will be shown here.")},{icon:m(()=>a[0]||(a[0]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},[s("path",{opacity:"0.4",d:"M18.3328 5.41667C18.3328 4.49618 19.079 3.75 19.9995 3.75C20.92 3.75 21.6661 4.49618 21.6661 5.41667V22.998C22.0163 22.6323 22.378 22.2345 22.734 21.8245C23.4321 21.0203 24.0816 20.2106 24.5585 19.5996C24.796 19.2953 24.9885 19.0418 25.1216 18.8656C25.1881 18.7775 25.2401 18.7083 25.2746 18.6621C25.2916 18.6393 25.3036 18.6213 25.312 18.61C25.316 18.6046 25.3198 18.6013 25.3218 18.5986L25.3235 18.5953C25.8693 17.8541 26.913 17.6963 27.6541 18.2421C28.395 18.788 28.5541 19.8301 28.009 20.5713H28.0073V20.5745C28.0065 20.5756 28.0038 20.576 28.0025 20.5778C27.9996 20.5816 27.9961 20.5873 27.9911 20.5941C27.9808 20.608 27.9663 20.6285 27.9471 20.6543C27.9088 20.7058 27.8523 20.7798 27.7811 20.874C27.639 21.0623 27.4353 21.3301 27.1855 21.6503C26.6868 22.2893 25.9988 23.1465 25.2501 24.0088C24.5085 24.863 23.6738 25.76 22.8853 26.4566C22.4931 26.8031 22.0738 27.1363 21.6515 27.391C21.2748 27.618 20.6833 27.9166 19.9995 27.9166C19.3158 27.9166 18.7241 27.618 18.3475 27.391C17.9253 27.1363 17.506 26.8031 17.1138 26.4566C16.3253 25.76 15.4905 24.863 14.7489 24.0088C14.0002 23.1465 13.3122 22.2893 12.8137 21.6503C12.5637 21.3301 12.3601 21.0623 12.2179 20.874C12.1468 20.7798 12.0903 20.7058 12.0519 20.6543C12.0327 20.6285 12.0183 20.608 12.008 20.5941C12.0029 20.5871 11.9978 20.5816 11.995 20.5778C11.9939 20.5763 11.9924 20.5755 11.9917 20.5745V20.5713C11.4464 19.8301 11.6039 18.7863 12.3449 18.2406C13.086 17.6953 14.1299 17.8545 14.6756 18.5953L14.6773 18.5986C14.6792 18.6013 14.6831 18.6046 14.687 18.61C14.6954 18.6213 14.7074 18.6393 14.7245 18.6621C14.7589 18.7083 14.8109 18.7775 14.8775 18.8656C15.0106 19.0418 15.2031 19.2953 15.4406 19.5996C15.9174 20.2106 16.5669 21.0203 17.2651 21.8245C17.621 22.2345 17.9828 22.6323 18.3328 22.998V5.41667Z",fill:"black"}),s("path",{d:"M3.75 23.75V20.415L3.7614 19.987C3.98537 15.5864 7.6225 12.086 12.0785 12.0834H12.0833C13.0036 12.0834 13.7496 12.8299 13.75 13.75C13.75 14.6705 13.0038 15.4167 12.0833 15.4167H12.0801C9.32045 15.4185 7.08403 17.657 7.08333 20.4167V23.75C7.08333 25.7243 7.08512 27.1007 7.17612 28.1707C7.26538 29.2198 7.43154 29.8213 7.67417 30.2752C8.14029 31.1468 8.85484 31.8615 9.72657 32.3275C10.1803 32.5698 10.7808 32.7363 11.8294 32.8255C12.8993 32.9165 14.2758 32.9167 16.25 32.9167H23.75C25.7242 32.9167 27.1007 32.9148 28.1705 32.824C29.2195 32.7347 29.8197 32.5683 30.2734 32.3258C31.1455 31.8597 31.8597 31.1455 32.3259 30.2735C32.5684 29.8198 32.7347 29.2195 32.8239 28.1707C32.9149 27.1008 32.9167 25.7242 32.9167 23.75V20.4167C32.9167 17.6553 30.678 15.4167 27.9167 15.4167C26.9962 15.4167 26.25 14.6705 26.25 13.75C26.25 12.8296 26.9962 12.0834 27.9167 12.0834C32.519 12.0834 36.25 15.8143 36.25 20.4167V23.75C36.25 25.6665 36.2515 27.2083 36.1459 28.4522C36.0384 29.7167 35.8099 30.8252 35.2654 31.8442C34.4885 33.2973 33.2989 34.4883 31.8457 35.2653C30.8267 35.81 29.7167 36.0383 28.4522 36.1458C27.8305 36.1987 27.1344 36.2242 26.3542 36.237L23.75 36.25H16.25C14.3335 36.25 12.7917 36.2517 11.5479 36.1458C10.2831 36.0383 9.17335 35.8117 8.1543 35.267C6.70118 34.4902 5.51155 33.2988 4.7347 31.8457C4.19002 30.8268 3.96177 29.7183 3.85417 28.4538C3.74833 27.2097 3.75 25.6672 3.75 23.75Z",fill:"black"})],-1)])),_:1},8,["title","text"]))])),[[f,t.loading]]):b("",!0):(n(),C(c,{key:0,"rows-range":[1,2,3,4]})),t.paginate.total>0?(n(),C(p,{key:2,hide_on_single:!0,pagination:t.paginate,onFetch:r.fetchFiles},null,8,["pagination","onFetch"])):b("",!0)])}const Pa=P(wa,[["render",Sa]]),Da={props:["license_key"],components:{Badge:V,DynamicIcon:I,IconButton:W},data(){return{loading:!1,activations:[],activatedSitesModal:!1}},methods:{showActivatedSitesModal(){this.activatedSitesModal=!0,this.fetchActivatedSites()},fetchActivatedSites(){this.loading=!0,this.$get(`customer-profile/licenses/${this.license_key}/activations`).then(e=>{this.activations=e.activations}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},deactivate(e){this.$post(`customer-profile/licenses/${this.license_key}/deactivate_site`,{site_url:e.site_url}).then(a=>{this.$notify.success(a.message),this.activations=this.activations.filter(o=>o.site_url!==e.site_url)}).catch(a=>{this.handleError(a)})}}},Ea={class:"fc-table-style-two"},xa={key:0,style:{"margin-left":"10px"}};function Ta(e,a,o,h,t,r){const _=u("el-button"),c=u("Badge"),y=u("el-table-column"),k=u("DynamicIcon"),p=u("IconButton"),f=u("el-popconfirm"),w=u("el-table"),E=u("el-dialog"),x=O("loading");return n(),d(M,null,[l(_,{text:"",class:"underline-link-button",onClick:r.showActivatedSitesModal},{default:m(()=>[v(i(e.$t("View List")),1)]),_:1},8,["onClick"]),l(E,{modelValue:t.activatedSitesModal,"onUpdate:modelValue":a[0]||(a[0]=D=>t.activatedSitesModal=D),"append-to-body":!0,title:e.$t("License Activations"),"modal-class":"fc-activated-sites-modal"},{default:m(()=>[U((n(),d("div",Ea,[l(w,{data:t.activations,stripe:""},{empty:m(()=>[v(i(e.$t("No activations found for this license")),1)]),default:m(()=>[l(y,{label:e.$t("Site"),"min-width":270},{default:m(D=>[s("span",null,i(D.row.site_url),1),D.row.is_local!="0"?(n(),d("span",xa,[l(c,{status:"warning",size:"small","hide-icon":!0,text:e.$t("local")},null,8,["text"])])):b("",!0)]),_:1},8,["label"]),l(y,{label:e.$t("Status"),width:100},{default:m(D=>[l(c,{status:D.row.status,size:"small","hide-icon":!0},null,8,["status"])]),_:1},8,["label"]),l(y,{width:60},{default:m(D=>[s("span",null,[l(f,{width:235,"confirm-button-text":e.$t("Confirm"),"cancel-button-text":e.$t("No, Thanks"),"icon-color":"red",title:e.$t("Are you sure to disconnect?"),onConfirm:S=>r.deactivate(D.row)},{reference:m(()=>[l(p,{tag:"a",size:"x-small",hover:"danger"},{default:m(()=>[l(k,{name:"TrashIcon"})]),_:1})]),_:2},1032,["confirm-button-text","cancel-button-text","title","onConfirm"])])]),_:1})]),_:1},8,["data"])])),[[x,t.loading]])]),_:1},8,["modelValue","title"])],64)}const La=P(Da,[["render",Ta]]),Va={name:"UpgradePlan",components:{CopyToClipboard:at,DynamicIcon:I},props:{variation_id:{type:[String,Number],required:!0},order_hash:{type:String,required:!0},buttonText:{type:String,default:"Upgrade"},buttonType:{type:String,default:"default"}},data(){return{upgradePlanModal:!1,selectedUpgradePath:"",upgradePaths:[],loading:!1}},computed:{currencySign(){return this.appVars.shop.currency_sign}},methods:{translate:g,showUpgradePlanModal(){this.fetchPaths(),this.upgradePlanModal=!0},fetchPaths(){this.loading=!0,this.$get(`customer-profile/orders/${this.order_hash}/upgrade-paths`,{variation_id:this.variation_id}).then(e=>{this.upgradePaths=e.upgradePaths}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},closeUpgradePlanModal(){this.upgradePlanModal=!1}}},Ia={class:"fc-upgrade-plan"},Ba={key:0,class:"fc-upgrade-variation-table pb-10"},Na={class:"upgrade-title"},Ua={class:"plan-price"},Fa={class:"plan-price"},Ha={class:"upgrade-cost"},qa={class:"upgrade-title"},Oa=["innerHTML"],Ra={class:"upgrade-action"},za={key:1},ja={key:2};function Ka(e,a,o,h,t,r){const _=u("el-button"),c=u("el-table-column"),y=u("el-table"),k=u("el-skeleton"),p=u("el-dialog");return n(),d("div",Ia,[l(_,{type:o.buttonType,size:"small",onClick:r.showUpgradePlanModal},{default:m(()=>[v(i(o.buttonText),1)]),_:1},8,["type","onClick"]),l(p,{modelValue:t.upgradePlanModal,"onUpdate:modelValue":a[0]||(a[0]=f=>t.upgradePlanModal=f),"append-to-body":!0,title:e.$t("Upgrade Options"),class:"fc-upgrade-plan-dialog fluent-cart-customer-profile-app"},{default:m(()=>[t.upgradePaths.length>0?(n(),d("div",Ba,[l(y,{data:t.upgradePaths},{default:m(()=>[l(c,{label:r.translate("Package"),width:290},{default:m(f=>[s("div",Na,i(f.row.title),1)]),_:1},8,["label"]),l(c,{label:r.translate("Price"),width:100},{default:m(f=>[s("div",Ua,[s("div",Fa,i(e.formatNumber(f.row.original_price,f.row.currency)),1)])]),_:1},8,["label"]),l(c,{label:r.translate("Amount to pay"),width:200},{default:m(f=>[s("div",Ha,[s("div",qa,[s("span",{innerHTML:f.row.payment_summary},null,8,Oa)])])]),_:1},8,["label"]),l(c,{label:r.translate("Action"),width:110},{default:m(f=>[s("div",Ra,[l(_,{class:"el-button--x-small",tag:"a",href:f.row.upgrade_url,target:"_blank"},{default:m(()=>[v(i(e.$t("Upgrade")),1)]),_:2},1032,["href"])])]),_:1},8,["label"])]),_:1},8,["data"])])):t.loading?(n(),d("div",za,[l(k,{animated:!0,rows:2})])):(n(),d("div",ja,i(r.translate("No upgrade found for this purchase")),1))]),_:1},8,["modelValue","title"])])}const rt=P(Va,[["render",Ka]]),Ya={name:"LicenseDetails",components:{UpgradePlan:rt,Badge:V,LicenseKey:ee,ActivatedSites:La},data(){return{license:null,loading:!1}},props:{license_key:{type:String,required:!0}},methods:{fetchLicense(){this.loading=!0,this.$get("customer-profile/licenses/"+this.license_key).then(e=>{this.license=e.license}).catch(e=>{this.$notify.error(e)}).finally(()=>{this.loading=!1})}},mounted(){this.fetchLicense()}},Za={class:"fc-customer-dashboard-manage-license-wrap fc-customer-dashboard-layout-width"},Wa={class:"fc-customer-dashboard-single-subscription"},Ga={class:"fc-customer-dashboard-breadcrumb mb-8"},Ja={key:0},Xa={key:0,class:"fc-renew-box mb-4"},Qa={class:"text-center p-4"},eo={class:"p-0 m-0 mb-3"},to=["href"],so={class:"fc-single-order-box"},ao={class:"fc-single-order-header"},oo={class:"title"},no={class:"fc-single-order-body"},io={class:"fc-single-order-box-inner"},ro={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},lo={class:"left-content"},co={class:"fc-product-info-card"},uo={class:"fc-product-info-card-inner"},_o={class:"product-info-content"},mo={class:"title truncate-none"},ho={class:"variation-title"},po={class:"right-content"},fo={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},go={class:"left-content"},yo={class:"title"},bo={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},vo={class:"left-content"},wo={class:"title"},ko={class:"flex items-center gap-2"},Co={key:0,class:"text"},$o={key:1,class:"text"},Ao={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},Mo={class:"left-content"},So={class:"title"},Po={class:"text"},Do={class:"fc-single-order-footer mt-3"},Eo={class:"flex items-center gap-3"},xo={key:1,class:"fc-customer-dashboard-loader"},To={key:2,class:"fc-customer-dashboard-no-data"};function Lo(e,a,o,h,t,r){var D,S,B,$,N,H;const _=u("el-breadcrumb-item"),c=u("el-breadcrumb"),y=u("el-alert"),k=u("Badge"),p=u("LicenseKey"),f=u("ActivatedSites"),w=u("UpgradePlan"),E=u("router-link"),x=u("el-skeleton");return n(),d("div",Za,[s("div",Wa,[s("div",Ga,[l(c,null,{default:m(()=>[l(_,{class:"cursor-pointer",to:{path:"/licenses"}},{default:m(()=>[v(i(e.$t("Licenses")),1)]),_:1}),l(_,null,{default:m(()=>[v(i(o.license_key),1)]),_:1})]),_:1})]),t.license?(n(),d("div",Ja,[t.license.renewal_url&&t.license.status==="expired"?(n(),d("div",Xa,[l(y,{type:"error",closable:!1},{default:m(()=>[s("div",Qa,[s("p",eo,"Your license has been expired at "+i(e.formatDate(t.license.expiration_date))+". Please renew the license for getting updates and support.",1),s("a",{href:t.license.renewal_url,class:"el-button el-button--primary"},i(e.$t("Renew License")),9,to)])]),_:1})])):b("",!0),s("div",so,[s("div",ao,[s("div",oo,i(e.$t("License Details")),1)]),s("div",no,[s("div",io,[s("div",ro,[s("div",lo,[s("div",co,[s("div",uo,[s("div",_o,[s("div",mo,i(t.license.title),1),s("div",ho,i(t.license.subtitle),1)])])])]),s("div",po,[l(k,{status:t.license.status},null,8,["status"])])]),s("div",fo,[s("div",go,[s("div",yo,i(e.$t("License Key")),1),l(p,{license_key:o.license_key},null,8,["license_key"])])]),s("div",bo,[s("div",vo,[s("div",wo,i(e.$t("Activations")),1),s("div",ko,[!((D=t.license)!=null&&D.limit)||Number((S=t.license)==null?void 0:S.limit)===0?(n(),d("span",Co,i(e.$t("%s / Unlimited",(B=t.license)==null?void 0:B.activation_count)),1)):(n(),d("span",$o,i(e.$t("%s / %s",($=t.license)==null?void 0:$.activation_count,(N=t.license)==null?void 0:N.limit)),1)),t.license.license_key?(n(),C(f,{key:2,license_key:(H=t.license)==null?void 0:H.license_key},null,8,["license_key"])):b("",!0)])]),a[0]||(a[0]=s("div",{class:"right-content"},null,-1))]),s("div",Ao,[s("div",Mo,[s("div",So,i(e.$t("Expiration Date")),1),s("div",Po,i(t.license.expiration_date?e.formatDate(t.license.expiration_date,!0):e.$t("Never Expires")),1)])])])]),s("div",Do,[s("div",Eo,[t.license.has_upgrades?(n(),C(w,{key:0,"button-type":"primary","button-text":e.$t("Upgrade Plan"),variation_id:t.license.variation_id,order_hash:t.license.order.uuid},null,8,["button-text","variation_id","order_hash"])):b("",!0),l(E,{class:"underline-link-button",to:{name:"view_order",params:{order_id:t.license.order.uuid}}},{default:m(()=>[v(i(e.$t("View Order")),1)]),_:1},8,["to"])])])])])):t.loading?(n(),d("div",xo,[l(x,{rows:5,animated:""})])):(n(),d("div",To,[s("p",null,i(e.$t("License could not be loaded. Please try again.")),1)]))])])}const Vo=P(Ya,[["render",Lo]]),Io={name:"PaymentInfo",props:{data:Object}},Bo=["innerHTML"];function No(e,a,o,h,t,r){var _,c;return(_=o.data)!=null&&_.payment_info?(n(),d("div",{key:0,class:"fc-customer-payment-info",innerHTML:(c=o.data)==null?void 0:c.payment_info},null,8,Bo)):b("",!0)}const Uo=P(Io,[["render",No]]),Fo={key:0,class:"fc-card-info"},Ho=["src"],qo=["src"],Oo={class:"text"},Ro={key:2,class:"text"},zo={__name:"CardInfo",props:{data:Object,showPaymentInfo:Boolean},setup(e){const a=gt(()=>window.fluentcart_customer_profile_vars.assets_path);return(o,h)=>{var t,r,_,c,y,k,p,f,w,E,x,D,S;return e.data?(n(),d("div",Fo,[((t=e.data)==null?void 0:t.current_payment_method)==="paypal"||((r=e.data)==null?void 0:r.payment_method)==="paypal"?(n(),d("img",{key:0,src:`${a.value}images/payment-methods/paypal-icon.svg`,alt:"PayPal"},null,8,Ho)):(y=(c=(_=e.data)==null?void 0:_.billing_info)==null?void 0:c.details)!=null&&y.last_4||(k=e.data)!=null&&k.card_last_4?(n(),d(M,{key:1},[s("img",{src:`${a.value}images/credit-card/card.svg`,alt:"Credit Card"},null,8,qo),s("div",Oo,"**** "+i(((w=(f=(p=e.data)==null?void 0:p.billing_info)==null?void 0:f.details)==null?void 0:w.last_4)||((E=e.data)==null?void 0:E.card_last_4)),1)],64)):((x=e.data)==null?void 0:x.current_payment_method)=="offline_payment"?(n(),d("div",Ro,i(A(le).headline((D=e.data)==null?void 0:D.current_payment_method)||A(le).headline((S=e.data)==null?void 0:S.payment_method)),1)):b("",!0)])):b("",!0)}}},jo={name:"SubscriptionTable",components:{PaymentInfo:Uo,CardInfo:zo,Badge:V},props:{subscriptions:{type:Array,required:!0},hideHeader:{type:Boolean,default:!1}},methods:{translate:g,subscriptionStatus(e){return e!=null&&e.overridden_status?e==null?void 0:e.overridden_status:e==null?void 0:e.status}}},Ko={class:"fc-customer-dashboard-table"},Yo={class:"subscription-only-mobile"},Zo={class:"item-header"},Wo={key:0,class:"text"},Go={class:"item-body"},Jo=["onClick"],Xo={class:"fc-customer-orders-items-title"},Qo={class:"item-footer"},en={class:"item-footer-content"},tn={key:1,class:"text-center p-5"},sn=["onClick"],an={class:"fc-customer-orders-items-title"},on={class:"fc-customer-orders-items-meta-wrap"},nn={key:0,class:"text-meta"},rn={class:"fc-customer-payment-meta-info"};function ln(e,a,o,h,t,r){const _=u("CardInfo"),c=u("Badge"),y=u("PaymentInfo"),k=u("el-table-column"),p=u("el-table");return n(),d("div",Ko,[s("div",Yo,[o.subscriptions.length>0?(n(!0),d(M,{key:0},L(o.subscriptions,f=>(n(),d("div",{class:"subscription-only-mobile-item",key:f.id},[s("div",Zo,[l(_,{data:f,"show-payment-info":e.showPaymentInfo},null,8,["data","show-payment-info"]),f.status!=="expired"&&f.status!=="canceled"&&f.status!=="completed"?(n(),d("div",Wo,i(e.$t("Auto renews on %s",e.formatDate(f.next_billing_date))),1)):b("",!0)]),s("div",Go,[s("div",{class:"fc-customer-orders-items fc-customer-sub-orders-items cursor-pointer",onClick:w=>e.$router.push({name:"view_subscription",params:{subscription_uuid:f.uuid}})},[s("div",Xo,i(f.item_name),1)],8,Jo)]),s("div",Qo,[s("div",en,[l(c,{status:r.subscriptionStatus(f),"hide-icon":!0,size:"small"},null,8,["status"]),l(y,{data:f},null,8,["data"])])])]))),128)):(n(),d("div",tn,i(r.translate("No subscription plans found!")),1))]),l(p,{class:"subscription-only-desktop",data:o.subscriptions,"show-header":!o.hideHeader},{default:m(()=>[l(k,{"min-width":200,label:e.$t("Item")},{default:m(f=>[s("div",{class:"fc-customer-orders-items fc-customer-sub-orders-items cursor-pointer",onClick:w=>e.$router.push({name:"view_subscription",params:{subscription_uuid:f.row.uuid}})},[s("div",an,i(f.row.item_name),1),s("div",on,[l(c,{status:r.subscriptionStatus(f.row),"hide-icon":!0,size:"small"},null,8,["status"]),f.row.status!=="expired"&&f.row.status!=="canceled"&&f.row.status!=="completed"?(n(),d("div",nn,i(e.$t("Auto renews on %s",e.formatDate(f.row.next_billing_date))),1)):b("",!0)])],8,sn)]),_:1},8,["label"]),l(k,{"min-width":"200",label:e.$t("Plan"),align:"right"},{default:m(f=>[s("div",rn,[l(y,{data:f.row},null,8,["data"]),l(_,{data:f.row},null,8,["data"])])]),_:1},8,["label"])]),_:1},8,["data","show-header"])])}const lt=P(jo,[["render",ln]]),dn={name:"SubscriptionPlans",components:{OrderTableLoader:R,Badge:V,Pagination:G,SubscriptionTable:lt,EmptyState:X},props:{showLimit:{type:Number,default:10},showViewAllLink:{type:Boolean,default:!1}},data(){return{loading:!1,appLoaded:!1,subscriptions:[],canceling_subscription:!1,paginate:{current_page:1,per_page:10,total:0}}},methods:{subscriptionStatus(e){return e!=null&&e.overridden_status?e==null?void 0:e.overridden_status:e==null?void 0:e.status},modifySubscriptionResponse(e){return e.map(a=>{var o,h;return{...a,card_last_4:(h=(o=a==null?void 0:a.billingInfo)==null?void 0:o.card)==null?void 0:h.last_4}})},fetchSubscriptions(){this.loading=!0,this.$get("customer-profile/subscriptions",{per_page:this.paginate.per_page,page:this.paginate.current_page}).then(e=>{this.subscriptions=e.subscriptions.data,this.paginate.total=e.subscriptions.total}).finally(()=>{this.appLoaded=!0,this.loading=!1})},cancelSubscription(e,a,o){ElMessageBox.confirm(g("It will permanently cancel the active subscription from your payment provider. Are you sure to do that?"),g("Warning"),{type:"warning",cancelButtonText:g("No, keep this!"),confirmButtonText:g("Yes cancel this subscription!")}).then(()=>{this.canceling_subscription=!0,this.$put(`orders/${o}/subscriptions/${e}/cancel`,{data:{vendor_charge_id:a}}).then(()=>{this.canceling_subscription=!1,this.fetchSubscriptions()}).catch(h=>{this.canceling_subscription=!1,console.log(h)})})}},mounted(){this.fetchSubscriptions()}},cn={class:"fc-customer-dashboard-subscriptions"},un={class:"fc-customer-dashboard-subscriptions-inner"},_n={class:"fc-customer-dashboard-header"},mn={class:"fc-customer-dashboard-title"},hn={key:1,class:"fc-customer-dashboard-loading"};function pn(e,a,o,h,t,r){const _=u("SubscriptionTable"),c=u("OrderTableLoader"),y=u("EmptyState"),k=u("pagination");return n(),d("div",cn,[s("div",un,[s("div",_n,[s("h4",mn,i(e.$t("Subscription Plans")),1)]),t.subscriptions.length?(n(),C(_,{key:0,subscriptions:t.subscriptions},null,8,["subscriptions"])):t.loading?(n(),d("div",hn,[l(c,{"rows-range":[1,2,3,4,5]})])):(n(),C(y,{key:2,title:e.$t("No subscriptions yet"),text:e.$t("Once you subscribe to a plan, it will appear here.")},{icon:m(()=>a[0]||(a[0]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},[s("path",{d:"M33.5429 11.9789C34.291 11.4426 35.3322 11.6143 35.8685 12.3624C37.4175 14.5232 38.3297 17.1585 38.3297 20.0001C38.3297 27.4066 32.172 33.3335 24.6727 33.3335H14.349V35C14.3491 35.419 14.1921 35.8383 13.8769 36.1623C13.235 36.8221 12.1798 36.8365 11.5201 36.1946L9.84873 34.5685C9.53043 34.259 9.11337 33.8536 8.86883 33.5373C8.65405 33.2595 8.03432 32.3905 8.48888 31.3226C8.93338 30.2785 9.96332 30.1015 10.3062 30.0543C10.7031 29.9996 11.2015 29.9998 11.6536 30.0001H11.7377H24.6727C30.4177 30.0001 34.9963 25.4803 34.9963 20.0001C34.9963 17.8841 34.3197 15.9231 33.1593 14.3045C32.623 13.5564 32.7949 12.5152 33.5429 11.9789Z",fill:"black"}),s("path",{opacity:"0.4",d:"M6.45682 28.0212C5.7087 28.5575 4.66751 28.3857 4.13121 27.6377C2.58217 25.4768 1.66992 22.8415 1.66992 20C1.66992 12.5934 7.82769 6.66658 15.327 6.66658H25.6507V5.00005C25.6507 4.58106 25.8075 4.16166 26.1228 3.83765C26.7647 3.17793 27.8198 3.16348 28.4797 3.8054L30.151 5.43163C30.4692 5.741 30.8863 6.1464 31.1308 6.46268C31.3457 6.74053 31.9653 7.60961 31.5108 8.67741C31.0663 9.72158 30.0363 9.89861 29.6935 9.94578C29.2965 10.0004 28.7982 10.0002 28.3462 9.99995L28.262 9.99991H15.327C9.58204 9.99991 5.00326 14.5198 5.00326 20C5.00326 22.1158 5.67996 24.0768 6.84032 25.6955C7.37662 26.4437 7.20492 27.4848 6.45682 28.0212Z",fill:"black"})],-1)])),_:1},8,["title","text"])),t.paginate.total?(n(),C(k,{key:3,hide_on_single:!0,pagination:t.paginate,onFetch:r.fetchSubscriptions},null,8,["pagination","onFetch"])):b("",!0)])])}const fn=P(dn,[["render",pn]]),gn=["id"],yn={key:0},bn=["type"],vn=["src"],dt={__name:"InputField",props:{id:String,label:String,type:{type:String,default:"text"},imageUrl:{type:String,default:""},modelValue:{type:[String,Number],default:null}},emits:["update:modelValue","change","input"],setup(e,{emit:a}){const o=yt().ctx,h=j(!1);j();const t=e,r=a,_=j(t.modelValue),c=f=>{h.value=f},y=f=>{o.$refs.input.value?h.value=!0:h.value=f},k=()=>{r("update:modelValue",_.value),r("change",_.value)},p=()=>{r("update:modelValue",_.value),r("input",_.value)};return st(()=>t.modelValue,f=>{_.value=f}),re(()=>{h.value=!!_.value}),re(()=>{h.value=!!_.value}),(f,w)=>(n(),d("div",{class:q(["form-input-group",{"is-focused":h.value}]),id:e.id},[e.label?(n(),d("label",yn,i(e.label),1)):b("",!0),U(s("input",{type:e.type,ref:"input","onUpdate:modelValue":w[0]||(w[0]=E=>_.value=E),onFocus:w[1]||(w[1]=E=>c(!0)),onBlur:w[2]||(w[2]=E=>y(!1)),onChange:k,onInput:p},null,40,bn),[[bt,_.value]]),e.imageUrl?(n(),d("img",{key:1,src:e.imageUrl,alt:""},null,8,vn)):b("",!0)],10,gn))}},wn=["id"],kn={disabled:"",value:""},Cn=["value"],$n={__name:"SelectField",props:{id:String,options:{type:Array,required:!0,default:()=>[]},modelValue:{type:[String,Number],default:null},placeholder:{type:String,default:"Please select an option"}},emits:["update:modelValue"],setup(e,{emit:a}){const o=e,h=a,t=j(o.modelValue);st(()=>o.modelValue,_=>{t.value=_});const r=()=>{h("update:modelValue",t.value)};return(_,c)=>(n(),d("div",{class:"form-input-group",id:e.id},[U(s("select",{"onUpdate:modelValue":c[0]||(c[0]=y=>t.value=y),onChange:r},[s("option",kn,i(e.placeholder),1),(n(!0),d(M,null,L(e.options,(y,k)=>(n(),d("option",{key:k,value:y.value},i(y.label),9,Cn))),128))],544),[[vt,t.value]])],8,wn))}},An=()=>new Promise((e,a)=>{if(window.Stripe)e(window.Stripe);else{const o=document.createElement("script");o.src="https://js.stripe.com/v3/",o.async=!0,document.head.appendChild(o),o.onload=()=>{e(window.Stripe)},o.onerror=()=>{a(new Error("Failed to load Stripe script"))}}}),Mn={components:{InputField:dt,SelectField:$n,ArrowDown:Dt,ArrowUp:Et},props:{subscription:{type:Object,required:!0},updateMethod:{type:Boolean,required:!0,default:!0}},data(){var e;return{currentPaymentMethod:"",cardNumber:null,cardExpiry:null,cardCvc:null,selectedAddress:"",updating:!1,switching:!1,reactivating:!1,invalidCard:!1,elementStates:{cardNumber:!1,cardExpiry:!1,cardCvc:!1},elementStyle:{base:{fontSize:"16px",color:"#32325d","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a"}},editing:!0,stripe:null,stripePubKey:(e=window.fluentcart_customer_profile_vars)==null?void 0:e.stripe_pub_key,loading:!1,errorMessage:"",successMessage:""}},computed:{getBillingAddresses(){return this.subscription.billing_addresses||[{}]}},methods:{translate:g,handleElementChange(e){this.elementStates[e.elementType]=e.complete,this.invalidCard=!(this.elementStates.cardNumber&&this.elementStates.cardExpiry&&this.elementStates.cardCvc)},async loadAndMountStripeElements(){this.loading=!0;let e=null;try{e=await An()}catch(o){this.handleError((o==null?void 0:o.message)||g("Error in loading stripe")),this.loading=!1}this.stripe=e(this.stripePubKey);const a=this.stripe.elements();this.cardNumber=a.create("cardNumber",{style:this.elementStyle,showIcon:!0}),this.cardNumber.mount("#card-number"),this.cardExpiry=a.create("cardExpiry",{style:this.elementStyle}),this.cardExpiry.mount("#card-expiry"),this.cardCvc=a.create("cardCvc",{style:this.elementStyle}),this.cardCvc.mount("#card-cvc"),this.loading=!1,this.cardNumber.on("change",this.handleElementChange),this.cardExpiry.on("change",this.handleElementChange),this.cardCvc.on("change",this.handleElementChange)},processNewPaymentMethod(){this.save()},async save(){this.updating=!0;const e=await this.createPaymentMethod();e&&this.currentPaymentMethod=="stripe"?this.updatePaymentMethodInStripe(e,"verify"):e&&this.currentPaymentMethod!="stripe"&&this.switchPaymentMethod(e,"verify")},async switchPaymentMethod(e,a="verify",o=""){var h;this.switching=!0,this.errorMessage="";try{const t=await this.$post("customer-profile/subscriptions/"+((h=this.subscription)==null?void 0:h.uuid)+"/switch-payment-method",{data:{newPaymentMethod:"stripe",currentPaymentMethod:this.currentPaymentMethod,vendorPaymentMethod:e,verification_status:a,customer_id:o},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce});if((t==null?void 0:t.status)==="requires_action"){const{setupIntent:r,error:_}=await this.stripe.confirmCardSetup(t==null?void 0:t.client_secret,{payment_method:e.id});if(_){this.errorMessage=_.message||g("Card verification failed"),this.switching=!1;return}r.status==="succeeded"?await this.switchPaymentMethod(e,"verified",t==null?void 0:t.customer_id):(this.errorMessage=g("Card verification failed"),this.switching=!1)}else(t==null?void 0:t.status)==="failed"?(this.resetData(),this.errorMessage=(t==null?void 0:t.message)||g("Card verification failed"),this.switching=!1,this.handleError(this.errorMessage)):(t==null?void 0:t.status)==="success"?(this.resetData(),this.handleSuccess(g("Payment method updated Successfully!")),this.successMessage=g("Payment method updated Successfully!"),this.closeUpdatePaymentModal(),this.$emit("fetchSubscription")):(this.resetData(),this.errorMessage=(t==null?void 0:t.message)||g("Something went wrong"),this.handleError((error==null?void 0:error.message)||g("Error in switching payment method")))}catch(t){this.resetData(),this.errorMessage=(t==null?void 0:t.message)||g("Something went wrong"),this.handleError((t==null?void 0:t.message)||g("Error in switching payment method")),this.switching=!1}finally{this.switching=!1}},async createPaymentMethod(){const e=this.getBillingAddresses.find(a=>a.id==this.selectedAddress);try{const{paymentMethod:a,error:o}=await this.stripe.createPaymentMethod({type:"card",card:this.cardNumber,billing_details:{name:e.name,email:e.email,phone:e.phone,address:{country:e.country,line1:e.address_1,line2:e.address_2,city:e.city,state:e.state,postal_code:e.postcode}}});return a}catch(a){this.errorMessage=(a==null?void 0:a.message)||g("Error in creating payment method"),this.resetData(),this.handleError(this.errorMessage)}},async updatePaymentMethodInStripe(e,a="verify"){this.updating=!0,this.errorMessage="";try{console.log("update...payment method",this.updateMethod,this.subscription);const o=await this.$post(`customer-profile/subscriptions/${this.subscription.uuid}/update-payment-method`,{data:{newPaymentMethod:e,method:"stripe",vendor_subscription_id:this.subscription.vendor_subscription_id,verification_status:a},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce});if((o==null?void 0:o.status)==="requires_action"){const{setupIntent:h,error:t}=await this.stripe.confirmCardSetup(o==null?void 0:o.client_secret,{payment_method:e.id});if(t){this.errorMessage=t.message||g("Card verification failed"),this.updating=!1;return}h.status==="succeeded"?await this.updatePaymentMethodInStripe(e,"verified"):(this.errorMessage=g("Card verification failed"),this.updating=!1)}else(o==null?void 0:o.status)==="failed"?(this.errorMessage=(o==null?void 0:o.message)||g("Card verification failed"),this.resetData(),this.handleError(this.errorMessage)):(o==null?void 0:o.status)==="success"?(this.handleSuccess(g("Payment method updated Successfully!")),this.resetData(),this.closeUpdatePaymentModal(),this.$emit("fetchSubscription")):(this.errorMessage=(o==null?void 0:o.message)||g("Something went wrong"),this.resetData(),this.handleError((error==null?void 0:error.message)||g("Error in updating payment method")))}catch(o){this.errorMessage=(o==null?void 0:o.message)||g("Something went wrong"),this.handleError((o==null?void 0:o.message)||g("Error in updating payment method")),this.updating=!1}},resetData(){this.cardNumber.clear(),this.cardExpiry.clear(),this.cardCvc.clear(),this.updating=!1,this.switching=!1,this.reactivating=!1,this.editing=!1,this.errorMessage=""},closeUpdatePaymentModal(){this.resetData(),this.$emit("close")}},mounted(){var a,o;this.$nextTick(()=>{this.loadAndMountStripeElements()}),console.log("update...payment method mounted",this.updateMethod),this.invalidCard=!0,this.currentPaymentMethod=(a=this.subscription)==null?void 0:a.current_payment_method;const e=(o=this.getBillingAddresses)==null?void 0:o.find(h=>h.is_primary);e&&(this.selectedAddress=e.id)}},Sn={class:"stripe-card-form"},Pn={class:"form-group"},Dn={class:"form-row col-2"},En={class:"form-group"},xn={class:"form-group"},Tn={class:"fc-update-payment-form-item"},Ln={class:"form-heading"},Vn={class:"form-input-container"},In={key:1},Bn={class:"text-red-500"},Nn={key:0,class:"error-message"},Un={key:1,class:"success-message"},Fn={class:"dialog-footer"};function Hn(e,a,o,h,t,r){const _=u("el-option"),c=u("el-select"),y=u("el-button"),k=O("loading");return n(),d("div",null,[U((n(),d("div",Sn,[s("div",Pn,[s("label",null,i(r.translate("Card Number")),1),a[2]||(a[2]=s("div",{id:"card-number",class:"stripe-element"},null,-1))]),s("div",Dn,[s("div",En,[s("label",null,i(r.translate("MM/YY")),1),a[3]||(a[3]=s("div",{id:"card-expiry",class:"stripe-element"},null,-1))]),s("div",xn,[s("label",null,i(r.translate("CVC")),1),a[4]||(a[4]=s("div",{id:"card-cvc",class:"stripe-element"},null,-1))])])])),[[k,t.loading]]),s("div",Tn,[s("h3",Ln,i(r.translate("Billing Address")),1),s("div",Vn,[r.getBillingAddresses.length?(n(),C(c,{key:0,modelValue:t.selectedAddress,"onUpdate:modelValue":a[0]||(a[0]=p=>t.selectedAddress=p),placeholder:r.translate("Select")},{default:m(()=>[(n(!0),d(M,null,L(r.getBillingAddresses,p=>(n(),C(_,{key:p.id,label:e.getAddress(p.formatted_address),value:p.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])):(n(),d("span",In,[s("span",Bn,i(r.translate("No billing address found,")),1),v(" "+i(r.translate("please add a new address from"))+" ",1),s("span",{class:"cursor-pointer text-system-dark underline font-medium",onClick:a[1]||(a[1]=p=>e.$router.push({name:"profile"}))},i(r.translate("here")),1)]))])]),t.errorMessage?(n(),d("div",Nn,i(t.errorMessage),1)):b("",!0),t.successMessage?(n(),d("div",Un,i(t.successMessage),1)):b("",!0),s("div",Fn,[l(y,{size:"small",onClick:r.closeUpdatePaymentModal},{default:m(()=>[v(i(r.translate("Cancel")),1)]),_:1},8,["onClick"]),l(y,{size:"small",type:"primary",onClick:r.processNewPaymentMethod,loading:t.updating||t.switching,disabled:t.updating||t.switching||t.invalidCard},{default:m(()=>[v(i(o.updateMethod?r.translate("Update"):r.translate("Reactivate")),1)]),_:1},8,["onClick","loading","disabled"])])])}const qn=P(Mn,[["render",Hn],["__scopeId","data-v-2538634b"]]),On=()=>new Promise((e,a)=>{var o;if(window.paypal)e(window.paypal);else{const h=document.createElement("script");h.src=`https://www.paypal.com/sdk/js?client-id=${(o=window.fluentcart_customer_profile_vars)==null?void 0:o.paypal_client_id}&vault=true&intent=subscription`,h.async=!0,h.setAttribute("data-partner-attribution-id","FLUENTCART_SP_PPCP"),document.head.appendChild(h),h.onload=()=>{e(window.paypal)},h.onerror=()=>{a(new Error("Failed to load PayPal script"))}}}),Rn={name:"Paypal",props:{subscription:{type:Object,required:!0},updateMethod:{type:Boolean,required:!0,default:!0}},emits:["close","fetchSubscription"],data(){var e;return{updatePaymentUrl:"",paypalClientId:(e=window.fluentcart_customer_profile_vars)==null?void 0:e.paypal_client_id,selectedAddress:"",loading:!1,planId:null,switching:!1,reactivating:!1,reason:"",errorMessage:"",successMessage:""}},computed:{getBillingAddresses(){return this.subscription.billing_addresses}},methods:{translate:g,closeUpdatePaymentModal(){this.$emit("close")},async loadPaypal(){this.loading=!0;let e=null;try{e=await On()}catch(a){this.handleError((a==null?void 0:a.message)||"Error in loading paypal"),this.loading=!1}this.paypal=e,await this.loadPaypalButtons(),this.loading=!1},async getPlanId(){return this.updateMethod?await this.getPlanIdForUpdate():""},async getPlanIdForUpdate(){try{const e=await this.$post("customer-profile/subscriptions/"+this.subscription.uuid+"/get-or-create-plan",{data:{method:"paypal",reason:this.reason},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce});return(!e||!e.plan||!e.plan.id)&&(this.errorMessage=g("Invalid plan ID response!"),this.handleError(this.errorMessage)),e}catch(e){throw this.errorMessage=(e==null?void 0:e.message)||"Error in getPlanId",this.handleError(this.errorMessage),e}},async confirmNewPaypalSubscriptionSwitch(e,a){this.loading=!0,this.$post("customer-profile/subscriptions/"+this.subscription.uuid+"/confirm-subscription-switch",{data:{newVendorSubscriptionId:e,vendorOrderId:a,method:"paypal"},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce}).then(o=>{(o==null?void 0:o.status)==="success"?(this.handleSuccess(g("PayPal subscription updated successfully")),this.loading=!1,this.$emit("close"),this.$emit("fetchSubscription")):(o!=null&&o.message&&(this.errorMessage=o==null?void 0:o.message),this.loading=!1,this.handleError(this.errorMessage))}).catch(o=>{this.errorMessage=(o==null?void 0:o.message)||g("Error in confirming new paypal subscription"),this.handleError(this.errorMessage),this.loading=!1,this.$emit("close")})},async loadPaypalButtons(){const e=this.$refs.paypalButtonContainer;let a=null,o=null,h=null;e.innerHTML="";let t=this;try{await window.paypal.Buttons({style:{shape:"pill",layout:"vertical",label:"paypal",size:"responsive",disableMaxWidth:!0},createSubscription:async function(_,c){return c.subscription.create({plan_id:a,custom_id:t.subscription.uuid})},onApprove:function(_,c){_.subscriptionID&&(o=_.subscriptionID,h=_.orderID,t.confirmNewPaypalSubscriptionSwitch(o,h))},onClick:async function(_,c){try{const y=await t.getPlanId();if(!y||!y.plan||!y.plan.id)return c.reject();a=y.plan.id}catch{return c.reject()}},onError:_=>{var c,y;(c=this.paymentLoader)==null||c.changeLoaderStatus("error"),(y=this.paymentLoader)==null||y.hideLoader(),alert("PayPal error: "+_.toString())}}).render(e)}catch(r){console.error("PayPal Buttons failed to render:",r)}finally{this.loading=!1}}},mounted(){var a;this.$nextTick(()=>{this.loadPaypal()});const e=(a=this.getBillingAddresses)==null?void 0:a.find(o=>o.is_primary);e&&(this.selectedAddress=e.id),this.updateMethod&&(this.reason="update_payment_method")}},zn={id:"paypal-button-container",ref:"paypalButtonContainer"},jn={key:0,class:"error-message"},Kn={key:1,class:"success-message"},Yn={class:"dialog-footer"};function Zn(e,a,o,h,t,r){const _=u("el-button"),c=O("loading");return n(),d("div",null,[s("div",null,[U(s("div",zn,null,512),[[c,t.loading]])]),t.errorMessage?(n(),d("div",jn,i(t.errorMessage),1)):b("",!0),t.successMessage?(n(),d("div",Kn,i(t.successMessage),1)):b("",!0),s("div",Yn,[l(_,{size:"small",onClick:r.closeUpdatePaymentModal},{default:m(()=>[v(i(r.translate("Cancel")),1)]),_:1},8,["onClick"])])])}const Wn=P(Rn,[["render",Zn],["__scopeId","data-v-39a1a194"]]),Gn={name:"UpdatePaymentInfos",components:{InputField:dt,Stripe:qn,Paypal:Wn},props:{subscription:{type:Object,required:!0},updateMethod:{type:Boolean,required:!0,default:!0},buttonText:{type:String,default:"Update Payment Method"}},data(){return{updatePaymentModal:!1,selectedPaymentMethod:this.subscription.current_payment_method,selectedAddress:"",stripePubKey:window.fluentcart_customer_profile_vars.stripe_pub_key,stripe:null,cardNumber:null,cardExpiry:null,cardCvc:null,loading:!1,error:"",updating:!1,invalidInput:!1}},computed:{getAllPaymentMethods(){var e;return((e=window.fluentcart_customer_profile_vars)==null?void 0:e.payment_methods)||[]},filteredPaymentMethods(){return this.subscription.can_switch_payment_method===!0?(this.getAllPaymentMethods||[]).filter(e=>{var a;return e&&((a=e.supported_features)==null?void 0:a.includes("switch_payment_method"))}):methods.filter(e=>e.slug===this.subscription.current_payment_method)}},methods:{translate:g,showUpdatePaymentModal(){this.updatePaymentModal=!0},closeUpdatePaymentModal(){this.updatePaymentModal=!1},fetchSubscription(){this.$emit("fetch")}},mounted(){}},Jn={class:"fc-update-payment-method"},Xn={class:"fc-update-payment-method-header"},Qn=["src","alt","title"],ei={class:"fc-update-payment-method-body"},ti={class:"fc-update-payment-method-form"},si={key:0,class:"fc-update-payment-method-stripe"},ai={key:1,class:"fc-update-payment-method-paypal"};function oi(e,a,o,h,t,r){const _=u("el-button"),c=u("el-radio"),y=u("el-radio-group"),k=u("Stripe"),p=u("Paypal"),f=u("el-dialog");return n(),d("div",null,[o.updateMethod?(n(),C(_,{key:0,onClick:r.showUpdatePaymentModal,text:"",class:"underline-link-button"},{default:m(()=>[v(i(o.buttonText),1)]),_:1},8,["onClick"])):(n(),C(_,{key:1,onClick:r.showUpdatePaymentModal,text:"",class:"underline-link-button"},{default:m(()=>[v(i(r.translate("Reactivate")),1)]),_:1},8,["onClick"])),l(f,{modelValue:t.updatePaymentModal,"onUpdate:modelValue":a[1]||(a[1]=w=>t.updatePaymentModal=w),title:r.translate("Update Payment")},{default:m(()=>[s("div",Jn,[s("div",Xn,[l(y,{class:"fc-update-payment-method-radio",modelValue:t.selectedPaymentMethod,"onUpdate:modelValue":a[0]||(a[0]=w=>t.selectedPaymentMethod=w)},{default:m(()=>[(n(!0),d(M,null,L(r.filteredPaymentMethods,(w,E)=>(n(),C(c,{value:w.slug,key:w.slug,border:""},{default:m(()=>[s("img",{src:w.logo,alt:w.title,class:q(w.slug),title:w.title},null,10,Qn),v(" "+i(w.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),s("div",ei,[s("div",ti,[t.selectedPaymentMethod=="stripe"?(n(),d("div",si,[l(k,{subscription:o.subscription,onClose:r.closeUpdatePaymentModal,onFetchSubscription:r.fetchSubscription,updateMethod:o.updateMethod},null,8,["subscription","onClose","onFetchSubscription","updateMethod"])])):b("",!0),t.selectedPaymentMethod=="paypal"?(n(),d("div",ai,[l(p,{subscription:o.subscription,onClose:r.closeUpdatePaymentModal,onFetchSubscription:r.fetchSubscription,updateMethod:o.updateMethod},null,8,["subscription","onClose","onFetchSubscription","updateMethod"])])):b("",!0)])])])]),_:1},8,["modelValue","title"])])}const ni=P(Gn,[["render",oi]]),ii={name:"TransactionPaymentMethod",props:{transaction:{type:Object,required:!0}},computed:{assetUrl(){return this.appVars.assets_path}}},ri={class:"fc-transaction-payment-method"},li={key:0,class:"flex gap-2 items-center"},di=["src"],ci={class:"text-gray-700 text-sm"},ui={key:1,class:"flex gap-2 items-center"},_i=["src"],mi={key:0,class:"text"},hi={class:"text"},pi={key:2,class:"text text-capitalize"};function fi(e,a,o,h,t,r){return n(),d("div",ri,[o.transaction.payment_method==="paypal"?(n(),d("div",li,[s("img",{src:`${r.assetUrl}images/payment-methods/paypal-icon.svg`,alt:"PayPal"},null,8,di),s("span",ci,i(o.transaction.vendor_charge_id||""),1)])):parseInt(o.transaction.card_last_4)?(n(),d("div",ui,[s("img",{src:`${r.assetUrl}images/credit-card/card.svg`,alt:"Credit Card"},null,8,_i),o.transaction.card_brand?(n(),d("span",mi,i(o.transaction.card_brand),1)):b("",!0),s("span",hi,"**** "+i(o.transaction.card_last_4),1)])):(n(),d("span",pi,i(o.transaction.payment_method),1))])}const gi=P(ii,[["render",fi]]),yi={name:"TransactionsTable",components:{AddressComponent:te,MaterialInput:J,Badge:V,DynamicIcon:I,TransactionPaymentMethod:gi},props:{transactions:{type:Array,default:()=>[]},showTableHeader:{type:Boolean,default:!0}},data(){return{isEditingBillingAddressModal:!1,validationErrors:{},billingAddressData:{name:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:"",vat_tax_id:""},formFields:[{key:"name",label:g("Name/Business Name"),required:!0}],selectedTransaction:null,updatingAddress:!1,address_id:null}},methods:{translate:g,handleTransactionCommand(e,a){e==="edit_billing_address"&&(this.selectedTransaction=a,this.isEditingBillingAddressModal=!0)},fetchBillingAddress(){this.$get(`customer-profile/orders/${this.selectedTransaction.uuid}/billing-address`).then(e=>{this.billingAddressData=e.data,this.billingAddressData.address_1=e.data.address_1,this.billingAddressData.address_2=e.data.address_2,this.billingAddressData.city=e.data.city,this.billingAddressData.state=e.data.state,this.billingAddressData.postcode=e.data.postcode,this.billingAddressData.country=e.data.country,this.billingAddressData.name=e.data.name,this.billingAddressData.vat_tax_id=e.data.vat_tax_id,this.address_id=e.data.address_id}).catch(e=>{e.message&&this.handleError(e)}).finally(()=>{})},updateBillingAddress(){this.updatingAddress=!0,this.$put(`customer-profile/orders/${this.selectedTransaction.uuid}/billing-address`,{name:this.billingAddressData.name,address_1:this.billingAddressData.address_1,address_2:this.billingAddressData.address_2,city:this.billingAddressData.city,state:this.billingAddressData.state,postcode:this.billingAddressData.postcode,country:this.billingAddressData.country,vat_tax_id:this.billingAddressData.vat_tax_id,transaction_uuid:this.selectedTransaction.uuid,address_id:this.address_id}).then(e=>{this.handleSuccess(e.message),this.isEditingBillingAddressModal=!1,this.$emit("billing-address-updated",e.formatted_address)}).catch(e=>{this.handleError(e),this.validationErrors=e}).finally(()=>{this.updatingAddress=!1})},handleCloseModal(){this.isEditingBillingAddressModal=!1,this.selectedTransaction=null}}},bi={class:"text truncate"},vi={class:"text truncate"},wi=["innerHTML"],ki={class:"flex items-center gap-2 justify-between"},Ci=["href"],$i={class:"more-btn w-4 h-4 flex items-center justify-center cursor-pointer"},Ai={class:"fc-customer-dashboard-add-address-form-wrap"},Mi={class:"fc-compact-form"},Si={class:"dialog-footer"};function Pi(e,a,o,h,t,r){const _=u("el-table-column"),c=u("Badge"),y=u("TransactionPaymentMethod"),k=u("DynamicIcon"),p=u("el-dropdown-item"),f=u("el-dropdown-menu"),w=u("el-dropdown"),E=u("el-table"),x=u("MaterialInput"),D=u("AddressComponent"),S=u("el-button"),B=u("el-dialog");return n(),d("div",null,[l(E,{data:o.transactions},{default:m(()=>[l(_,{label:"#",width:150},{default:m($=>[s("span",bi,"#"+i($.row.invoice_no),1)]),_:1}),l(_,{label:e.$t("Date"),width:120},{default:m($=>[s("span",vi,i(e.formatDate($.row.created_at)),1)]),_:1},8,["label"]),l(_,{label:e.$t("Amount"),width:"90"},{default:m($=>[s("span",{class:"text",innerHTML:e.formatNumber($.row.total,!0,!1,$.row.currency)},null,8,wi)]),_:1},8,["label"]),l(_,{label:e.$t("Status"),width:110},{default:m($=>[l(c,{type:$.row.status,size:"small"},{default:m(()=>[v(i($.row.status),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(_,{label:e.$t("Type"),width:100},{default:m($=>[l(c,{type:$.row.order_type,size:"small"},{default:m(()=>[v(i($.row.order_type),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(_,{label:e.$t("Payment Method"),"min-width":160},{default:m($=>[l(y,{transaction:$.row},null,8,["transaction"])]),_:1},8,["label"]),l(_,{width:125},{default:m($=>[s("div",ki,[s("a",{href:$.row.receipt_url,target:"_blank",class:"underline-link-button"},[l(k,{name:"Download",class:"w-4 h-4"}),v(" "+i(e.$t("Receipt")),1)],8,Ci),l(w,{trigger:"click",class:"fc-more-option-wrap","popper-class":"fc-dropdown",onCommand:N=>r.handleTransactionCommand(N,$.row)},{dropdown:m(()=>[l(f,null,{default:m(()=>[l(p,{command:"edit_billing_address"},{default:m(()=>[v(i(r.translate("Edit Billing Address")),1)]),_:1})]),_:1})]),default:m(()=>[s("span",$i,[l(k,{name:"More",class:"w-1"})])]),_:2},1032,["onCommand"])])]),_:1})]),_:1},8,["data"]),l(B,{modelValue:t.isEditingBillingAddressModal,"onUpdate:modelValue":a[2]||(a[2]=$=>t.isEditingBillingAddressModal=$),title:r.translate("Edit Billing Address"),"append-to-body":!0,"modal-class":"fct-transaction-billing-address-modal",onOpen:r.fetchBillingAddress,class:"fluent-cart-customer-profile-app fc-customer-root-container"},{footer:m(()=>[s("div",Si,[l(S,{type:"info",soft:"",onClick:r.handleCloseModal},{default:m(()=>[v(i(r.translate("Cancel")),1)]),_:1},8,["onClick"]),l(S,{type:"primary",loading:t.updatingAddress,onClick:r.updateBillingAddress},{default:m(()=>[v(i(r.translate("Update Address")),1)]),_:1},8,["loading","onClick"])])]),default:m(()=>[s("div",Ai,[s("div",Mi,[(n(!0),d(M,null,L(t.formFields,($,N)=>(n(),C(x,{key:N,required:$.required,label:$.label,modelValue:t.billingAddressData[$.key],"onUpdate:modelValue":H=>t.billingAddressData[$.key]=H,class:q(t.validationErrors[$.key]?"is-error":"")},null,8,["required","label","modelValue","onUpdate:modelValue","class"]))),128)),l(D,{use_additional_address_fields:"",modelValue:t.billingAddressData,"onUpdate:modelValue":a[0]||(a[0]=$=>t.billingAddressData=$),validationErrors:t.validationErrors},null,8,["modelValue","validationErrors"]),l(x,{label:r.translate("Vat Tax ID"),modelValue:t.billingAddressData.vat_tax_id,"onUpdate:modelValue":a[1]||(a[1]=$=>t.billingAddressData.vat_tax_id=$),class:q(t.validationErrors.vat_tax_id?"is-error":"")},null,8,["label","modelValue","class"])])])]),_:1},8,["modelValue","title","onOpen"])])}const ct=P(yi,[["render",Pi]]),Di={name:"SingleSubscription",props:{subscription_uuid:String},components:{TransactionsTable:ct,IconButton:W,UpdatePaymentInfos:ni,UpgradePlan:rt,DynamicIcon:I,Badge:V,LicenseTable:ae},data(){return{subscription:null,loading:!0,cancelling:!1}},computed:{isCancelable(){var e,a;return!(((e=this.subscription)==null?void 0:e.bill_times)>1||((a=this.subscription)==null?void 0:a.status)==="canceled")},ArrowRight(){return ot}},methods:{fetchSubscription(){this.loading=!0,this.$get(`customer-profile/subscriptions/${this.subscription_uuid}`).then(e=>{this.subscription=e.subscription}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},pluralizeTranslate:Y,cancelSubscription(){this.cancelling=!0,this.$post(`customer-profile/subscriptions/${this.subscription.uuid}/cancel-auto-renew`,{method:this.subscription.current_payment_method}).then(e=>{this.$notify.success(e.message)}).catch(e=>{this.handleError(e)}).finally(()=>{this.cancelling=!1,this.fetchSubscription()})},subscriptionStatus(){var e,a,o;return(e=this.subscription)!=null&&e.overridden_status?(a=this.subscription)==null?void 0:a.overridden_status:(o=this.subscription)==null?void 0:o.status}},mounted(){this.fetchSubscription()}},Ei={class:"fc-customer-dashboard-single-subcription-wrap fc-customer-dashboard-layout-width"},xi={class:"fc-customer-dashboard-single-subscription"},Ti={class:"fc-customer-dashboard-breadcrumb mb-8"},Li={key:0,class:"fc-renew-box mb-4"},Vi={class:"text-center p-4"},Ii={class:"p-0 m-0 mb-3"},Bi=["href"],Ni={class:"p-0 m-0 mb-3"},Ui=["href"],Fi={class:"fc-single-order-box mb-11 lg:mb-6"},Hi={class:"fc-single-order-header"},qi={class:"title"},Oi={class:"fc-single-order-body"},Ri={class:"fc-single-order-box-inner"},zi={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},ji={class:"left-content"},Ki={class:"fc-product-info-card"},Yi={class:"fc-product-info-card-inner"},Zi={class:"product-info-content"},Wi={class:"title truncate-none"},Gi={class:"variation-title"},Ji={class:"right-content !w-auto"},Xi={class:"flex justify-end gap-2"},Qi={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},er={class:"left-content"},tr={class:"title"},sr=["innerHTML"],ar={key:0,class:"fc-customer-dashboard-content-table-item border-0 pb-0"},or={class:"left-content"},nr={class:"title"},ir={class:"text"},rr={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},lr={class:"left-content"},dr={class:"title"},cr={class:"text"},ur={key:0},_r={key:1},mr={class:"fc-single-order-footer mt-3"},hr={class:"flex items-center gap-3"},pr={key:1,class:"fc-single-order-box"},fr={class:"fc-single-order-header"},gr={class:"title"},yr={class:"fc-single-order-box"},br={class:"fc-single-order-header"},vr={class:"title"},wr={class:"fc-customer-dashboard-table"};function kr(e,a,o,h,t,r){var oe,ne,ie;const _=u("el-breadcrumb-item"),c=u("el-breadcrumb"),y=u("el-alert"),k=u("Badge"),p=u("DynamicIcon"),f=u("IconButton"),w=u("el-button"),E=u("el-popover"),x=u("el-dropdown-item"),D=u("el-dropdown-menu"),S=u("el-dropdown"),B=u("UpgradePlan"),$=u("UpdatePaymentInfos"),N=u("router-link"),H=u("LicenseTable"),_t=u("TransactionsTable"),mt=u("el-skeleton");return n(),d("div",Ei,[s("div",xi,[s("div",Ti,[l(c,{"separator-icon":r.ArrowRight},{default:m(()=>[l(_,{class:"cursor-pointer",to:{path:"/subscriptions"}},{default:m(()=>[v(i(e.$t("Subscription Plans")),1)]),_:1}),l(_,null,{default:m(()=>[v(i(e.$t("Overview")),1)]),_:1})]),_:1},8,["separator-icon"])]),t.subscription?(n(),d(M,{key:0},[t.subscription.reactivate_url?(n(),d("div",Li,[l(y,{type:"error",closable:!1},{default:m(()=>[s("div",Vi,[t.subscription.status==="expired"?(n(),d(M,{key:0},[s("p",Ii,i(e.$t("Your subscription has expired at %s. Please renew to keep things running smoothly.",e.formatDate(t.subscription.expire_at))),1),s("a",{href:t.subscription.reactivate_url,class:"el-button el-button--primary"},i(e.$t("Renew Subscription Plan")),9,Bi)],64)):(n(),d(M,{key:1},[s("p",Ni,i(e.$t("Your subscription status is now: %s. Please reactivate to keep things running smoothly.",t.subscription.status)),1),s("a",{href:t.subscription.reactivate_url,class:"el-button el-button--primary"},i(e.$t("Reactivate Subscription Plan")),9,Ui)],64))])]),_:1})])):b("",!0),s("div",Fi,[s("div",Hi,[s("div",qi,i(e.$t("Subscription Plan Details")),1)]),s("div",Oi,[s("div",Ri,[s("div",zi,[s("div",ji,[s("div",Ki,[s("div",Yi,[s("div",Zi,[s("div",Wi,[v(i(t.subscription.title)+" ",1),l(k,{status:r.subscriptionStatus(),size:"small"},null,8,["status"])]),s("div",Gi,i(t.subscription.subtitle),1)])])])]),s("div",Ji,[r.isCancelable?(n(),C(S,{key:0,trigger:"click","hide-on-click":!1,"popper-class":"fc-dropdown"},{dropdown:m(()=>[l(D,null,{default:m(()=>[l(x,null,{default:m(()=>[l(E,{"popper-class":"fluent-cart-customer-profile-app",trigger:"click",placement:"bottom",width:260,ref:"popoverRef"},{reference:m(()=>[v(i(e.$t("Cancel Subscription")),1)]),default:m(()=>[s("div",null,i(e.$t("You are about to cancel the subscription. Are you sure?")),1),s("div",Xi,[l(w,{class:"el-button--x-small",text:"",onClick:a[0]||(a[0]=Dd=>e.$refs.popoverRef.hide())},{default:m(()=>[v(i(e.$t("Cancel")),1)]),_:1}),l(w,{class:"el-button--x-small",type:"primary",loading:t.cancelling,onClick:r.cancelSubscription},{default:m(()=>[v(i(e.$t("Yes, Proceed")),1)]),_:1},8,["loading","onClick"])])]),_:1},512)]),_:1})]),_:1})]),default:m(()=>[l(f,{tag:"button",size:"x-small",class:"simple-icon-btn"},{default:m(()=>[l(p,{name:"More",class:"w-[5px]"})]),_:1})]),_:1})):b("",!0)])]),s("div",Qi,[s("div",er,[s("div",tr,i(e.$t("Billing Terms")),1),s("span",{class:"text",innerHTML:t.subscription.payment_info},null,8,sr)])]),t.subscription.status=="active"||t.subscription.status=="trialing"?(n(),d("div",ar,[s("div",or,[s("div",nr,i(e.$t("Next Charge")),1),s("span",ir,i(e.formatDate(t.subscription.next_billing_date)),1)])])):b("",!0),s("div",rr,[s("div",lr,[s("div",dr,i(e.$t("Payment Method")),1),s("span",cr,[(oe=t.subscription.billing_info.details)!=null&&oe.last_4?(n(),d("span",ur," **** "+i((ne=t.subscription.billing_info.details)==null?void 0:ne.last_4),1)):(n(),d("span",_r,i(t.subscription.current_payment_method),1))])])])])]),s("div",mr,[s("div",hr,[(ie=t.subscription)!=null&&ie.can_upgrade?(n(),C(B,{key:0,"button-type":"primary","button-text":e.$t("Upgrade Plan"),variation_id:t.subscription.variation_id,order_hash:t.subscription.order.uuid},null,8,["button-text","variation_id","order_hash"])):b("",!0),t.subscription.can_update_payment_method?(n(),C($,{key:1,subscription:t.subscription,buttonText:e.$t("Update Payment Method"),onFetch:r.fetchSubscription,updateMethod:!0},null,8,["subscription","buttonText","onFetch"])):b("",!0),l(N,{class:"underline-link-button",to:{name:"view_order",params:{order_id:t.subscription.order.uuid}}},{default:m(()=>[v(i(e.$t("View Order")),1)]),_:1},8,["to"])])])]),t.subscription.licenses&&t.subscription.licenses.length?(n(),d("div",pr,[s("div",fr,[s("div",gr,i(r.pluralizeTranslate("Connected License","Connected Licenses",t.subscription.licenses.length)),1)]),l(H,{is_simple:!0,licenses:t.subscription.licenses,showTableHeader:!1},null,8,["licenses"])])):b("",!0),s("div",yr,[s("div",br,[s("div",vr,i(e.$t("Related Transactions")),1)]),s("div",wr,[l(_t,{transactions:t.subscription.transactions,"show-table-header":!0},null,8,["transactions"])])])],64)):t.loading?(n(),C(mt,{key:1,rows:5,animated:!0})):b("",!0)])])}const Cr=P(Di,[["render",kr]]),$r={class:"fc-purchase-history-route-wrap"},Ar=Object.assign({name:"PurchaseHistoryRoute"},{__name:"PurchaseHistoryRoute",setup(e){return(a,o)=>{const h=u("router-view");return n(),d("div",$r,[l(h)])}}}),Mr={name:"AccountDetails.vue",props:["profileDetails"],components:{MaterialInput:J},methods:{translate:g}},Sr={class:"fc-form-container"},Pr={class:"form-left"},Dr={class:"form-heading"},Er={class:"form-desc"},xr={class:"form-right"},Tr={class:"fc-compact-form",id:"account-details"};function Lr(e,a,o,h,t,r){const _=u("MaterialInput");return n(),d("div",Sr,[s("div",Pr,[s("h3",Dr,i(r.translate("Account Details")),1),s("p",Er,i(r.translate("Manage and update your personal information.")),1)]),s("div",xr,[s("div",Tr,[l(_,{label:r.translate("First Name"),modelValue:o.profileDetails.first_name,"onUpdate:modelValue":a[0]||(a[0]=c=>o.profileDetails.first_name=c)},null,8,["label","modelValue"]),l(_,{label:r.translate("Last Name"),modelValue:o.profileDetails.last_name,"onUpdate:modelValue":a[1]||(a[1]=c=>o.profileDetails.last_name=c)},null,8,["label","modelValue"]),l(_,{label:r.translate("Email"),disabled:"",modelValue:o.profileDetails.email,"onUpdate:modelValue":a[2]||(a[2]=c=>o.profileDetails.email=c)},null,8,["label","modelValue"])])])])}const Vr=P(Mr,[["render",Lr]]),Ir={name:"AddressModal",props:["modalAction","newAddressData","showModal","profileDetails","isEditAddress"],emits:["fetch"],components:{DynamicIcon:I,AddressComponent:te,MaterialInput:J},data(){return{validationErrors:{},addAddressLoading:!1,addNewAddressModalVisible:!1,localIsEditAddress:!1,localAddressData:{label:"",name:"",email:"",phone:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:""},formRules:{name:[g("Name is required.")],email:[g("Email is required.")],country:[g("Country is required.")],postcode:[g("Postcode is required.")]},formFields:[{key:"label",label:g("Address label e.g Home, Office"),required:!1},{key:"name",label:g("Name"),required:!0},{key:"email",label:g("Email"),required:!0},{key:"phone",label:g("Phone"),required:!1}]}},watch:{showModal(){this.addNewAddressModalVisible=this.showModal},newAddressData:{handler(e){e&&this.isEditAddress&&(this.localAddressData={...e})},deep:!0,immediate:!0},isEditAddress:{handler(e){e||this.resetFormDataAndValidation()},immediate:!0}},methods:{translate:g,validateForm(){const e={};return Object.keys(this.formRules).forEach(a=>{(!this.localAddressData[a]||this.localAddressData[a].trim()==="")&&(e[a]={required:this.formRules[a][0]})}),this.validationErrors=e,Object.keys(e).length===0},addAddress(){if(this.validateForm()){this.addAddressLoading=!0;let e={type:this.modalAction,customer_id:this.profileDetails.id},a={...this.localAddressData,...e};this.$post("customer-profile/create-address",{type:a.type,label:a.label,name:a.name,phone:a.phone,email:a.email,country:a.country,state:a.state,address_1:a.address_1,address_2:a.address_2,city:a.city,postcode:a.postcode}).then(o=>{T.success(o),this.closeModal(),this.addAddressLoading=!1,this.resetFormDataAndValidation(),this.$emit("fetch")}).catch(o=>{o!=null&&o.message&&T.error(o),this.validationErrors=o}).finally(()=>{this.addAddressLoading=!1})}else T.error(g("Please fill in all the required fields."))},editAddress(){if(this.validateForm()){this.addAddressLoading=!0;let e={...this.localAddressData};this.$post("customer-profile/edit-address",{id:e.id,label:e.label,name:e.name,phone:e.phone,email:e.email,country:e.country,state:e.state,address_1:e.address_1,address_2:e.address_2,city:e.city,postcode:e.postcode,type:e.type}).then(a=>{T.success(a),this.closeModal(),this.addAddressLoading=!1,this.resetFormDataAndValidation(),this.$emit("fetch")}).catch(a=>{T.error(a)}).finally(()=>{this.addAddressLoading=!1})}else T.error(g("Please fill in all the required fields."))},openModal(){this.addNewAddressModalVisible=!0},closeModal(){this.addNewAddressModalVisible=!1},getModalTitle(){return this.localIsEditAddress?g("Edit address"):this.modalAction==="billing"?g("Add new billing address"):this.modalAction==="shipping"?g("Add new shipping address"):g("Add new address")},handleAddNewAddressModal(e,a=null){e==="edit"&&a?(this.localAddressData={...a},this.localIsEditAddress=!0):(this.resetFormDataAndValidation(),this.localIsEditAddress=!1),this.addNewAddressModalVisible=!0},resetFormDataAndValidation(){Object.keys(this.localAddressData).forEach(e=>{this.localAddressData[e]=""}),this.validationErrors={}}}},Br={class:"fc-customer-dashboard-add-address-form-wrap"},Nr={class:"fc-compact-form"},Ur={key:0,class:"form-error-wrap"},Fr={class:"dialog-footer"};function Hr(e,a,o,h,t,r){const _=u("el-button"),c=u("MaterialInput"),y=u("AddressComponent"),k=u("el-dialog");return n(),d(M,null,[l(_,{size:"small",onClick:a[0]||(a[0]=p=>r.handleAddNewAddressModal())},{default:m(()=>[v(i(r.translate("Add New Address")),1)]),_:1}),l(k,{modelValue:t.addNewAddressModalVisible,"onUpdate:modelValue":a[3]||(a[3]=p=>t.addNewAddressModalVisible=p),"append-to-body":!0,title:r.getModalTitle(),onClosed:r.resetFormDataAndValidation,class:"fluent-cart-customer-profile-app fc-customer-root-container"},{footer:m(()=>[s("div",Fr,[l(_,{type:"info",soft:"",onClick:a[2]||(a[2]=p=>t.addNewAddressModalVisible=!1)},{default:m(()=>[v(i(r.translate("Cancel")),1)]),_:1}),t.localIsEditAddress?(n(),C(_,{key:0,type:"primary",loading:t.addAddressLoading,onClick:r.editAddress},{default:m(()=>[v(i(r.translate("Update Address")),1)]),_:1},8,["loading","onClick"])):(n(),C(_,{key:1,type:"primary",loading:t.addAddressLoading,onClick:r.addAddress},{default:m(()=>[v(i(r.translate("Add Address")),1)]),_:1},8,["loading","onClick"]))])]),default:m(()=>[s("div",Br,[s("div",Nr,[(n(!0),d(M,null,L(t.formFields,(p,f)=>(n(),C(c,{key:f,required:p.required,label:p.label,modelValue:t.localAddressData[p.key],"onUpdate:modelValue":w=>t.localAddressData[p.key]=w,class:q(t.validationErrors[p.key]?"is-error":"")},null,8,["required","label","modelValue","onUpdate:modelValue","class"]))),128)),l(y,{use_additional_address_fields:"",modelValue:t.localAddressData,"onUpdate:modelValue":a[1]||(a[1]=p=>t.localAddressData=p),validationErrors:t.validationErrors},null,8,["modelValue","validationErrors"])]),Object.keys(t.validationErrors).length?(n(),d("div",Ur,[(n(!0),d(M,null,L(t.validationErrors,p=>(n(),d("p",null,i(p.required||p.email||p.max),1))),256))])):b("",!0)])]),_:1},8,["modelValue","title","onClosed"])],64)}const qr=P(Ir,[["render",Hr]]),Or={name:"AddressSection",props:{profileDetails:Object,addressType:String,title:String,description:String},emits:["fetch","setAddressPrimary","deleteAddress"],data(){return{isEditAddress:!1,newAddressData:{label:"",name:"",email:"",phone:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:""}}},components:{DynamicIcon:I,Badge:V,AddressModal:qr},computed:{addresses(){return this.profileDetails[`${this.addressType}_address`]||[]},sortedAddresses(){return this.addresses.sort((e,a)=>a.is_primary-e.is_primary)}},methods:{translate:g,handleAddressCommand(e){const{action:a,data:o}=e;a==="edit"?(this.isEditAddress=!0,this.newAddressData={...o},this.$refs.modalRef.handleAddNewAddressModal("edit",o)):a==="default"?this.$emit("setAddressPrimary",o):a==="remove"&&se.confirm(g("Are you sure want to delete this address?"),g("Warning"),{customClass:"fluent-cart-customer-profile-app",confirmButtonText:g("Yes, Delete!"),cancelButtonText:g("Cancel"),cancelButtonClass:"el-button--small",confirmButtonClass:"el-button--small",type:"warning"}).then(()=>{this.$emit("deleteAddress",o)}).catch(()=>{})}}},Rr={class:"fc-form-container"},zr={class:"form-left"},jr={class:"form-heading"},Kr={class:"form-desc"},Yr={class:"form-right"},Zr={key:0,class:"fc-customer-address-list"},Wr={class:"title"},Gr={class:"text"},Jr={class:"fc-address-action"},Xr={class:"more-btn"},Qr={key:1,class:"text-sm text-system-mid"};function el(e,a,o,h,t,r){const _=u("AddressModal"),c=u("Badge"),y=u("DynamicIcon"),k=u("el-dropdown-item"),p=u("el-dropdown-menu"),f=u("el-dropdown");return n(),d("div",Rr,[s("div",zr,[s("h3",jr,i(o.title),1),s("p",Kr,i(o.description),1),l(_,{ref:"modalRef",modalAction:o.addressType,onFetch:a[0]||(a[0]=w=>e.$emit("fetch")),isEditAddress:t.isEditAddress,newAddressData:t.newAddressData,profileDetails:o.profileDetails},null,8,["modalAction","isEditAddress","newAddressData","profileDetails"])]),s("div",Yr,[r.addresses.length?(n(),d("div",Zr,[(n(!0),d(M,null,L(r.sortedAddresses,w=>(n(),d("div",{class:q(`fc-customer-address-block ${w.is_primary==="1"?"default-address":""}`),key:w.id},[s("div",Wr,[v(i(w.label)+" ",1),w.is_primary==="1"?(n(),C(c,{key:0,"hide-icon":!0,highContrast:"",size:"small"},{default:m(()=>[v(i(r.translate("Default")),1)]),_:1})):b("",!0)]),s("p",Gr,i(e.getAddress(w.formatted_address,"")),1),s("div",Jr,[l(f,{trigger:"click",class:"fc-more-option-wrap","popper-class":"fc-dropdown",onCommand:r.handleAddressCommand},{dropdown:m(()=>[l(p,null,{default:m(()=>[l(k,{command:{action:"edit",data:w}},{default:m(()=>[v(i(r.translate("Edit")),1)]),_:2},1032,["command"]),w.is_primary!=="1"?(n(),d(M,{key:0},[l(k,{command:{action:"default",data:w}},{default:m(()=>[v(i(r.translate("Set as default")),1)]),_:2},1032,["command"]),l(k,{command:{action:"remove",data:w},class:"item-destructive"},{default:m(()=>[v(i(r.translate("Delete")),1)]),_:2},1032,["command"])],64)):b("",!0)]),_:2},1024)]),default:m(()=>[s("span",Xr,[l(y,{name:"More"})])]),_:2},1032,["onCommand"])])],2))),128))])):(n(),d("div",Qr,i(r.translate(`No ${o.addressType} address found, please add a new address.`)),1))])])}const ut=P(Or,[["render",el]]),tl={name:"BillingAddress",props:["profileDetails"],emits:["fetch","setAddressPrimary","deleteAddress"],components:{AddressSection:ut}};function sl(e,a,o,h,t,r){const _=u("AddressSection");return n(),C(_,{profileDetails:o.profileDetails,addressType:e.$t("billing"),title:e.$t("Billing Address"),description:e.$t("Provide or update the address where your billing statements and invoices will be sent."),onFetch:a[0]||(a[0]=c=>e.$emit("fetch")),onSetAddressPrimary:a[1]||(a[1]=c=>e.$emit("setAddressPrimary",c)),onDeleteAddress:a[2]||(a[2]=c=>e.$emit("deleteAddress",c))},null,8,["profileDetails","addressType","title","description"])}const al=P(tl,[["render",sl]]),ol={name:"ShippingAddress",props:["profileDetails"],emits:["fetch","setAddressPrimary","deleteAddress"],components:{AddressSection:ut}};function nl(e,a,o,h,t,r){const _=u("AddressSection");return n(),C(_,{profileDetails:o.profileDetails,addressType:e.$t("shipping"),title:e.$t("Shipping Address"),description:e.$t("Provide or update the address where your orders will be delivered."),onFetch:a[0]||(a[0]=c=>e.$emit("fetch")),onSetAddressPrimary:a[1]||(a[1]=c=>e.$emit("setAddressPrimary",c)),onDeleteAddress:a[2]||(a[2]=c=>e.$emit("deleteAddress",c))},null,8,["profileDetails","addressType","title","description"])}const il=P(ol,[["render",nl]]),rl={name:"UserProfile",components:{DynamicIcon:I,Badge:V,MaterialInput:J,AddressComponent:te,AccountDetails:Vr,BillingAddress:al,ShippingAddress:il},data(){return{validationErrors:{},isProfileChanged:!1,originalProfileDetails:{},loading:!1,addAddressLoading:!1,profileDetails:null,billingAddress:null,shippingAddress:null,addNewAddressModalVisible:!1,isEditAddress:!1,modalAction:"billing",newEmail:"",emailConfirmationData:{},emailChangeTokenExpiry:""}},watch:{"profileDetails.first_name":{handler(e,a){this.checkProfileChanges()}},"profileDetails.last_name":{handler(e,a){this.checkProfileChanges()}}},methods:{translate:g,updateCustomerProfile(){this.loading=!0,this.$post("customer-profile/update",{first_name:this.profileDetails.first_name,last_name:this.profileDetails.last_name,email:this.profileDetails.email}).then(e=>{this.isProfileChanged=!1,T.success(e.message),this.fetch()}).catch(e=>{T.error(e)}).finally(()=>{this.loading=!1})},setAddressPrimary(e){let a=e;a.customer_id,this.$post("customer-profile/make-primary-address",{addressId:a.id,type:a.type}).then(o=>{T.success(o),this.fetch()}).catch(o=>{T.success(o)})},deleteAddress(e){let a=e;a.customer_id,this.$post("customer-profile/delete-address",{addressId:a.id}).then(o=>{T.success(o),this.fetch()}).catch(o=>{T.error(o)})},fetch(){this.loading=!0,this.$get("customer-profile/profile").then(e=>{var a,o;this.originalProfileDetails=JSON.parse(JSON.stringify(e.data)),this.profileDetails=e==null?void 0:e.data,this.newEmail=(a=e==null?void 0:e.data)==null?void 0:a.new_email,this.emailChangeTokenExpiry=(o=e==null?void 0:e.data)==null?void 0:o.email_change_token_expiry,this.isProfileChanged=!1}).finally(()=>{this.loading=!1})},editAddress(){if(this.validateForm()){this.addAddressLoading=!0;let e={...this.newAddressData};this.$post("customer-profile/edit-address",{id:e.id,label:e.label,name:e.name,phone:e.phone,email:e.email,country:e.country,state:e.state,address_1:e.address_1,address_2:e.address_2,city:e.city,postcode:e.postcode,type:e.type}).then(a=>{T.success(a),this.fetch(),this.addAddressLoading=!1}).catch(a=>{T.error(a)}).finally(()=>{this.addNewAddressModalVisible=!1,this.resetFormDataAndValidation()})}else T.error(g("Please fill in all the required fields."))},checkProfileChanges(){if(this.profileDetails&&this.originalProfileDetails&&Object.keys(this.originalProfileDetails).length>0){const e=this.profileDetails.first_name!==this.originalProfileDetails.first_name,a=this.profileDetails.last_name!==this.originalProfileDetails.last_name;this.isProfileChanged=e||a}}},mounted(){this.fetch()}},ll={key:0,class:"border border-solid border-gray-outline rounded fc-customer-dashboard-layout-width"},dl={class:"fc-form-container"},cl={class:"form-left"},ul={class:"form-right"},_l={class:"fc-form-container"},ml={class:"form-left"},hl={class:"form-right"},pl={class:"fc-form-container"},fl={class:"form-left"},gl={class:"form-right"},yl={key:1,class:"fc-customer-dashboard-user-profile fc-customer-dashboard-layout-width"},bl={class:"fc-form-footer text-right"};function vl(e,a,o,h,t,r){const _=u("el-skeleton-item"),c=u("el-skeleton"),y=u("AccountDetails"),k=u("BillingAddress"),p=u("ShippingAddress"),f=u("el-button");return n(),d(M,null,[t.loading?(n(),d("div",ll,[l(c,{class:"px-5 py-5",loading:t.loading,rows:2,animated:""},{template:m(()=>[s("div",dl,[s("div",cl,[l(_,{variant:"p",class:"w-[200px] mr-5"}),l(_,{variant:"p",class:"w-[240px] mr-5"})]),s("div",ul,[l(_,{variant:"p",class:"w-[200px]"}),l(_,{variant:"p",class:"w-[300px]"})])]),s("div",_l,[s("div",ml,[l(_,{variant:"p",class:"w-[200px] mr-5"}),l(_,{variant:"p",class:"w-[240px] mr-5"})]),s("div",hl,[l(_,{variant:"p",class:"w-[200px]"}),l(_,{variant:"p",class:"w-[300px]"})])]),s("div",pl,[s("div",fl,[l(_,{variant:"p",class:"w-[200px] mr-5"}),l(_,{variant:"p",class:"w-[240px] mr-5"})]),s("div",gl,[l(_,{variant:"p",class:"w-[200px]"}),l(_,{variant:"p",class:"w-[300px]"})])])]),_:1},8,["loading"])])):b("",!0),t.profileDetails&&!t.loading?(n(),d("div",yl,[l(y,{profileDetails:t.profileDetails},null,8,["profileDetails"]),t.profileDetails.not_a_customer?b("",!0):(n(),d(M,{key:0},[l(k,{profileDetails:t.profileDetails,onFetch:r.fetch,onSetAddressPrimary:r.setAddressPrimary,onDeleteAddress:r.deleteAddress},null,8,["profileDetails","onFetch","onSetAddressPrimary","onDeleteAddress"]),l(p,{profileDetails:t.profileDetails,onFetch:r.fetch,onSetAddressPrimary:r.setAddressPrimary,onDeleteAddress:r.deleteAddress},null,8,["profileDetails","onFetch","onSetAddressPrimary","onDeleteAddress"]),s("div",bl,[l(f,{type:"primary",size:"small",onClick:r.updateCustomerProfile,disabled:!t.isProfileChanged},{default:m(()=>[v(i(r.translate("Save Profile")),1)]),_:1},8,["onClick","disabled"])])],64))])):b("",!0)],64)}const wl=P(rl,[["render",vl]]),kl={name:"SingleOrderDetails",props:{order_id:{type:[String,Number],required:!0}},watch:{order_id(){this.fetchOrder()}},components:{OrderTableLoader:R,TransactionsTable:ct,LicenseTable:ae,SubscriptionTable:lt,Badge:V,DownloadsTable:it},data(){return{order:null,loading:!0,placeholderImage:window.fluentcart_customer_profile_vars.placeholder_image}},computed:{ArrowRight(){return ot}},methods:{orderBillingAddressUpdated(e){this.order.billing_address_text=e},getImage(e){return e.variant_image?e.variant_image:e.image?e.image:this.placeholderImage},fetchOrder(){this.$get("customer-profile/orders/"+this.order_id).then(e=>{this.order=e.order}).catch(e=>{var a;if(e!=null&&e.parent_order&&((a=e==null?void 0:e.parent_order)!=null&&a.uuid)){this.$router.push({name:"view_order",params:{order_id:e.parent_order.uuid}});return}this.handleError(e)}).finally(()=>{this.loading=!1})},pluralizeTranslate:Y},mounted(){this.fetchOrder()}},Cl={class:"fc-customer-dashboard-single-order-wrap"},$l={class:"fc-customer-dashboard-breadcrumb mb-4"},Al={class:"fc-single-order-box"},Ml={class:"fc-single-order-body"},Sl={class:"fc-customer-dashboard-order-items"},Pl={class:"fc-order-summary-wrap"},Dl={class:"fc-order-summary-header"},El={class:"fc-order-summary-header-title"},xl={key:0},Tl={class:"fc-order-summary-body"},Ll={class:"fc-product-info-card"},Vl={class:"fc-product-info-card-inner"},Il={class:"media"},Bl=["href"],Nl=["src","alt"],Ul={class:"product-info-content"},Fl={class:"title"},Hl=["href"],ql={key:0,class:"text-gray-600"},Ol={class:"variation-title"},Rl={key:0,class:"product-subscription-info flex flex-col gap-1 mt-1"},zl=["innerHTML"],jl={class:"fc-order-total text-right"},Kl={key:0,class:"text-sm"},Yl={key:0,class:"fc-order-summary-order-calculation"},Zl={key:0,class:"tr"},Wl={key:1,class:"tr"},Gl={key:2,class:"tr"},Jl={key:3,class:"tr"},Xl={key:4,class:"tr"},Ql={key:5,class:"tr"},ed={class:"fc-order-summary-footer"},td={class:"fc-order-summary-footer-inner"},sd={class:"tr"},ad={key:0,class:"fc-single-order-box"},od={class:"fc-single-order-header"},nd={class:"title"},id={key:1,class:"fc-single-order-box"},rd={class:"fc-single-order-header"},ld={class:"title"},dd={key:2,class:"fc-single-order-box"},cd={class:"fc-single-order-header"},ud={class:"title"},_d={key:3,class:"fc-single-order-box"},md={class:"fc-single-order-header"},hd={class:"title"},pd={class:"fc-customer-dashboard-table"},fd={key:4,class:"fc-single-order-box pb-5 lg:pb-0"},gd={class:"fc-customer-dashboard-address mb-5 lg:mb-0"},yd={class:"title"},bd=["innerHTML"],vd={class:"fc-customer-dashboard-address"},wd={class:"title"},kd=["innerHTML"];function Cd(e,a,o,h,t,r){const _=u("el-breadcrumb-item"),c=u("el-breadcrumb"),y=u("Badge"),k=u("SubscriptionTable"),p=u("DownloadsTable"),f=u("LicenseTable"),w=u("TransactionsTable"),E=u("el-col"),x=u("el-row"),D=u("OrderTableLoader");return n(),d("div",Cl,[s("div",$l,[l(c,{"separator-icon":r.ArrowRight},{default:m(()=>[l(_,{to:{name:"purchase-history"}},{default:m(()=>[v(i(e.$t("Purchase History")),1)]),_:1}),l(_,null,{default:m(()=>{var S;return[v("#"+i((S=t.order)==null?void 0:S.invoice_no),1)]}),_:1})]),_:1},8,["separator-icon"])]),t.order?(n(),d(M,{key:0},[s("div",Al,[s("div",Ml,[s("div",Sl,[s("div",Pl,[s("div",Dl,[s("div",El,i(e.$t("Summary")),1),t.order?(n(),d("div",xl,[l(y,{status:t.order.payment_status},null,8,["status"]),t.order.fulfillment_type=="physical"?(n(),d(M,{key:0},[l(y,{class:"ml-2",status:t.order.status},null,8,["status"]),l(y,{class:"ml-2",status:t.order.shipping_status},null,8,["status"])],64)):b("",!0)])):b("",!0)]),s("div",Tl,[(n(!0),d(M,null,L(t.order.order_items,(S,B)=>(n(),d("div",{key:B,class:"fc-order-summary-item"},[s("div",Ll,[s("div",Vl,[s("div",Il,[s("a",{target:"_blank",href:S.url},[s("img",{src:r.getImage(S),alt:S.title},null,8,Nl)],8,Bl)]),s("div",Ul,[s("div",Fl,[s("a",{target:"_blank",href:S.url},[S.quantity>1?(n(),d("span",ql,i(S.quantity)+" x",1)):b("",!0),v(" "+i(S.post_title),1)],8,Hl)]),s("div",Ol,i(S.title),1),S.meta_lines&&S.meta_lines.length>0?(n(),d("div",Rl,[(n(!0),d(M,null,L(S.meta_lines,$=>(n(),d("span",{class:"block leading-none text-xs",innerHTML:$.label+": "+$.value},null,8,zl))),256))])):b("",!0)])])]),s("div",jl,[v(i(e.formatNumber(S.subtotal))+" ",1),S.extra_amount?(n(),d("span",Kl,[a[0]||(a[0]=s("br",null,null,-1)),v(" + "+i(e.formatNumber(S.extra_amount)),1)])):b("",!0)])]))),128)),t.order.manual_discount_total+t.order.coupon_discount_total>0||t.order.shipping_total>0||t.order.manual_discount_total+t.order.coupon_discount_total>0||t.order.tax_total>0?(n(),d("div",Yl,[t.order.manual_discount_total+t.order.coupon_discount_total||t.order.subtotal>0?(n(),d("div",Zl,[v(i(e.$t("Subtotal"))+" ",1),s("span",null,i(e.formatNumber(t.order.subtotal))+" "+i(parseInt(t.order.tax_behavior)==2?e.$t("(Inc. Tax)"):""),1)])):b("",!0),t.order.shipping_total>0?(n(),d("div",Wl,[v(i(e.$t("Shipping"))+" ",1),s("span",null,i(e.formatNumber(t.order.shipping_total)),1)])):b("",!0),t.order.tax_total>0?(n(),d("div",Gl,[v(i(e.$t("Tax"))+" "+i(t.order.tax_behavior==2?e.$t("(Included)"):e.$t("(Excluded)"))+" ",1),s("span",null,i(e.formatNumber(t.order.tax_total)),1)])):b("",!0),t.order.shipping_tax>0?(n(),d("div",Jl,[v(i(e.$t("Shipping Tax"))+" "+i(t.order.tax_behavior==2?e.$t("(Included)"):e.$t("(Excluded)"))+" ",1),s("span",null,i(e.formatNumber(t.order.shipping_tax)),1)])):b("",!0),t.order.coupon_discount_total>0?(n(),d("div",Xl,[v(i(e.$t("Coupon Discount"))+" ",1),s("span",null,"-"+i(e.formatNumber(t.order.coupon_discount_total)),1)])):b("",!0),t.order.manual_discount_total>0?(n(),d("div",Ql,[v(i(e.$t("Upgrade Discount"))+" ",1),s("span",null,"-"+i(e.formatNumber(t.order.manual_discount_total)),1)])):b("",!0)])):b("",!0)]),s("div",ed,[s("div",td,[s("div",sd,[v(i(e.$t("Total"))+" ",1),s("span",null,i(e.formatNumber(t.order.total_amount)),1)])])])])])])]),t.order.subscriptions&&t.order.subscriptions.length?(n(),d("div",ad,[s("div",od,[s("div",nd,i(e.$t("Subscription Plan")),1)]),l(k,{hideHeader:!0,subscriptions:t.order.subscriptions},null,8,["subscriptions"])])):b("",!0),t.order.downloads&&t.order.downloads.length?(n(),d("div",id,[s("div",rd,[s("div",ld,i(r.pluralizeTranslate("Download","Downloads",t.order.downloads.length)),1)]),l(p,{"show-table-header":!1,downloads:t.order.downloads},null,8,["downloads"])])):b("",!0),t.order.licenses&&t.order.licenses.length?(n(),d("div",dd,[s("div",cd,[s("div",ud,i(r.pluralizeTranslate("License","Licenses",t.order.licenses.length)),1)]),l(f,{licenses:t.order.licenses,is_simple:!0,showTableHeader:!1},null,8,["licenses"])])):b("",!0),t.order.transactions&&t.order.transactions.length?(n(),d("div",_d,[s("div",md,[s("div",hd,i(e.$t("Related Transactions")),1)]),s("div",pd,[l(w,{transactions:t.order.transactions,"show-table-header":!0,onBillingAddressUpdated:r.orderBillingAddressUpdated},null,8,["transactions","onBillingAddressUpdated"])])])):b("",!0),t.order.billing_address_text||t.order.shipping_address_text?(n(),d("div",fd,[l(x,{gutter:30},{default:m(()=>[l(E,{md:12,sm:24},{default:m(()=>[s("div",gd,[s("div",yd,i(e.$t("Billing Address")),1),s("div",{class:"text",innerHTML:t.order.billing_address_text},null,8,bd)])]),_:1}),t.order.fulfillment_type=="physical"?(n(),C(E,{key:0,md:12,sm:24},{default:m(()=>[s("div",vd,[s("div",wd,i(e.$t("Shipping Address")),1),s("div",{class:"text",innerHTML:t.order.shipping_address_text},null,8,kd)])]),_:1})):b("",!0)]),_:1})])):b("",!0)],64)):t.loading?(n(),d(M,{key:1},[l(D,{class:"mb-4","rows-range":[1,2,3]}),l(D,{class:"mb-4","rows-range":[1,2]}),l(D,{"rows-range":[1,2,3]})],64)):b("",!0)])}const $d=P(kl,[["render",Cd]]),Ad={class:"fc-customer-app"},Md=Object.assign({name:"CustomerDashboardApp"},{__name:"App",setup(e){return(a,o)=>{const h=u("router-view");return n(),d("div",Ad,[l(h)])}}});function Sd(e){e.component(K.name,K),e.component(he.name,he),e.component(pe.name,pe),e.component(fe.name,fe),e.component(de.name,de),e.component(ge.name,ge),e.component(ce.name,ce),e.component(ye.name,ye),e.component(ue.name,ue),e.component(be.name,be),e.component(ve.name,ve),e.component(we.name,we),e.component(ke.name,ke),e.component(Ce.name,Ce),e.component($e.name,$e),e.component(Ae.name,Ae),e.component(Me.name,Me),e.component(Se.name,Se),e.component(Pe.name,Pe),e.component(De.name,De),e.component(_e.name,_e),e.component(Ee.name,Ee),e.component(xe.name,xe),e.component(Te.name,Te),e.component(Le.name,Le),e.component(Ve.name,Ve),e.component(Ie.name,Ie),e.component(Be.name,Be),e.component(Ne.name,Ne),e.component(Ue.name,Ue),e.component(Fe.name,Fe),e.component(He.name,He),e.component(qe.name,qe),e.component(Oe.name,Oe),e.component(Re.name,Re),e.component(ze.name,ze),e.component(je.name,je),e.component(Ke.name,Ke),e.component(Ye.name,Ye),e.component(Ze.name,Ze),e.component(We.name,We),e.component(Ge.name,Ge),e.component(Je.name,Je),e.component(Xe.name,Xe),e.component(Qe.name,Qe),e.component(et.name,et),e.component(me.name,me),e.component(tt.name,tt),e.config.globalProperties.$notify=K,e.config.globalProperties.$confirm=se.confirm,e.config.globalProperties.$message=Pt}const Pd=[{path:"/",name:"dashboard",component:ys,meta:{active_menu:"dashboard",title:"dashboard"}},{path:"/purchase-history",name:"purchase-history",component:Ls,meta:{active_menu:"purchase-history",title:"Purchase History"}},{path:"/order",component:Ar,children:[{name:"view_order",path:":order_id",component:$d,props:!0,meta:{active_menu:"purchase-history",title:"View Order"}}]},{path:"/subscriptions",name:"subscriptions",component:fn,meta:{active_menu:"subscriptions",title:"Subscriptions"}},{name:"view_subscription",path:"/subscription/:subscription_uuid",component:Cr,props:!0,meta:{active_menu:"subscriptions",title:"View Subscription"}},{path:"/downloads",name:"downloads",component:Pa,meta:{active_menu:"downloads",title:"Downloads"}},{path:"/licenses",name:"licenses",component:ma,meta:{active_menu:"licenses",title:"Licenses"}},{name:"manage_license",path:"/licenses/:license_key/view",component:Vo,props:!0,meta:{active_menu:"licenses",title:"Manage License"}},{name:"profile",path:"/profile",component:wl,meta:{active_menu:"profile",title:"Profile"}}],Z=Mt({routes:Pd,history:St(window.fluentcart_customer_profile_vars.app_slug)});Z.afterEach(e=>{var o;const a=(o=e.meta)==null?void 0:o.active_menu;if(document.querySelectorAll(".fc-customer-navs li").forEach(h=>{h.classList.remove("active_customer_menu")}),a){const h=document.querySelector(".fc-customer-nav-item-"+a);h&&h.classList.add("active_customer_menu")}});const Q=document.querySelectorAll("[data-fluent-cart-customer-profile-app]");if(Q&&Q.length>0){const e=Q[0],a=wt({});Sd(a),a.config.globalProperties.$notify=K,a.config.globalProperties.$confirm=se.confirm,a.config.globalProperties.appVars=window.fluentcart_customer_profile_vars,a.directive("loading",xt),a.mixin({methods:{$get:z.get,$post:z.post,$put:z.put,$del:z.delete,formatNumber(o,h=!0,t=!1){return!o&&t?"":(o?o=(o/100).toFixed(2):o="0.00",h?(o=new Intl.NumberFormat("en-US").format(o),window.fluentcart_customer_profile_vars.shop.currency_position==="before"?window.fluentcart_customer_profile_vars.shop.currency_sign+o:o+window.fluentcart_customer_profile_vars.shop.currency_sign):o)},$t:g,handleError(o){let h="";typeof o=="string"?h=o:o&&o.message&&(h=o.message),h||(h="Something is wrong!"),this.$notify({type:"error",title:"Error",offset:30,message:h,dangerouslyUseHTMLString:!0,duration:1e3})},handleSuccess(o){let h="Success";typeof o=="string"?h=o:o&&o.message?h=o.message:h=convertToText(o),h||(h="Success!"),this.$notify({type:"success",title:"Success",offset:30,message:h,dangerouslyUseHTMLString:!0,duration:1e3})},registerCopyAction(){kt(()=>{document.querySelectorAll(".copyable-content").forEach(t=>{t.addEventListener("click",function(){const r=this.textContent;navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(r).then(()=>{}).catch(_=>{console.error("Failed to copy text: ",_),h(r)}):h(r)})});function h(t){let r=document.createElement("input");r.value=t,document.body.appendChild(r),r.select(),r.setSelectionRange(0,99999);try{document.execCommand("copy")}catch(_){console.error("Fallback: Could not copy text: ",_)}document.body.removeChild(r)}})},getAddress(o,h="billing",t=!1){if(!o)return"";let r=[];return!t&&o.name&&r.push(o.name),o.address_1&&r.push(o.address_1),o.address_2&&r.push(o.address_2),o.city&&r.push(o.city),o.state&&r.push(o.state),o.postcode&&r.push(o.postcode),o.country&&r.push(o.country),o.phone&&r.push(o.phone),r.join(", ")||"No "+h+" address provided"},readableFileSize(o){if(!o&&o!==0)return"";const h=["Bytes","KB","MB","GB","TB"],t=Math.floor(Math.log2(o)/10);return`${+(o/1024**t).toFixed(2)} ${h[t]}`},formatDate:F}}),a.use(Z).component("app",Md).mount(e)}document.addEventListener("DOMContentLoaded",()=>{let e=window.fluentcart_customer_profile_vars.app_url;document.querySelectorAll("a.fct_route").forEach(a=>{a.addEventListener("click",o=>{const h=a.getAttribute("href");if(!h)return;const t=h.replace(e,"");try{if(Z.resolve(t).matched.length>0)return o.preventDefault(),Z.push(t),!0}catch(r){console.error("Navigation error:",r)}})})});
