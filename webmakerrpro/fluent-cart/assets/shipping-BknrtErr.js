import{i as b,a as o,Y as ue,c as m,o as n,X as de,b as $,w as s,d as e,u as l,g as C,t as u,f,z as se,e as I,F as le,h as ne,j as ge}from"./vue.esm-bundler-VLZRLwDo.js";import{T as he,_ as pe,P as fe,a as ve,C as X,c as W,d as G}from"./RouteCell-BYUiwRDq.js";import{t}from"./Translator-B6cROAk_.js";import{A as ze}from"./Arr-MwYQQ3qa.js";import{R as q}from"./Rest-U7WPPDzn.js";import{I as J,B as $e}from"./Badge-DsywDH_m.js";import{_ as Q}from"./DynamicIcon-B1vpMEi_.js";import{n as F}from"./Notify-DKZN7muO.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as oe,o as Ve}from"./Str-DQr93RbR.js";import{b as ie,E as Te}from"./index-BSdFqZUc.js";import{_ as be,u as Ae}from"./NotFound-C0jL-sdJ.js";import{u as Ze,c as Ee,_ as ye}from"./countries-Bkcuz7Dg.js";import"./Model-D7MrDQPf.js";import"./Url-DcFY6RBb.js";import"./dayjs.min-2rai63wT.js";import"./timezone-C2U15obx.js";import"./Utils-rKpXNRVE.js";import"./Asset-CBhXzPc7.js";class Fe extends he{setupInitialData(){super.setupInitialData(),this.data.sorting.sortBy="id",this.data.sorting.sortType="DESC"}getTabs(){return null}getToggleableColumns(){return[{label:t("Regions"),value:"regions"},{label:t("Shipping Methods"),value:"methods_count"}]}getSortableColumns(){return[{label:t("Zone Name"),value:"name"},{label:t("Order"),value:"order"}]}getSearchHint(){return t("Search by zone name")}getFetchUrl(){return"shipping/zones"}parseResponse(v){return v.shipping_zones}getTableName(){return"shipping_zone_table"}getAdvanceFilterOptions(){return ze.get(window,"fluentCartAdminApp.filter_options.shipping_zone_filter_options")}getSearchGuideOptions(){return[]}useFullWidthSearch(){return!0}with(){return["methodsCount"]}}function Me(y){return Fe.init(y)}const De={class:"shipping-zones-table"},Pe={key:0},Re={key:1,class:"text-muted"},Ne={key:0},Ue={key:1,class:"text-muted"},qe={class:"fc-btn-group sm justify-end pr-4"},Be={__name:"ShippingZonesTable",props:{shipping_zones:{type:Array,required:!0},columns:{type:Array,default:()=>[]}},emits:["refresh"],setup(y,{emit:v}){const g=v,c=b(!1),r=d=>{c.value=!0,q.delete(`/shipping/zones/${d}`).then(_=>{F.success(_.message||t("Shipping zone deleted successfully")),g("refresh")}).catch(_=>{console.error("Error deleting shipping zone:",_),F.error(_.message)}).finally(()=>{c.value=!1})};return(d,_)=>{const a=o("el-table-column"),Z=o("el-popconfirm"),x=o("el-table"),z=ue("loading");return n(),m("div",De,[de((n(),$(x,{data:y.shipping_zones,class:"w-full compact-table responsive full-compact"},{default:s(()=>[e(a,{prop:"name",label:l(t)("Zone Name")},{default:s(w=>[e(pe,{to:{name:"view_shipping_zone",params:{zone_id:w.row.id}}},{default:s(()=>[C(u(w.row.name),1)]),_:2},1032,["to"])]),_:1},8,["label"]),e(a,{label:l(t)("Country")},{default:s(w=>[e(pe,{to:{name:"view_shipping_zone",params:{zone_id:w.row.id}}},{default:s(()=>[w.row.formatted_region?(n(),m("div",Pe,[f("span",null,u(w.row.formatted_region),1)])):(n(),m("div",Re,u(l(t)("Applied To All Countries")),1))]),_:2},1032,["to"])]),_:1},8,["label"]),e(a,{label:l(t)("Shipping Methods"),width:"180"},{default:s(w=>[e(pe,{to:{name:"view_shipping_zone",params:{zone_id:w.row.id}}},{default:s(()=>[w.row.methods_count>0?(n(),m("div",Ne,u(l(t)("%s methods",w.row.methods_count)),1)):(n(),m("div",Ue,u(l(t)("No methods")),1))]),_:2},1032,["to"])]),_:1},8,["label"]),e(a,{label:l(t)("Actions"),width:"200",align:"right"},{default:s(w=>[f("div",qe,[e(J,{size:"small",onClick:T=>d.$router.push({name:"view_shipping_zone",params:{zone_id:w.row.id}}),class:"cursor-pointer"},{default:s(()=>[e(Q,{name:"Edit"})]),_:2},1032,["onClick"]),e(Z,{title:l(t)("Are you sure to delete this shipping zone?"),onConfirm:T=>r(w.row.id),width:"220"},{reference:s(()=>[e(J,{size:"small",class:"cursor-pointer"},{default:s(()=>[e(Q,{name:"Delete"})]),_:1})]),_:2},1032,["title","onConfirm"])])]),_:1},8,["label"])]),_:1},8,["data"])),[[z,c.value]])])}}},Ie=ce(Be,[["__scopeId","data-v-9fbbc9aa"]]),Oe={class:"shipping-zones-loader"},je={class:"shipping-zones-table"},Le={class:"table-cell"},He={class:"table-cell"},We={class:"table-cell"},Ge={class:"table-cell"},Ye={__name:"ShippingZonesLoader",props:{shippingZoneTable:{type:Object,required:!0},nextPageCount:{type:Number,default:0}},setup(y){const v=y,g=Array.from({length:v.nextPageCount},(c,r)=>r+1);return(c,r)=>{const d=o("el-skeleton-item"),_=o("el-skeleton"),a=o("el-table-column"),Z=o("el-table");return n(),m("div",Oe,[f("div",je,[e(Z,{data:l(g),class:"w-full compact-table responsive"},{default:s(()=>[e(a,{prop:"name",label:l(t)("Zone Name")},{default:s(()=>[f("div",Le,[e(_,{animated:""},{template:s(()=>[e(d,{varient:"p",class:"w-[120px]"})]),_:1})])]),_:1},8,["label"]),e(a,{label:l(t)("Regions")},{default:s(()=>[f("div",He,[e(_,{animated:""},{template:s(()=>[e(d,{varient:"p",class:"w-[150px]"})]),_:1})])]),_:1},8,["label"]),e(a,{label:l(t)("Shipping Methods"),width:"180"},{default:s(()=>[f("div",We,[e(_,{animated:""},{template:s(()=>[e(d,{varient:"p",class:"w-[200px]"})]),_:1})])]),_:1},8,["label"]),e(a,{label:l(t)("Actions"),width:"200",align:"right"},{default:s(()=>[f("div",Ge,[e(_,{animated:""},{template:s(()=>[e(d,{varient:"p",class:"w-[120px]"})]),_:1})])]),_:1},8,["label"])]),_:1},8,["data"])])])}}},Ke={class:"setting-wrap"},Xe={class:"fc-all-shipping-zones-page"},Je={class:"fc-all-shipping-zones-wrap"},Qe={key:1},et={__name:"AllShippingZones",setup(y){const v=oe(),g=Me();return(c,r)=>{const d=o("el-button");return n(),m("div",Ke,[f("div",Xe,[e(fe,{title:l(t)("Shipping Zones")},{action:s(()=>[e(d,{type:"primary",onClick:r[0]||(r[0]=_=>l(v).push({name:"add_shipping_zone"}))},{default:s(()=>[C(u(l(t)("Add Shipping Zone")),1)]),_:1})]),_:1},8,["title"]),f("div",Je,[e(ve,{table:l(g)},{default:s(()=>[l(g).isLoading()?(n(),$(Ye,{key:0,shippingZoneTable:l(g),"next-page-count":l(g).nextPageCount},null,8,["shippingZoneTable","next-page-count"])):(n(),m("div",Qe,[e(Ie,{shipping_zones:l(g).getTableData(),columns:l(g).data.columns,onRefresh:r[1]||(r[1]=_=>l(g).fetch())},null,8,["shipping_zones","columns"])]))]),_:1},8,["table"])])])])}}},tt={class:"single-shipping-zone-loader"},lt={class:"single-page-header flex items-center justify-between"},st={class:"fc-page-header__actions"},at={__name:"SingleShippingZoneLoader",setup(y){return(v,g)=>{const c=o("el-skeleton-item"),r=o("el-skeleton"),d=o("el-breadcrumb-item"),_=o("el-breadcrumb");return n(),m("div",tt,[f("div",lt,[e(_,{"separator-icon":l(ie)},{default:s(()=>[e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(c,{variant:"p",class:"w-[90px] h-4"})]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(c,{variant:"p",class:"w-[90px] h-4"})]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(c,{variant:"p",class:"w-[60px] h-4"})]),_:1})]),_:1})]),_:1},8,["separator-icon"]),f("div",st,[e(r,{animated:"",class:"h-9 w-[172px]"},{template:s(()=>[e(c,{variant:"p",class:"w-full h-9 rounded"})]),_:1})])]),e(l(G),{class:"mb-4"},{default:s(()=>[e(l(X),{title:l(t)("Zone Details"),border_bottom:"",title_size:"small"},null,8,["title"]),e(l(W),null,{default:s(()=>[e(r,{rows:4,animated:!0})]),_:1})]),_:1}),e(l(G),{class:"mb-4"},{default:s(()=>[e(l(X),{title:l(t)("Shipping Methods"),border_bottom:"",title_size:"small"},null,8,["title"]),e(l(W),null,{default:s(()=>[e(r,{rows:4,animated:!0})]),_:1})]),_:1})])}}},nt={class:"fc-shipping-methods-wrap"},ot={class:"shipping-methods-list"},it={key:0,class:"flex flex-wrap gap-1"},rt={key:1,class:"text-muted"},pt={key:0},ut={key:1},dt={key:0},ct={key:1},_t={key:0},mt={key:1},gt={class:"flex items-center gap-1"},ht={class:"no-methods"},ft={class:"el-form-item__label"},vt={key:0,class:"form-help-text mt-1"},bt={key:0,class:"form-help-text mt-1"},yt={class:"dialog-footer"},wt={__name:"ShippingMethods",props:{zone_id:{type:[String,Number],required:!0},methods:{type:Array,required:!1,default:()=>[]},country:{type:String,default:""}},emits:["fetchShippingMethods"],setup(y,{emit:v}){const g=y,c=v,r=b(!1),d=b(null),_=b(!1),a=b({zone_id:g.zone_id,method_id:0,title:"",type:"flat_rate",settings:{configure_rate:"per_item",class_aggregation:"sum_all"},amount:0,is_enabled:1,states:[],meta:{description:""}}),Z=b(!1),x=b([]),z=se(()=>g.country==="all"),w=b({title:[{required:!0,message:t("Please enter a method title"),trigger:"blur"}],type:[{required:!0,message:t("Please select a method type"),trigger:"blur"}]}),T=b("States"),R=()=>{a.value={zone_id:g.zone_id,method_id:0,title:"",type:"flat_rate",settings:{configure_rate:"per_item",class_aggregation:"sum_all"},amount:0,is_enabled:1,states:[],meta:{description:""}},r.value=!0},S=()=>{_.value=!0,q.post("shipping/methods",a.value).then(h=>{F.success(h.message),r.value=!1,c("fetchShippingMethods")}).catch(h=>{let p="";if(h.status_code=="422")for(const P in h.data){const E=h.data[P],B=Object.values(E)[0];p+=B+` 
`}p||(p=t("Failed to save shipping method")),console.error("Error saving shipping method:",h),F.error(p)}).finally(()=>{_.value=!1})},k=()=>{_.value=!0,q.put("shipping/methods",a.value).then(h=>{F.success(h.message),r.value=!1,c("fetchShippingMethods")}).catch(h=>{console.error("Error updating shipping method:",h),F.error(t("Failed to update shipping method"))}).finally(()=>{})},N=h=>{q.delete("/shipping/methods/"+h).then(p=>{F.success(p.message),c("fetchShippingMethods")}).catch(p=>{console.error("Error deleting shipping method:",p),F.error(t("Failed to delete shipping method"))})},j=b([{label:t("Flat Rate"),value:"flat_rate"},{label:t("Free Shipping"),value:"free_shipping"},{label:t("Local Pickup"),value:"local_pickup"}]),ee=h=>{var p;a.value={zone_id:g.zone_id,method_id:h.id,title:h.title,type:h.type,settings:h.settings||{configure_rate:"per_item",class_aggregation:"sum_all"},amount:h.amount,is_enabled:h.is_enabled?1:0,states:h.states,meta:{description:((p=h.meta)==null?void 0:p.description)||""}},r.value=!0},V=se(()=>{if(a.value.settings.configure_rate==="per_order")return t("Single charge for the entire order.");if(a.value.settings.configure_rate==="per_item")return t("Charge per item in the cart.");if(a.value.settings.configure_rate==="per_price")return t("Percentage of the total amount of the order")}),A=se(()=>{if(a.value.settings.class_aggregation==="sum_all")return t("Sums of all shipping classes.");if(a.value.settings.class_aggregation==="highest_class")return t("Cost of the highest class among all the classes.")}),U=h=>{if(h==="per_order")return t("Per Order");if(h==="per_item")return t("Per Item");if(h==="per_price")return t("Per Price")},D=()=>{!g.country||g.country==="all"||(Z.value=!0,q.get("/shipping/zone/states",{country_code:g.country}).then(h=>{var p,P,E,B,Y,K,M;x.value=(p=h.data)==null?void 0:p.states,(B=(E=(P=h.data)==null?void 0:P.address_locale)==null?void 0:E.state)!=null&&B.label&&(T.value=(M=(K=(Y=h.data)==null?void 0:Y.address_locale)==null?void 0:K.state)==null?void 0:M.label)}).catch(h=>{console.error("Error fetching state zones:",h)}).finally(()=>{Z.value=!1}))};return(h,p)=>{const P=o("el-button"),E=o("el-table-column"),B=o("el-tag"),Y=o("el-popconfirm"),K=o("el-table"),M=o("el-switch"),O=o("el-form-item"),re=o("el-input"),L=o("el-option"),ae=o("el-select"),te=o("el-col"),we=o("el-row"),Ce=o("el-form"),Se=o("el-drawer"),ke=ue("loading");return n(),m("div",nt,[y.zone_id?(n(),$(l(G),{key:0,class:"mb-4 overflow-hidden"},{default:s(()=>[e(l(X),{title:l(t)("Shipping Methods")},{action:s(()=>[e(P,{type:"primary",onClick:R},{default:s(()=>[C(u(l(t)("Add Shipping Method")),1)]),_:1})]),_:1},8,["title"]),e(l(W),null,{default:s(()=>[f("div",ot,[e(K,{data:y.methods,class:"w-full"},{empty:s(()=>[f("div",ht,[f("p",null,u(l(t)("No shipping methods found for this zone. Add a shipping method to define how products are shipped in this zone.")),1)])]),default:s(()=>[e(E,{prop:"title",label:l(t)("Method Title")},null,8,["label"]),e(E,{label:l(t)("States")},{default:s(i=>[i.row.formatted_states&&i.row.formatted_states.length>0?(n(),m("div",it,[(n(!0),m(le,null,ne(i.row.formatted_states.slice(0,3),(H,xe)=>(n(),$(B,{key:xe,type:"info"},{default:s(()=>[C(u(H),1)]),_:2},1024))),128)),i.row.formatted_states.length>3?(n(),$(B,{key:0,type:"info"},{default:s(()=>[C(" +"+u(i.row.formatted_states.length-3),1)]),_:2},1024)):I("",!0)])):(n(),m("div",rt,u(l(t)("Applied To All States")),1))]),_:1},8,["label"]),e(E,{prop:"type",label:l(t)("Method Type")},{default:s(i=>[C(u(j.value.find(H=>H.value===i.row.type).label),1)]),_:1},8,["label"]),e(E,{prop:"amount",label:l(t)("Amount"),width:"100px"},{default:s(i=>[i.row.type==="free_shipping"?(n(),m("span",pt,u(l(t)("Free")),1)):(n(),m("span",ut,u(i.row.amount),1))]),_:1},8,["label"]),e(E,{prop:"is_enabled",label:l(t)("Enabled")},{default:s(i=>[e($e,{type:i.row.is_enabled?"success":"info"},{default:s(()=>[C(u(i.row.is_enabled?l(t)("Enabled"):l(t)("Disabled")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(E,{prop:"configure_rate",label:l(t)("Configure Rate")},{default:s(i=>[i.row.type==="free_shipping"?(n(),m("span",dt," -- ")):(n(),m("span",ct,u(U(i.row.settings.configure_rate)),1))]),_:1},8,["label"]),e(E,{prop:"class_aggregation",label:l(t)("Class Aggregation"),width:"200px"},{default:s(i=>[i.row.type==="free_shipping"?(n(),m("span",_t," -- ")):(n(),m("span",mt,u(i.row.settings.class_aggregation==="highest_class"?l(t)("Highest Class"):l(t)("Sum All")),1))]),_:1},8,["label"]),e(E,{label:l(t)("Actions"),width:"100"},{default:s(i=>[f("div",gt,[e(J,{size:"small",class:"cursor-pointer",hover:"primary",bg:"transparent",onClick:H=>ee(i.row)},{default:s(()=>[e(Q,{name:"Edit"})]),_:2},1032,["onClick"]),e(Y,{title:l(t)("Are you sure to delete this shipping method?"),onConfirm:H=>N(i.row.id)},{reference:s(()=>[e(J,{size:"small",class:"cursor-pointer",hover:"danger",bg:"transparent"},{default:s(()=>[e(Q,{name:"Delete"})]),_:1})]),_:2},1032,["title","onConfirm"])])]),_:1},8,["label"])]),_:1},8,["data"])])]),_:1})]),_:1})):(n(),$(l(G),{key:1},{default:s(()=>[e(l(W),null,{default:s(()=>[C(u(l(t)("No Shipping Zone Id provided")),1)]),_:1})]),_:1})),e(Se,{modelValue:r.value,"onUpdate:modelValue":p[10]||(p[10]=i=>r.value=i),title:l(t)("Add Shipping Method"),width:"500px","append-to-body":"","close-on-click-modal":!0,class:"fc-shipping-method-drawer",onOpen:D},{footer:s(()=>[f("span",yt,[e(P,{onClick:p[9]||(p[9]=i=>r.value=!1)},{default:s(()=>[C(u(l(t)("Cancel")),1)]),_:1}),a.value.method_id?(n(),$(P,{key:0,type:"primary",onClick:k,loading:_.value},{default:s(()=>[C(u(l(t)("Update")),1)]),_:1},8,["loading"])):(n(),$(P,{key:1,type:"primary",onClick:S,loading:_.value},{default:s(()=>[C(u(l(t)("Save")),1)]),_:1},8,["loading"]))])]),default:s(()=>[e(Ce,{model:a.value,rules:w.value,ref_key:"methodFormRef",ref:d,"label-position":"top","require-asterisk-position":"right"},{default:s(()=>[e(O,{prop:"is_enabled"},{label:s(()=>[f("span",ft,[e(M,{modelValue:a.value.is_enabled,"onUpdate:modelValue":p[0]||(p[0]=i=>a.value.is_enabled=i),"active-value":1,"inactive-value":0},null,8,["modelValue"]),C(" "+u(l(t)("Enable Shipping Method")),1)])]),_:1}),e(O,{label:l(t)("Method Title"),prop:"title"},{default:s(()=>[e(re,{modelValue:a.value.title,"onUpdate:modelValue":p[1]||(p[1]=i=>a.value.title=i),placeholder:l(t)("Enter method title")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),!z.value&&x.value.length>0?de((n(),$(O,{key:0,label:T.value},{default:s(()=>[e(ae,{modelValue:a.value.states,"onUpdate:modelValue":p[2]||(p[2]=i=>a.value.states=i),multiple:"",filterable:"",clearable:"",placeholder:l(t)("Select %s",T.value||"States")},{default:s(()=>[(n(!0),m(le,null,ne(x.value,(i,H)=>(n(),$(L,{key:H,label:i.name,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])),[[ke,Z.value]]):I("",!0),e(we,{gutter:12},{default:s(()=>[e(te,{lg:12},{default:s(()=>[e(O,{label:l(t)("Method Type"),prop:"type"},{default:s(()=>[e(ae,{modelValue:a.value.type,"onUpdate:modelValue":p[3]||(p[3]=i=>a.value.type=i),onChange:p[4]||(p[4]=i=>{i==="free_shipping"&&(a.value.amount=0,a.value.settings.configure_rate="",a.value.settings.class_aggregation="")})},{default:s(()=>[(n(!0),m(le,null,ne(j.value,i=>(n(),$(L,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),a.value.type!=="free_shipping"?(n(),m(le,{key:0},[e(te,{lg:12},{default:s(()=>[e(O,{label:l(t)("Amount"),prop:"amount"},{default:s(()=>[e(re,{type:"number",min:"0",modelValue:a.value.amount,"onUpdate:modelValue":p[5]||(p[5]=i=>a.value.amount=i),placeholder:l(t)("Enter amount")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(te,{lg:12},{default:s(()=>[e(O,{label:l(t)("Configure Rate")},{default:s(()=>[e(ae,{modelValue:a.value.settings.configure_rate,"onUpdate:modelValue":p[6]||(p[6]=i=>a.value.settings.configure_rate=i)},{default:s(()=>[e(L,{label:l(t)("Per Order"),value:"per_order"},null,8,["label"]),e(L,{label:l(t)("Per Item"),value:"per_item"},null,8,["label"]),e(L,{label:l(t)("Percentage"),value:"per_price"},null,8,["label"])]),_:1},8,["modelValue"]),a.value.settings.configure_rate?(n(),m("div",vt,u(V.value),1)):I("",!0)]),_:1},8,["label"])]),_:1}),e(te,{lg:12},{default:s(()=>[e(O,{label:l(t)("Class Aggregation")},{default:s(()=>[e(ae,{modelValue:a.value.settings.class_aggregation,"onUpdate:modelValue":p[7]||(p[7]=i=>a.value.settings.class_aggregation=i)},{default:s(()=>[e(L,{label:l(t)("Combined Cost"),value:"sum_all"},null,8,["label"]),e(L,{label:l(t)("Highest Cost"),value:"highest_class"},null,8,["label"])]),_:1},8,["modelValue"]),a.value.settings.class_aggregation?(n(),m("div",bt,u(A.value),1)):I("",!0)]),_:1},8,["label"])]),_:1})],64)):I("",!0),e(te,{lg:24},{default:s(()=>[e(O,{label:l(t)("Description")},{default:s(()=>[e(re,{modelValue:a.value.meta.description,"onUpdate:modelValue":p[8]||(p[8]=i=>a.value.meta.description=i),type:"textarea",rows:2,placeholder:l(t)("Enter description")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}},Ct=ce(wt,[["__scopeId","data-v-395b1c84"]]),St={class:"setting-wrap"},kt={class:"fc-single-shipping-zone-page"},xt={key:0},zt={key:2,class:"fc-single-shipping-zone"},$t={class:"single-page-header flex items-center justify-between"},Vt={class:"fc-page-header__actions"},Tt={key:0,class:"cmd"},At={class:"form-help-text"},Zt={__name:"SingleShippingZone",props:{zone_id:{type:[String,Number],required:!1}},setup(y){const v=y,g=oe(),c=Ze();c.bind(["meta+s"],V=>{V.preventDefault(),j()});const r=b(null),d=b(!1),_=b(!1),a=b({name:"",region:""}),Z=b({name:[{required:!0,message:t("Please enter a zone name"),trigger:"blur"}]}),x=b([]),z=b(null),w=b(!1),T=b({show:!1,message:"",buttonText:"",route:""}),R=V=>{V&&(z.value=a.value.region)},S=se(()=>!!v.zone_id),k=()=>{S.value&&(d.value=!0,q.get(`shipping/zones/${v.zone_id}`).then(V=>{const A=V.shipping_zone;a.value.name=A.name,a.value.region=A.region||"",w.value=a.value.region==="all",x.value=A.methods||[]}).catch(V=>{console.error("Error fetching zone data:",V),T.value={show:!0,message:t("Shipping zone not found"),buttonText:t("Back to Shipping Zones"),route:{name:"all_shipping_zones"}}}).finally(()=>{d.value=!1}))},N=V=>{V?(z.value=a.value.region,a.value.region="all"):a.value.region=z.value||""},j=()=>{r.value.validate(V=>{if(!V)return;_.value=!0;const A=S.value?"put":"post",U=`shipping/zones${S.value?`/${v.zone_id}`:""}`;q[A](U,a.value).then(D=>{F.success(D.message),S.value?k():g.push({name:"view_shipping_zone",params:{zone_id:D.shipping_zone.id}})}).catch(D=>{D.status_code=="422"?F.validationErrors(D):F.error(D.message),console.error("Error saving shipping zone:",D)}).finally(()=>{_.value=!1})})},ee=()=>{S.value&&Te.confirm("If you change the region, all the shipping methods states will be removed. Do you want to continue?","Confirmation",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"}).then(()=>{}).catch(()=>{a.value.region=z.value})};return ge(()=>{k()}),Ve(()=>{c.unbind("meta+s")}),(V,A)=>{const U=o("el-breadcrumb-item"),D=o("el-breadcrumb"),h=o("el-button"),p=o("el-input"),P=o("el-form-item"),E=o("el-checkbox"),B=o("el-option"),Y=o("el-select"),K=o("el-form");return n(),m("div",St,[f("div",kt,[d.value?(n(),m("div",xt,[e(at)])):T.value.show?(n(),$(be,{key:1,message:T.value.message,"button-text":T.value.buttonText,route:T.value.route},null,8,["message","button-text","route"])):(n(),m("div",zt,[f("div",$t,[e(D,{class:"mb-0","separator-icon":l(ie)},{default:s(()=>[e(U,{to:{name:"shipping"}},{default:s(()=>[C(u(l(t)("Shipping Zones")),1)]),_:1}),e(U,null,{default:s(()=>[C(u(S.value?l(t)("Edit Shipping Zone"):l(t)("Add Shipping Zone")),1)]),_:1}),S.value?(n(),$(U,{key:0},{default:s(()=>[C(u(a.value.name),1)]),_:1})):I("",!0)]),_:1},8,["separator-icon"]),f("div",Vt,[e(h,{type:"primary",onClick:j,loading:_.value},{default:s(()=>[_.value?I("",!0):(n(),m("span",Tt,"âŒ˜s")),C(" "+u(_.value?l(t)("Saving"):l(t)("Save")),1)]),_:1},8,["loading"])])]),e(l(G),null,{default:s(()=>[e(l(X),{title:l(t)("Zone Details"),border_bottom:""},null,8,["title"]),e(l(W),null,{default:s(()=>[e(K,{model:a.value,rules:Z.value,ref_key:"zoneFormRef",ref:r,"label-position":"top","require-asterisk-position":"right"},{default:s(()=>[e(P,{label:l(t)("Zone Name"),prop:"name"},{default:s(()=>[e(p,{modelValue:a.value.name,"onUpdate:modelValue":A[0]||(A[0]=M=>a.value.name=M),placeholder:l(t)("Enter zone name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(P,{label:"",prop:"region",class:"mt-6 mb-6"},{default:s(()=>[e(E,{modelValue:w.value,"onUpdate:modelValue":A[1]||(A[1]=M=>w.value=M),onChange:N},{default:s(()=>[C(u(l(t)("Applies to Whole World")),1)]),_:1},8,["modelValue"])]),_:1}),e(P,{label:l(t)("Country"),prop:"region",class:"mb-0",required:""},{default:s(()=>[e(Y,{modelValue:a.value.region,"onUpdate:modelValue":A[2]||(A[2]=M=>a.value.region=M),disabled:w.value,filterable:"","default-first-option":"",placeholder:l(t)("Select countries"),"reserve-keyword":!1,onVisibleChange:R,onChange:ee},{default:s(()=>[(n(!0),m(le,null,ne(l(Ee),M=>(n(),$(B,{key:M.code2,label:M.name,value:M.code2},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","placeholder"]),f("div",At,u(l(t)("Add countries where this shipping zone applies.")),1)]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1})]),_:1}),S.value?(n(),$(Ct,{key:0,zone_id:v.zone_id,methods:x.value,onFetchShippingMethods:k,country:a.value.region},null,8,["zone_id","methods","country"])):I("",!0)]))])])}}},_e=ce(Zt,[["__scopeId","data-v-ddb13294"]]);class Et extends he{setupInitialData(){super.setupInitialData(),this.data.sorting.sortBy="id",this.data.sorting.sortType="DESC"}getTabs(){return null}getToggleableColumns(){return[{label:t("Cost"),value:"cost"},{label:t("Type"),value:"type"}]}getSortableColumns(){return[{label:t("Class Name"),value:"name"},{label:t("Cost"),value:"cost"}]}getSearchHint(){return t("Search by class name")}getFetchUrl(){return"shipping/classes"}parseResponse(v){return v.shipping_classes}getTableName(){return"shipping_class_table"}getAdvanceFilterOptions(){return null}getSearchGuideOptions(){return[]}useFullWidthSearch(){return!0}}function Ft(y){return Et.init(y)}const Mt={class:"shipping-classes-table"},Dt={class:"fc-btn-group sm justify-end"},Pt={__name:"ShippingClassesTable",props:{shipping_classes:{type:Array,required:!0},columns:{type:Array,default:()=>[]}},emits:["refresh"],setup(y,{emit:v}){const g=v,c=b(!1),r=b(!1),d=b(null),_=x=>{c.value=!0,q.delete(`/shipping/classes/${x}`).then(z=>{F.success(z.message),g("refresh")}).catch(z=>{console.error("Error deleting shipping class:",z),F.error(t("Failed to delete shipping class"))}).finally(()=>{c.value=!1})},a=x=>{d.value=x,r.value=!0},Z=()=>{g("refresh")};return(x,z)=>{const w=o("el-table-column"),T=o("el-popconfirm"),R=o("el-table"),S=ue("loading");return n(),m("div",Mt,[de((n(),$(R,{data:y.shipping_classes,class:"w-full responsive"},{default:s(()=>[e(w,{prop:"name",label:l(t)("Class Name")},{default:s(k=>[C(u(k.row.name),1)]),_:1},8,["label"]),e(w,{prop:"cost",label:l(t)("Cost"),width:"150"},{default:s(k=>[C(u(k.row.cost)+u(k.row.type==="percentage"?"%":""),1)]),_:1},8,["label"]),e(w,{prop:"type",label:l(t)("Type"),width:"150"},{default:s(k=>[C(u(k.row.type==="fixed"?l(t)("Fixed Amount"):l(t)("Percentage")),1)]),_:1},8,["label"]),e(w,{prop:"per_item",label:l(t)("Per Item"),width:"150"},{default:s(k=>[C(u(k.row.per_item==1?l(t)("Yes"):l(t)("No")),1)]),_:1},8,["label"]),e(w,{label:l(t)("Actions"),width:"200",align:"right"},{default:s(k=>[f("div",Dt,[e(J,{size:"small",onClick:N=>a(k.row),class:"cursor-pointer"},{default:s(()=>[e(Q,{name:"Edit"})]),_:2},1032,["onClick"]),e(T,{title:l(t)("Are you sure to delete this shipping class?"),onConfirm:N=>_(k.row.id),width:"220"},{reference:s(()=>[e(J,{size:"small",class:"cursor-pointer"},{default:s(()=>[e(Q,{name:"Delete"})]),_:1})]),_:2},1032,["title","onConfirm"])])]),_:1},8,["label"])]),_:1},8,["data"])),[[S,c.value]]),e(ye,{modelValue:r.value,"onUpdate:modelValue":z[0]||(z[0]=k=>r.value=k),"class-data":d.value,onSaved:Z},null,8,["modelValue","class-data"])])}}},Rt={class:"shipping-classes-loader"},Nt={class:"shipping-classes-table"},Ut={class:"table-cell"},qt={class:"table-cell"},Bt={class:"table-cell"},It={class:"table-cell"},Ot={__name:"ShippingClassesLoader",props:{shippingClassTable:{type:Object,required:!0},nextPageCount:{type:Array,default:()=>[1,2,3,4,5]}},setup(y){return(v,g)=>{const c=o("el-skeleton-item"),r=o("el-skeleton"),d=o("el-table-column"),_=o("el-table");return n(),m("div",Rt,[f("div",Nt,[e(_,{data:[],class:"w-full compact-table responsive"},{default:s(()=>[e(d,{prop:"name",label:l(t)("Class Name")},{default:s(()=>[f("div",Ut,[e(r,{animated:""},{template:s(()=>[e(c,{varient:"p",class:"w-[120px]"})]),_:1})])]),_:1},8,["label"]),e(d,{label:l(t)("Cost")},{default:s(()=>[f("div",qt,[e(r,{animated:""},{template:s(()=>[e(c,{varient:"p",class:"w-[80px]"})]),_:1})])]),_:1},8,["label"]),e(d,{label:l(t)("Type")},{default:s(()=>[f("div",Bt,[e(r,{animated:""},{template:s(()=>[e(c,{varient:"p",class:"w-[100px]"})]),_:1})])]),_:1},8,["label"]),e(d,{label:l(t)("Actions"),width:"200",align:"right"},{default:s(()=>[f("div",It,[e(r,{animated:""},{template:s(()=>[e(c,{varient:"p",class:"w-[80px]"})]),_:1})])]),_:1},8,["label"])]),_:1})])])}}},jt={class:"setting-wrap"},Lt={class:"fc-all-shipping-classes-page"},Ht={class:"fc-all-shipping-classes-wrap"},Wt={key:1},Gt={__name:"AllShippingClasses",setup(y){oe();const v=Ft(),g=b(!1),c=b(null),r=()=>{c.value=null,g.value=!0},d=()=>{v.fetch(),g.value=!1};return(_,a)=>{const Z=o("el-button");return n(),m("div",jt,[f("div",Lt,[e(fe,{title:l(t)("Shipping Classes")},{action:s(()=>[e(Z,{type:"primary",onClick:r},{default:s(()=>[C(u(l(t)("Add Shipping Class")),1)]),_:1})]),_:1},8,["title"]),f("div",Ht,[e(ve,{table:l(v)},{default:s(()=>[l(v).isLoading()?(n(),$(Ot,{key:0,shippingClassTable:l(v),"next-page-count":l(v).nextPageCount},null,8,["shippingClassTable","next-page-count"])):(n(),m("div",Wt,[e(Pt,{shipping_classes:l(v).getTableData(),columns:l(v).data.columns,onRefresh:a[0]||(a[0]=x=>l(v).fetch())},null,8,["shipping_classes","columns"])]))]),_:1},8,["table"])]),e(ye,{modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=x=>g.value=x),"class-data":c.value,onSaved:d},null,8,["modelValue","class-data"])])])}}},Yt={class:"single-shipping-zone-loader"},Kt={class:"single-page-header flex items-center justify-between"},Xt={class:"fc-page-header__actions"},Jt={__name:"SingleShippingClassLoader",setup(y){return(v,g)=>{const c=o("el-skeleton-item"),r=o("el-skeleton"),d=o("el-breadcrumb-item"),_=o("el-breadcrumb");return n(),m("div",Yt,[f("div",Kt,[e(_,{"separator-icon":l(ie)},{default:s(()=>[e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(c,{variant:"p",class:"w-[90px] h-4"})]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(c,{variant:"p",class:"w-[90px] h-4"})]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(c,{variant:"p",class:"w-[60px] h-4"})]),_:1})]),_:1})]),_:1},8,["separator-icon"]),f("div",Xt,[e(r,{animated:"",class:"h-9 w-[172px]"},{template:s(()=>[e(c,{variant:"p",class:"w-full h-9 rounded"})]),_:1})])]),e(l(G),{class:"mb-4"},{default:s(()=>[e(l(X),{title:l(t)("Class Details"),border_bottom:"",title_size:"small"},null,8,["title"]),e(l(W),null,{default:s(()=>[e(r,{rows:4,animated:!0})]),_:1})]),_:1})])}}},Qt={class:"fc-single-shipping-class-page"},el={key:0},tl={key:2,class:"fc-single-shipping-class"},ll={class:"single-page-header flex items-center justify-between"},sl={class:"fc-page-header__actions"},al={class:"form-help-text w-full"},nl={class:"form-help-text"},me={__name:"SingleShippingClass",props:{class_id:{type:[String,Number],required:!1}},setup(y){const v=Ae(),g=y,c=oe();v.onSave(()=>{T()});const r=b(null),d=b(!1),_=b(!1),a=b({name:"",cost:0,type:"fixed"}),Z=b({name:[{required:!0,message:t("Please enter a class name"),trigger:"blur"}],cost:[{required:!0,message:t("Please enter a cost"),trigger:"blur"}],type:[{required:!0,message:t("Please select a cost type"),trigger:"blur"}]}),x=b({show:!1,message:"",buttonText:"",route:""}),z=se(()=>!!g.class_id),w=()=>{if(!z.value){d.value=!1;return}d.value=!0,q.get(`/shipping/classes/${g.class_id}`).then(R=>{const S=R.shipping_class;a.value={name:S.name,cost:S.cost,type:S.type}}).catch(R=>{console.error("Error fetching shipping class:",R),x.value={show:!0,message:t("The shipping class you are looking for does not exist or has been deleted."),buttonText:t("Go to Shipping Classes"),route:{name:"shipping_classes"}}}).finally(()=>{d.value=!1})},T=()=>{r.value.validate(R=>{if(!R)return;_.value=!0;const S=z.value?"put":"post",k=z.value?`/shipping/classes/${g.class_id}`:"/shipping/classes";q[S](k,a.value).then(N=>{F.success(N.message),z.value||c.push({name:"view_shipping_class",params:{class_id:N.shipping_class.id}})}).catch(N=>{console.error("Error saving shipping class:",N),F.error(t("Failed to save shipping class"))}).finally(()=>{_.value=!1})})};return ge(()=>{w()}),(R,S)=>{const k=o("el-breadcrumb-item"),N=o("el-breadcrumb"),j=o("el-button"),ee=o("el-input"),V=o("el-form-item"),A=o("el-input-number"),U=o("el-option"),D=o("el-select"),h=o("el-form");return n(),m("div",Qt,[d.value?(n(),m("div",el,[e(Jt)])):x.value.show?(n(),$(be,{key:1,message:x.value.message,"button-text":x.value.buttonText,route:x.value.route},null,8,["message","button-text","route"])):(n(),m("div",tl,[f("div",ll,[e(N,{"separator-icon":l(ie)},{default:s(()=>[e(k,{to:{name:"shipping_classes"}},{default:s(()=>[C(u(l(t)("Shipping Classes")),1)]),_:1}),e(k,null,{default:s(()=>[C(u(z.value?l(t)("Edit Shipping Class"):l(t)("Add Shipping Class")),1)]),_:1}),z.value?(n(),$(k,{key:0},{default:s(()=>[C(u(a.value.name),1)]),_:1})):I("",!0)]),_:1},8,["separator-icon"]),f("div",sl,[e(j,{type:"primary",onClick:T,loading:_.value},{default:s(()=>[C(u(l(t)("Save Shipping Class")),1)]),_:1},8,["loading"])])]),e(l(G),{class:"mb-4"},{default:s(()=>[e(l(X),{title:l(t)("Class Details"),border_bottom:"",title_size:"small"},null,8,["title"]),e(l(W),null,{default:s(()=>[e(h,{model:a.value,rules:Z.value,ref_key:"classFormRef",ref:r,"label-position":"top"},{default:s(()=>[e(V,{label:l(t)("Class Name"),prop:"name"},{default:s(()=>[e(ee,{modelValue:a.value.name,"onUpdate:modelValue":S[0]||(S[0]=p=>a.value.name=p),placeholder:l(t)("Enter class name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(V,{label:l(t)("Cost"),prop:"cost"},{default:s(()=>[e(A,{modelValue:a.value.cost,"onUpdate:modelValue":S[1]||(S[1]=p=>a.value.cost=p),precision:2,min:0,step:1,class:"w-full max-w-[200px]"},null,8,["modelValue"]),f("div",al,u(l(t)("Additional cost for products in this shipping class")),1)]),_:1},8,["label"]),e(V,{label:l(t)("Cost Type"),prop:"type"},{default:s(()=>[e(D,{modelValue:a.value.type,"onUpdate:modelValue":S[2]||(S[2]=p=>a.value.type=p),style:{width:"100%"}},{default:s(()=>[e(U,{label:l(t)("Fixed Amount"),value:"fixed"},null,8,["label"]),e(U,{label:l(t)("Percentage"),value:"percentage"},null,8,["label"])]),_:1},8,["modelValue"]),f("div",nl,u(l(t)("How this cost should be applied to the shipping rate")),1)]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1})]),_:1})]))])}}};window.fluent_cart_admin.hooks.addFilter("fluent_cart_routes","fluent_shipping",function(y){return y.settings&&y.settings.children&&y.settings.children.push({name:"shipping",path:"shipping",component:et,meta:{active_menu:"shipping",title:t("Shipping Zones"),permission:["store/settings","store/sensitive"]}},{name:"view_shipping_zone",path:"shipping/zone/:zone_id/edit",component:_e,props:!0,meta:{active_menu:"settings",title:t("Edit Shipping Zone"),permission:["store/settings","store/sensitive"]}},{name:"add_shipping_zone",path:"shipping/zone/add",component:_e,meta:{active_menu:"settings",title:t("Add Shipping Zone"),permission:["store/settings","store/sensitive"]}},{name:"shipping_classes",path:"shipping/shipping_classes",component:Gt,meta:{active_menu:"settings",title:t("Shipping Classes"),permission:["store/settings","store/sensitive"]}},{name:"view_shipping_class",path:"shipping/shipping_classes/:class_id/edit",component:me,props:!0,meta:{active_menu:"settings",title:t("Edit Shipping Class"),permission:["store/settings","store/sensitive"]}},{name:"add_shipping_class",path:"shipping/shipping_classes/add",component:me,meta:{active_menu:"settings",title:t("Add Shipping Class"),permission:["store/settings","store/sensitive"]}}),y});
